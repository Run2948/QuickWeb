/*!
 * UEditor
 * version: ueditor
 * build: Wed Aug 10 2016 11:05:20 GMT+0800 (CST)
 */
(function(){function v(n,t,i){var r;return t=t.toLowerCase(),(r=n.__allListeners||i&&(n.__allListeners={}))&&(r[t]||i&&(r[t]=[]))}function l(n,t,i,r,u,f){var e=r&&n[t],o;for(e||(e=n[i]);!e&&(o=(o||n).parentNode);){if(o.tagName=="BODY"||f&&!f(o))return null;e=o[i]}return e&&u&&!u(e)?l(e,t,i,!1,u):e}var c,f,b,k,d,a,s,u;UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};u=window.baidu||{};window.baidu=u;window.UE=u.editor=window.UE||{};UE.plugins={};UE.commands={};UE.instants={};UE.I18N={};UE._customizeUI={};UE.version="1.4.3";var e=UE.dom={},r=UE.browser=function(){var i=navigator.userAgent.toLowerCase(),e=window.opera,n={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(i),opera:!!e&&e.version,webkit:i.indexOf(" applewebkit/")>-1,mac:i.indexOf("macintosh")>-1,quirks:document.compatMode=="BackCompat"},t,r,u,f;return n.gecko=navigator.product=="Gecko"&&!n.webkit&&!n.opera&&!n.ie,t=0,n.ie&&(r=i.match(/(?:msie\s([\w.]+))/),u=i.match(/(?:trident.*rv:([\w.]+))/),t=r&&u&&r[1]&&u[1]?Math.max(r[1]*1,u[1]*1):r&&r[1]?r[1]*1:u&&u[1]?u[1]*1:0,n.ie11Compat=document.documentMode==11,n.ie9Compat=document.documentMode==9,n.ie8=!!document.documentMode,n.ie8Compat=document.documentMode==8,n.ie7Compat=t==7&&!document.documentMode||document.documentMode==7,n.ie6Compat=t<7||n.quirks,n.ie9above=t>8,n.ie9below=t<9,n.ie11above=t>10,n.ie11below=t<11),n.gecko&&(f=i.match(/rv:([\d\.]+)/),f&&(f=f[1].split("."),t=f[0]*1e4+(f[1]||0)*100+(f[2]||0)*1)),/chrome\/(\d+\.\d)/i.test(i)&&(n.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(i)&&!/chrome/i.test(i)&&(n.safari=+(RegExp.$1||RegExp.$2)),n.opera&&(t=parseFloat(e.version())),n.webkit&&(t=parseFloat(i.match(/ applewebkit\/(\d+)/)[1])),n.version=t,n.isCompatible=!n.mobile&&(n.ie&&t>=6||n.gecko&&t>=10801||n.opera&&t>=9.5||n.air&&t>=1||n.webkit&&t>=522||!1),n}(),o=r.ie,g=r.webkit,nt=r.gecko,p=r.opera,t=UE.utils={each:function(n,t,i){var r,f,u;if(n!=null)if(n.length===+n.length){for(r=0,f=n.length;r<f;r++)if(t.call(i,n[r],r,n)===!1)return!1}else for(u in n)if(n.hasOwnProperty(u)&&t.call(i,n[u],u,n)===!1)return!1},makeInstance:function(n){var t=new Function;return t.prototype=n,n=new t,t.prototype=null,n},extend:function(n,t,i){if(t)for(var r in t)i&&n.hasOwnProperty(r)||(n[r]=t[r]);return n},extend2:function(n){for(var r,t,u=arguments,i=1;i<u.length;i++){r=u[i];for(t in r)n.hasOwnProperty(t)||(n[t]=r[t])}return n},inherits:function(n,i){var u=n.prototype,r=t.makeInstance(i.prototype);return t.extend(r,u,!0),n.prototype=r,r.constructor=n},bind:function(n,t){return function(){return n.apply(t,arguments)}},defer:function(n,t,i){var r;return function(){i&&clearTimeout(r);r=setTimeout(n,t)}},indexOf:function(n,t,i){var r=-1;return i=this.isNumber(i)?i:0,this.each(n,function(n,u){if(u>=i&&n===t)return r=u,!1}),r},removeItem:function(n,t){for(var i=0,r=n.length;i<r;i++)n[i]===t&&(n.splice(i,1),i--)},trim:function(n){return n.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(n){if(!n)return{};n=t.isArray(n)?n:n.split(",");for(var u=0,i,r={};i=n[u++];)r[i.toUpperCase()]=r[i]=1;return r},unhtml:function(n,t){return n?n.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g,function(n,t){return t?n:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[n]}):""},unhtmlForUrl:function(n,t){return n?n.replace(t||/[<">']/g,function(n){return{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[n]}):""},html:function(n){return n?n.replace(/&((g|l|quo)t|amp|#39|nbsp);/g,function(n){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'","&nbsp;":" "}[n]}):""},cssStyleToDomStyle:function(){var n=document.createElement("div").style,t={float:n.cssFloat!=undefined?"cssFloat":n.styleFloat!=undefined?"styleFloat":"float"};return function(n){return t[n]||(t[n]=n.toLowerCase().replace(/-./g,function(n){return n.charAt(1).toUpperCase()}))}}(),loadFile:function(){function t(t,i){try{for(var u=0,r;r=n[u++];)if(r.doc===t&&r.url==(i.src||i.href))return r}catch(f){return null}}var n=[];return function(i,r,u){var e=t(i,r),s,f,o;if(e){e.ready?u&&u():e.funs.push(u);return}if(n.push({doc:i,url:r.src||r.href,funs:[u]}),!i.body){s=[];for(o in r)o!="tag"&&s.push(o+'="'+r[o]+'"');i.write("<"+r.tag+" "+s.join(" ")+" ><\/"+r.tag+">");return}if(!r.id||!i.getElementById(r.id)){f=i.createElement(r.tag);delete r.tag;for(o in r)f.setAttribute(o,r[o]);f.onload=f.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){if(e=t(i,r),e.funs.length>0){e.ready=1;for(var n;n=e.funs.pop();)n()}f.onload=f.onreadystatechange=null}};f.onerror=function(){throw Error("The load "+(r.href||r.src)+" fails,check the url settings of file ueditor.config.js ");};i.getElementsByTagName("head")[0].appendChild(f)}}}(),isEmptyObject:function(n){if(n==null)return!0;if(this.isArray(n)||this.isString(n))return n.length===0;for(var t in n)if(n.hasOwnProperty(t))return!1;return!0},fixColor:function(n,t){var r,u,i;if(/color/i.test(n)&&/rgba?/.test(t)){if(r=t.split(","),r.length>3)return"";for(t="#",u=0;i=r[u++];)i=parseInt(i.replace(/[^\d]/gi,""),10).toString(16),t+=i.length==1?"0"+i:i;t=t.toUpperCase()}return t},optCss:function(n){function r(n,t){var o;if(!n)return"";var r=n.top,u=n.bottom,i=n.left,f=n.right,e="";if(r&&i&&u&&f)e+=";"+t+":"+(r==u&&u==i&&i==f?r:r==u&&i==f?r+" "+i:i==f?r+" "+i+" "+u:r+" "+f+" "+u+" "+i)+";";else for(o in n)e+=";"+t+"-"+o+":"+n[o]+";";return e}var t,i;return n=n.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(n,r,u,f){if(f.split(" ").length==1)switch(r){case"padding":return t||(t={}),t[u]=f,"";case"margin":return i||(i={}),i[u]=f,"";case"border":return f=="initial"?"":n}return n}),n+=r(t,"padding")+r(i,"margin"),n.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(n,t){return t?t+";;":";"})},clone:function(n,i){var u,r;i=i||{};for(r in n)n.hasOwnProperty(r)&&(u=n[r],typeof u=="object"?(i[r]=t.isArray(u)?[]:{},t.clone(n[r],i[r])):i[r]=u);return i},transUnitToPx:function(n){if(!/(pt|cm)/.test(n))return n;var t;n.replace(/([\d.]+)(\w+)/,function(i,r,u){n=r;t=u});switch(t){case"cm":n=parseFloat(n)*25;break;case"pt":n=Math.round(parseFloat(n)*96/72)}return n+(n?"px":"")},domReady:function(){function n(n){n.isReady=!0;for(var i;i=t.pop();i());}var t=[];return function(i,u){u=u||window;var f=u.document;i&&t.push(i);f.readyState==="complete"?n(f):(f.isReady&&n(f),r.ie&&r.version!=11?(function(){if(!f.isReady){try{f.documentElement.doScroll("left")}catch(t){setTimeout(arguments.callee,0);return}n(f)}}(),u.attachEvent("onload",function(){n(f)})):(f.addEventListener("DOMContentLoaded",function(){f.removeEventListener("DOMContentLoaded",arguments.callee,!1);n(f)},!1),u.addEventListener("load",function(){n(f)},!1)))}}(),cssRule:r.ie&&r.version!=11?function(n,t,i){var u,r;if(t===undefined||t&&t.nodeType&&t.nodeType==9)return(i=t&&t.nodeType&&t.nodeType==9?t:i||document,u=i.indexList||(i.indexList={}),r=u[n],r!==undefined)?i.styleSheets[r].cssText:undefined;if(i=i||document,u=i.indexList||(i.indexList={}),r=u[n],t==="")return r!==undefined?(i.styleSheets[r].cssText="",delete u[n],!0):!1;r!==undefined?sheetStyle=i.styleSheets[r]:(sheetStyle=i.createStyleSheet("",r=i.styleSheets.length),u[n]=r);sheetStyle.cssText=t}:function(n,t,i){var r;if(t===undefined||t&&t.nodeType&&t.nodeType==9)return i=t&&t.nodeType&&t.nodeType==9?t:i||document,r=i.getElementById(n),r?r.innerHTML:undefined;if(i=i||document,r=i.getElementById(n),t==="")return r?(r.parentNode.removeChild(r),!0):!1;r?r.innerHTML=t:(r=i.createElement("style"),r.id=n,r.innerHTML=t,i.getElementsByTagName("head")[0].appendChild(r))},sort:function(n,t){var i,u,r,f,e;for(t=t||function(n,t){return n.localeCompare(t)},i=0,u=n.length;i<u;i++)for(r=i,f=n.length;r<f;r++)t(n[i],n[r])>0&&(e=n[i],n[i]=n[r],n[r]=e);return n},serializeParam:function(n){var u=[],i,r;for(i in n)if(i!="method"&&i!="timeout"&&i!="async")if((typeof n[i]).toLowerCase()=="function"||(typeof n[i]).toLowerCase()=="object"){if(t.isArray(n[i]))for(r=0;r<n[i].length;r++)u.push(encodeURIComponent(i)+"[]="+encodeURIComponent(n[i][r]))}else u.push(encodeURIComponent(i)+"="+encodeURIComponent(n[i]));return u.join("&")},formatUrl:function(n){var t=n.replace(/&&/g,"&");return t=t.replace(/\?&/g,"?"),t=t.replace(/&$/g,""),t=t.replace(/&#/g,"#"),t.replace(/&+/g,"&")},isCrossDomainUrl:function(n){var t=document.createElement("a");return t.href=n,r.ie&&(t.href=t.href),!(t.protocol==location.protocol&&t.hostname==location.hostname&&(t.port==location.port||t.port=="80"&&location.port==""||t.port==""&&location.port=="80"))},clearEmptyAttrs:function(n){for(var t in n)n[t]===""&&delete n[t];return n},str2json:function(n){return t.isString(n)?window.JSON?JSON.parse(n):new Function("return "+t.trim(n||""))():null},json2str:function(){if(window.JSON)return JSON.stringify;var i={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function r(n){return/["\\\x00-\x1f]/.test(n)&&(n=n.replace(/["\\\x00-\x1f]/g,function(n){var t=i[n];return t?t:(t=n.charCodeAt(),"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16))})),'"'+n+'"'}function u(n){for(var i=["["],e=n.length,f,u,r=0;r<e;r++){u=n[r];switch(typeof u){case"undefined":case"function":case"unknown":break;default:f&&i.push(",");i.push(t.json2str(u));f=1}}return i.push("]"),i.join("")}function n(n){return n<10?"0"+n:n}function f(t){return'"'+t.getFullYear()+"-"+n(t.getMonth()+1)+"-"+n(t.getDate())+"T"+n(t.getHours())+":"+n(t.getMinutes())+":"+n(t.getSeconds())+'"'}return function(n){var i,o,h,s,e;switch(typeof n){case"undefined":return"undefined";case"number":return isFinite(n)?String(n):"null";case"string":return r(n);case"boolean":return String(n);default:if(n===null)return"null";if(t.isArray(n))return u(n);if(t.isDate(n))return f(n);i=["{"];o=t.json2str;for(e in n)if(Object.prototype.hasOwnProperty.call(n,e)){s=n[e];switch(typeof s){case"undefined":case"unknown":case"function":break;default:h&&i.push(",");h=1;i.push(o(e)+":"+o(s))}}return i.push("}"),i.join("")}}}()};t.each(["String","Function","Array","Number","RegExp","Object","Date"],function(n){UE.utils["is"+n]=function(t){return Object.prototype.toString.apply(t)=="[object "+n+"]"}});c=UE.EventBase=function(){};c.prototype={addListener:function(n,i){n=t.trim(n).split(/\s+/);for(var u=0,r;r=n[u++];)v(this,r,!0).push(i)},on:function(n,t){return this.addListener(n,t)},off:function(n,t){return this.removeListener(n,t)},trigger:function(){return this.fireEvent.apply(this,arguments)},removeListener:function(n,i){n=t.trim(n).split(/\s+/);for(var u=0,r;r=n[u++];)t.removeItem(v(this,r)||[],i)},fireEvent:function(){for(var u=arguments[0],f,i,e,n,r,u=t.trim(u).split(" "),o=0;f=u[o++];){if(i=v(this,f),i)for(r=i.length;r--;)if(i[r]){if(n=i[r].apply(this,arguments),n===!0)return n;n!==undefined&&(e=n)}(n=this["on"+f.toLowerCase()])&&(e=n.apply(this,arguments))}return e}};f=e.dtd=function(){function n(n){for(var t in n)n[t.toUpperCase()]=n[t];return n}var r=t.extend2,h=n({isindex:1,fieldset:1}),a=n({input:1,button:1,select:1,textarea:1,label:1}),v=r(n({a:1}),a),c=r({iframe:1},v),e=n({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),y=n({ins:1,del:1,script:1,style:1}),p=r(n({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),y),w=r(n({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),p),o=r(n({p:1}),w),b=r(n({iframe:1}),w,a),k=n({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),i=r(n({a:0}),b),l=n({tr:1}),f=n({"#":1}),d=r(n({param:1}),k),u=r(n({form:1}),h,c,e,o),s=n({li:1,ol:1,ul:1}),it=n({style:1,script:1}),g=n({base:1,link:1,meta:1,title:1}),rt=r(g,it),nt=n({head:1,body:1}),ut=n({html:1}),tt=n({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),ft=n({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return n({$nonBodyContent:r(ut,nt,g),$block:tt,$inline:i,$inlineWithA:r(n({a:1}),i),$body:r(n({script:1,style:1}),tt),$cdata:n({script:1,style:1}),$empty:ft,$nonChild:n({iframe:1,textarea:1}),$listItem:n({dd:1,dt:1,li:1}),$list:n({ul:1,ol:1,dl:1}),$isNotEmpty:n({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:n({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:n({p:1,div:1}),$tableContent:n({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:n({pre:1,script:1,style:1,textarea:1}),html:nt,head:rt,style:f,script:f,body:u,base:{},link:{},meta:{},title:f,col:{},tr:n({td:1,th:1}),img:{},embed:{},colgroup:n({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:u,td:u,br:{},th:u,center:u,kbd:i,button:r(o,e),basefont:{},h5:i,h4:i,samp:i,h6:i,ol:s,h1:i,h3:i,option:f,h2:i,form:r(h,c,e,o),select:n({optgroup:1,option:1}),font:i,ins:i,menu:s,abbr:i,label:i,table:n({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:i,tfoot:l,cite:i,li:u,input:{},iframe:u,strong:i,textarea:f,noframes:u,big:i,small:i,span:n({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:i,dt:i,sub:i,optgroup:n({option:1}),param:{},bdo:i,"var":i,div:u,object:d,sup:i,dd:u,strike:i,area:{},dir:s,map:r(n({area:1,form:1,p:1}),h,y,e),applet:d,dl:n({dt:1,dd:1}),del:i,isindex:{},fieldset:r(n({legend:1}),k),thead:l,ul:s,acronym:i,b:i,a:r(n({a:1}),b),blockquote:r(n({td:1,tr:1,tbody:1,li:1}),u),caption:i,i:i,u:i,tbody:l,s:i,address:r(c,o),tt:i,legend:i,q:i,pre:r(p,v),p:r(n({a:1}),i),em:i,dfn:i})}();var y=o&&r.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},w=t.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),n=e.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:o&&r.version=="6"?"﻿":"​",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(n,t){var i,r,u,f;if(n===t)return 0;for(r=[n],u=[t],i=n;i=i.parentNode;){if(i===t)return 10;r.push(i)}for(i=t;i=i.parentNode;){if(i===n)return 20;u.push(i)}if(r.reverse(),u.reverse(),r[0]!==u[0])return 1;for(f=-1;f++,r[f]===u[f];);for(n=r[f],t=u[f];n=n.nextSibling;)if(n===t)return 4;return 2},getNodeIndex:function(n,t){for(var i=n,r=0;i=i.previousSibling;){if(t&&i.nodeType==3){i.nodeType!=i.nextSibling.nodeType&&r++;continue}r++}return r},inDoc:function(t,i){return n.getPosition(t,i)==10},findParent:function(t,i,r){if(t&&!n.isBody(t))for(t=r?t:t.parentNode;t;){if(!i||i(t)||n.isBody(t))return i&&!i(t)&&n.isBody(t)?null:t;t=t.parentNode}return null},findParentByTagName:function(i,r,u,f){return r=t.listToMap(t.isArray(r)?r:[r]),n.findParent(i,function(n){return r[n.tagName]&&!(f&&f(n))},u)},findParents:function(t,i,r,u){for(var f=i&&(r&&r(t)||!r)?[t]:[];t=n.findParent(t,r);)f.push(t);return u?f:f.reverse()},insertAfter:function(n,t){return n.nextSibling?n.parentNode.insertBefore(t,n.nextSibling):n.parentNode.appendChild(t)},remove:function(n,t){var i=n.parentNode,r;if(i){if(t&&n.hasChildNodes())while(r=n.firstChild)i.insertBefore(r,n);i.removeChild(n)}return n},getNextDomNode:function(n,t,i,r){return l(n,"firstChild","nextSibling",t,i,r)},getPreDomNode:function(n,t,i,r){return l(n,"lastChild","previousSibling",t,i,r)},isBookmarkNode:function(n){return n.nodeType==1&&n.id&&/^_baidu_bookmark_/i.test(n.id)},getWindow:function(n){var t=n.ownerDocument||n;return t.defaultView||t.parentWindow},getCommonAncestor:function(n,t){if(n===t)return n;for(var u=[n],f=[t],i=n,r=-1;i=i.parentNode;){if(i===t)return i;u.push(i)}for(i=t;i=i.parentNode;){if(i===n)return i;f.push(i)}for(u.reverse(),f.reverse();r++,u[r]===f[r];);return r==0?null:u[r-1]},clearEmptySibling:function(t,i,r){function u(t,i){for(var r;t&&!n.isBookmarkNode(t)&&(n.isEmptyInlineElement(t)||!new RegExp("[^\t\n\r"+n.fillChar+"]").test(t.nodeValue));)r=t[i],n.remove(t),t=r}i||u(t.nextSibling,"nextSibling");r||u(t.previousSibling,"previousSibling")},split:function(t,i){var e=t.ownerDocument,o,u,f;return r.ie&&i==t.nodeValue.length?(o=e.createTextNode(""),n.insertAfter(t,o)):(u=t.splitText(i),r.ie8&&(f=e.createTextNode(""),n.insertAfter(u,f),n.remove(f)),u)},isWhitespace:function(t){return!new RegExp("[^ \t\n\r"+n.fillChar+"]").test(t.nodeValue)},getXY:function(n){for(var t=0,i=0;n.offsetParent;)i+=n.offsetTop,t+=n.offsetLeft,n=n.offsetParent;return{x:t,y:i}},on:function(n,i,r){var o=t.isArray(i)?i:t.trim(i).split(/\s+/),f=o.length,u,e;if(f)while(f--)i=o[f],n.addEventListener?n.addEventListener(i,r,!1):(r._d||(r._d={els:[]}),u=i+r.toString(),e=t.indexOf(r._d.els,n),r._d[u]&&e!=-1||(e==-1&&r._d.els.push(n),r._d[u]||(r._d[u]=function(n){return r.call(n.srcElement,n||window.event)}),n.attachEvent("on"+i,r._d[u])));n=null},un:function(n,i,r){var o=t.isArray(i)?i:t.trim(i).split(/\s+/),f=o.length,u,e;if(f)while(f--)if(i=o[f],n.removeEventListener)n.removeEventListener(i,r,!1);else{u=i+r.toString();try{n.detachEvent("on"+i,r._d?r._d[u]:r)}catch(s){}r._d&&r._d[u]&&(e=t.indexOf(r._d.els,n),e!=-1&&r._d.els.splice(e,1),r._d.els.length==0&&delete r._d[u])}},isSameElement:function(t,i){var h,f,r,u,e,c,s;if(t.tagName!=i.tagName||(h=t.attributes,f=i.attributes,!o&&h.length!=f.length))return!1;for(e=0,c=0,s=0;r=h[s++];){if(r.nodeName=="style")if(r.specified&&e++,n.isSameStyle(t,i))continue;else return!1;if(o)if(r.specified)e++,u=f.getNamedItem(r.nodeName);else continue;else u=i.attributes[r.nodeName];if(!u.specified||r.nodeValue!=u.nodeValue)return!1}if(o){for(s=0;u=f[s++];)u.specified&&c++;if(e!=c)return!1}return!0},isSameStyle:function(n,i){var u=n.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),f=i.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),e,o,s;if(r.opera){if(u=n.style,f=i.style,u.length!=f.length)return!1;for(e in u)if(!/^(\d+|csstext)$/i.test(e)&&u[e]!=f[e])return!1;return!0}if(!u||!f)return u==f;if(u=u.split(";"),f=f.split(";"),u.length!=f.length)return!1;for(o=0;s=u[o++];)if(t.indexOf(f,s)==-1)return!1;return!0},isBlockElm:function(t){return t.nodeType==1&&(f.$block[t.tagName]||w[n.getComputedStyle(t,"display")])&&!f.$nonChild[t.tagName]},isBody:function(n){return n&&n.nodeType==1&&n.tagName.toLowerCase()=="body"},breakParent:function(t,i){var r,f=t,o=t,u,e;do{for(f=f.parentNode,u?(r=f.cloneNode(!1),r.appendChild(u),u=r,r=f.cloneNode(!1),r.appendChild(e),e=r):(u=f.cloneNode(!1),e=u.cloneNode(!1));r=o.previousSibling;)u.insertBefore(r,u.firstChild);while(r=o.nextSibling)e.appendChild(r);o=f}while(i!==f);return r=i.parentNode,r.insertBefore(u,i),r.insertBefore(e,i),r.insertBefore(t,e),n.remove(i),t},isEmptyInlineElement:function(t){if(t.nodeType!=1||!f.$removeEmpty[t.tagName])return 0;for(t=t.firstChild;t;){if(n.isBookmarkNode(t)||t.nodeType==1&&!n.isEmptyInlineElement(t)||t.nodeType==3&&!n.isWhitespace(t))return 0;t=t.nextSibling}return 1},trimWhiteTextNode:function(t){function i(i){for(var r;(r=t[i])&&r.nodeType==3&&n.isWhitespace(r);)t.removeChild(r)}i("firstChild");i("lastChild")},mergeChild:function(i,r,u){for(var e,s,o,h=n.getElementsByTagName(i,i.tagName.toLowerCase()),c=0,f;f=h[c++];)if(f.parentNode&&!n.isBookmarkNode(f)){if(f.tagName.toLowerCase()=="span"){if(i===f.parentNode&&(n.trimWhiteTextNode(i),i.childNodes.length==1)){i.style.cssText=f.style.cssText+";"+i.style.cssText;n.remove(f,!0);continue}if(f.style.cssText=i.style.cssText+";"+f.style.cssText,u&&(e=u.style,e))for(e=e.split(";"),s=0;o=e[s++];)f.style[t.cssStyleToDomStyle(o.split(":")[0])]=o.split(":")[1];n.isSameStyle(f,i)&&n.remove(f,!0);continue}n.isSameElement(i,f)&&n.remove(f,!0)}},getElementsByTagName:function(i,r,u){var o,f,s,h,c,l,e;for(u&&t.isString(u)&&(o=u,u=function(t){return n.hasClass(t,o)}),r=t.trim(r).replace(/[ ]{2,}/g," ").split(" "),f=[],s=0;h=r[s++];)for(c=i.getElementsByTagName(h),l=0;e=c[l++];)(!u||u(e))&&f.push(e);return f},mergeToParent:function(t){for(var i=t.parentNode;i&&f.$removeEmpty[i.tagName];){if(i.tagName==t.tagName||i.tagName=="A"){if(n.trimWhiteTextNode(i),i.tagName=="SPAN"&&!n.isSameStyle(i,t)||i.tagName=="A"&&t.tagName=="SPAN")if(i.childNodes.length>1||i!==t.parentNode){t.style.cssText=i.style.cssText+";"+t.style.cssText;i=i.parentNode;continue}else i.style.cssText+=";"+t.style.cssText,i.tagName=="A"&&(i.style.textDecoration="underline");if(i.tagName!="A"){i===t.parentNode&&n.remove(t,!0);break}}i=i.parentNode}},mergeSibling:function(t,i,r){function u(t,i,r){var u;if((u=r[t])&&!n.isBookmarkNode(u)&&u.nodeType==1&&n.isSameElement(r,u)){while(u.firstChild)i=="firstChild"?r.insertBefore(u.lastChild,r.firstChild):r.appendChild(u.firstChild);n.remove(u)}}i||u("previousSibling","firstChild",t);r||u("nextSibling","lastChild",t)},unSelectable:o&&r.ie9below||r.opera?function(n){n.onselectstart=function(){return!1};n.onclick=n.onkeyup=n.onkeydown=function(){return!1};n.unselectable="on";n.setAttribute("unselectable","on");for(var i=0,t;t=n.all[i++];)switch(t.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:t.unselectable="on";n.setAttribute("unselectable","on")}}:function(n){n.style.MozUserSelect=n.style.webkitUserSelect=n.style.msUserSelect=n.style.KhtmlUserSelect="none"},removeAttributes:function(n,i){var e,u,f;for(i=t.isArray(i)?i:t.trim(i).replace(/[ ]{2,}/g," ").split(" "),e=0;u=i[e++];){u=y[u]||u;switch(u){case"className":n[u]="";break;case"style":n.style.cssText="";f=n.getAttributeNode("style");!r.ie&&f&&n.removeAttributeNode(f)}n.removeAttribute(u)}},createElement:function(t,i,r){return n.setAttributes(t.createElement(i),r)},setAttributes:function(n,t){var i,r;for(i in t)if(t.hasOwnProperty(i)){r=t[i];switch(i){case"class":n.className=r;break;case"style":n.style.cssText=n.style.cssText+";"+r;break;case"innerHTML":n[i]=r;break;case"value":n.value=r;break;default:n.setAttribute(y[i]||i,r)}}return n},getComputedStyle:function(i,u){var e,o,s;if("width height top left".indexOf(u)>-1)return i["offset"+u.replace(/^\w/,function(n){return n.toUpperCase()})]+"px";if(i.nodeType==3&&(i=i.parentNode),r.ie&&r.version<9&&u=="font-size"&&!i.style.fontSize&&!f.$empty[i.tagName]&&!f.$nonChild[i.tagName])return e=i.ownerDocument.createElement("span"),e.style.cssText="padding:0;border:0;font-family:simsun;",e.innerHTML=".",i.appendChild(e),o=e.offsetHeight,i.removeChild(e),e=null,o+"px";try{s=n.getStyle(i,u)||(window.getComputedStyle?n.getWindow(i).getComputedStyle(i,"").getPropertyValue(u):(i.currentStyle||i.style)[t.cssStyleToDomStyle(u)])}catch(h){return""}return t.transUnitToPx(t.fixColor(u,s))},removeClasses:function(i,r){r=t.isArray(r)?r:t.trim(r).replace(/[ ]{2,}/g," ").split(" ");for(var e=0,f,u=i.className;f=r[e++];)u=u.replace(new RegExp("\\b"+f+"\\b"),"");u=t.trim(u).replace(/[ ]{2,}/g," ");u?i.className=u:n.removeAttributes(i,["class"])},addClass:function(n,i){if(n){i=t.trim(i).replace(/[ ]{2,}/g," ").split(" ");for(var f=0,r,u=n.className;r=i[f++];)new RegExp("\\b"+r+"\\b").test(u)||(u+=" "+r);n.className=t.trim(u)}},hasClass:function(n,i){if(t.isRegExp(i))return i.test(n.className);i=t.trim(i).replace(/[ ]{2,}/g," ").split(" ");for(var r=0,u,f=n.className;u=i[r++];)if(!new RegExp("\\b"+u+"\\b","i").test(f))return!1;return r-1==i.length},preventDefault:function(n){n.preventDefault?n.preventDefault():n.returnValue=!1},removeStyle:function(i,u){r.ie?(u=="color"&&(u="(^|;)"+u),i.style.cssText=i.style.cssText.replace(new RegExp(u+"[^:]*:[^;]+;?","ig"),"")):i.style.removeProperty?i.style.removeProperty(u):i.style.removeAttribute(t.cssStyleToDomStyle(u));i.style.cssText||n.removeAttributes(i,["style"])},getStyle:function(n,i){var r=n.style[t.cssStyleToDomStyle(i)];return t.fixColor(i,r)},setStyle:function(n,i,r){n.style[t.cssStyleToDomStyle(i)]=r;t.trim(n.style.cssText)||this.removeAttributes(n,"style")},setStyles:function(t,i){for(var r in i)i.hasOwnProperty(r)&&n.setStyle(t,r,i[r])},removeDirtyAttr:function(n){for(var i=0,t,r=n.getElementsByTagName("*");t=r[i++];)t.removeAttribute("_moz_dirty");n.removeAttribute("_moz_dirty")},getChildCount:function(n,t){var r=0,i=n.firstChild;for(t=t||function(){return 1};i;)t(i)&&r++,i=i.nextSibling;return r},isEmptyNode:function(t){return!t.firstChild||n.getChildCount(t,function(t){return!n.isBr(t)&&!n.isBookmarkNode(t)&&!n.isWhitespace(t)})==0},clearSelectedArr:function(t){for(var i;i=t.pop();)n.removeAttributes(i,["class"])},scrollToView:function(t,i,r){var s=function(){var n=i.document,t=n.compatMode=="CSS1Compat";return{width:(t?n.documentElement.clientWidth:n.body.clientWidth)||0,height:(t?n.documentElement.clientHeight:n.body.clientHeight)||0}},h=function(n){if("pageXOffset"in n)return{x:n.pageXOffset||0,y:n.pageYOffset||0};var t=n.document;return{x:t.documentElement.scrollLeft||t.body.scrollLeft||0,y:t.documentElement.scrollTop||t.body.scrollTop||0}},e=s().height,u=e*-1+r,o,f;u+=t.offsetHeight||0;o=n.getXY(t);u+=o.y;f=h(i).y;(u>f||u<f-e)&&i.scrollTo(0,u+(u<0?-20:20))},isBr:function(n){return n.nodeType==1&&n.tagName=="BR"},isFillChar:function(t,i){if(t.nodeType!=3)return!1;var r=t.nodeValue;return i?new RegExp("^"+n.fillChar).test(r):!r.replace(new RegExp(n.fillChar,"g"),"").length},isStartInblock:function(t){var r=t.cloneRange(),o=0,i=r.startContainer,f,u,e;if(i.nodeType==1&&i.childNodes[r.startOffset])for(i=i.childNodes[r.startOffset],u=i.previousSibling;u&&n.isFillChar(u);)i=u,u=u.previousSibling;for(this.isFillChar(i,!0)&&r.startOffset==1&&(r.setStartBefore(i),i=r.startContainer);i&&n.isFillChar(i);)f=i,i=i.previousSibling;for(f&&(r.setStartBefore(f),i=r.startContainer),i.nodeType==1&&n.isEmptyNode(i)&&r.startOffset==1&&r.setStart(i,0).collapse(!0);!r.startOffset;){if(i=r.startContainer,n.isBlockElm(i)||n.isBody(i)){o=1;break}if(u=r.startContainer.previousSibling,u){while(u&&n.isFillChar(u))e=u,u=u.previousSibling;e?r.setStartBefore(e):r.setStartBefore(r.startContainer)}else r.setStartBefore(r.startContainer)}return o&&!n.isBody(r.startContainer)?1:0},isEmptyBlock:function(t,i){if(t.nodeType!=1||(i=i||new RegExp("[  \t\r\n"+n.fillChar+"]","g"),t[r.ie?"innerText":"textContent"].replace(i,"").length>0))return 0;for(var u in f.$isNotEmpty)if(t.getElementsByTagName(u).length)return 0;return 1},setViewportOffset:function(n,t){var f=parseInt(n.style.left)|0,e=parseInt(n.style.top)|0,i=n.getBoundingClientRect(),r=t.left-i.left,u=t.top-i.top;r&&(n.style.left=f+r+"px");u&&(n.style.top=e+u+"px")},fillNode:function(t,i){var u=r.ie?t.createTextNode(n.fillChar):t.createElement("br");i.innerHTML="";i.appendChild(u)},moveChild:function(n,t,i){while(n.firstChild)i&&t.firstChild?t.insertBefore(n.lastChild,t.firstChild):t.appendChild(n.firstChild)},hasNoAttributes:function(n){return r.ie?/^<\w+\s*?>/.test(n.outerHTML):n.attributes.length==0},isCustomeNode:function(n){return n.nodeType==1&&n.getAttribute("_ue_custom_node_")},isTagNode:function(n,t){return n.nodeType==1&&new RegExp("\\b"+n.tagName+"\\b","i").test(t)},filterNodeList:function(n,i,r){var u=[],f;return t.isFunction(i)||(f=i,i=function(n){return t.indexOf(t.isArray(f)?f:f.split(" "),n.tagName.toLowerCase())!=-1}),t.each(n,function(n){i(n)&&u.push(n)}),u.length==0?null:u.length==1||!r?u[0]:u},isInNodeEndBoundary:function(n,t){var i=n.startContainer;if(i.nodeType==3&&n.startOffset!=i.nodeValue.length||i.nodeType==1&&n.startOffset!=i.childNodes.length)return 0;while(i!==t){if(i.nextSibling)return 0;i=i.parentNode}return 1},isBoundaryNode:function(t,i){for(var r;!n.isBody(t);)if(r=t,t=t.parentNode,r!==t[i])return!1;return!0},fillHtml:r.ie11below?"&nbsp;":"<br/>"},h=new RegExp(n.fillChar,"g");(function(){function p(n){n.collapsed=n.startContainer&&n.endContainer&&n.startContainer===n.endContainer&&n.startOffset==n.endOffset}function l(n){return!n.collapsed&&n.startContainer.nodeType==1&&n.startContainer===n.endContainer&&n.endOffset-n.startOffset==1}function a(t,i,r,u){return i.nodeType==1&&(f.$empty[i.tagName]||f.$nonChild[i.tagName])&&(r=n.getNodeIndex(i)+(t?0:1),i=i.parentNode),t?(u.startContainer=i,u.startOffset=r,u.endContainer||u.collapse(!0)):(u.endContainer=i,u.endOffset=r,u.startContainer||u.collapse(!1)),p(u),u}function s(t,i){var r=t.startContainer,o=t.endContainer,s=t.startOffset,w=t.endOffset,l=t.document,b=l.createDocumentFragment(),k,d,f,y,h,p;if(r.nodeType==1&&(r=r.childNodes[s]||(k=r.appendChild(l.createTextNode("")))),o.nodeType==1&&(o=o.childNodes[w]||(d=o.appendChild(l.createTextNode("")))),r===o&&r.nodeType==3)return b.appendChild(l.createTextNode(r.substringData(s,w-s))),i&&(r.deleteData(s,w-s),t.collapse(!0)),b;var u,a,e=b,c=n.findParents(r,!0),v=n.findParents(o,!0);for(f=0;c[f]==v[f];)f++;for(h=f;y=c[h];h++){for(u=y.nextSibling,y==r?k||(t.startContainer.nodeType==3?(e.appendChild(l.createTextNode(r.nodeValue.slice(s))),i&&r.deleteData(s,r.nodeValue.length-s)):e.appendChild(i?r:r.cloneNode(!0))):(a=y.cloneNode(!1),e.appendChild(a));u;){if(u===o||u===v[h])break;y=u.nextSibling;e.appendChild(i?u:u.cloneNode(!0));u=y}e=a}for(e=b,c[f]||(e.appendChild(c[f-1].cloneNode(!1)),e=e.firstChild),h=f;p=v[h];h++){if(u=p.previousSibling,p==o?d||t.endContainer.nodeType!=3||(e.appendChild(l.createTextNode(o.substringData(0,w))),i&&o.deleteData(0,w)):(a=p.cloneNode(!1),e.appendChild(a)),h!=f||!c[f])while(u){if(u===r)break;p=u.previousSibling;e.insertBefore(i?u:u.cloneNode(!0),e.firstChild);u=p}e=a}return i&&t.setStartBefore(v[f]?c[f]?v[f]:c[f-1]:v[f-1]).collapse(!0),k&&n.remove(k),d&&n.remove(d),b}function y(t,u){try{if(i&&n.inDoc(i,t))if(i.nodeValue.replace(h,"").length)i.nodeValue=i.nodeValue.replace(h,"");else{var f=i.parentNode;for(n.remove(i);f&&n.isEmptyInlineElement(f)&&(r.safari?!(n.getPosition(f,u)&n.POSITION_CONTAINS):!f.contains(u));)i=f.parentNode,n.remove(f),f=i}}catch(e){}}function u(t,i){var r;for(t=t[i];t&&n.isFillChar(t);)r=t[i],n.remove(t),t=r}var c=0,o=n.fillChar,i,v=e.Range=function(n){var t=this;t.startContainer=t.startOffset=t.endContainer=t.endOffset=null;t.document=n;t.collapsed=!0};v.prototype={cloneContents:function(){return this.collapsed?null:s(this,0)},deleteContents:function(){var t;return this.collapsed||s(this,1),r.webkit&&(t=this.startContainer,t.nodeType!=3||t.nodeValue.length||(this.setStartBefore(t).collapse(!0),n.remove(t))),this},extractContents:function(){return this.collapsed?null:s(this,2)},setStart:function(n,t){return a(!0,n,t,this)},setEnd:function(n,t){return a(!1,n,t,this)},setStartAfter:function(t){return this.setStart(t.parentNode,n.getNodeIndex(t)+1)},setStartBefore:function(t){return this.setStart(t.parentNode,n.getNodeIndex(t))},setEndAfter:function(t){return this.setEnd(t.parentNode,n.getNodeIndex(t)+1)},setEndBefore:function(t){return this.setEnd(t.parentNode,n.getNodeIndex(t))},setStartAtFirst:function(n){return this.setStart(n,0)},setStartAtLast:function(n){return this.setStart(n,n.nodeType==3?n.nodeValue.length:n.childNodes.length)},setEndAtFirst:function(n){return this.setEnd(n,0)},setEndAtLast:function(n){return this.setEnd(n,n.nodeType==3?n.nodeValue.length:n.childNodes.length)},selectNode:function(n){return this.setStartBefore(n).setEndAfter(n)},selectNodeContents:function(n){return this.setStart(n,0).setEndAtLast(n)},cloneRange:function(){var n=this;return new v(n.document).setStart(n.startContainer,n.startOffset).setEnd(n.endContainer,n.endOffset)},collapse:function(n){var t=this;return n?(t.endContainer=t.startContainer,t.endOffset=t.startOffset):(t.startContainer=t.endContainer,t.startOffset=t.endOffset),t.collapsed=!0,t},shrinkBoundary:function(t){function u(t){return t.nodeType==1&&!n.isBookmarkNode(t)&&!f.$empty[t.tagName]&&!f.$nonChild[t.tagName]}for(var i=this,r,e=i.collapsed;i.startContainer.nodeType==1&&(r=i.startContainer.childNodes[i.startOffset])&&u(r);)i.setStart(r,0);if(e)return i.collapse(!0);if(!t)while(i.endContainer.nodeType==1&&i.endOffset>0&&(r=i.endContainer.childNodes[i.endOffset-1])&&u(r))i.setEnd(r,r.childNodes.length);return i},getCommonAncestor:function(t,i){var u=this,r=u.startContainer,f=u.endContainer;return r===f?t&&l(this)&&(r=r.childNodes[u.startOffset],r.nodeType==1)?r:i&&r.nodeType==3?r.parentNode:r:n.getCommonAncestor(r,f)},trimBoundary:function(t){var f;this.txtToElmBoundary();var u=this.startContainer,i=this.startOffset,e=this.collapsed,r=this.endContainer;return u.nodeType==3&&(i==0?this.setStartBefore(u):i>=u.nodeValue.length?this.setStartAfter(u):(f=n.split(u,i),u===r?this.setEnd(f,this.endOffset-i):u.parentNode===r&&(this.endOffset+=1),this.setStartBefore(f)),e)?this.collapse(!0):(t||(i=this.endOffset,r=this.endContainer,r.nodeType==3&&(i==0?this.setEndBefore(r):(i<r.nodeValue.length&&n.split(r,i),this.setEndAfter(r)))),this)},txtToElmBoundary:function(n){function t(n,t){var i=n[t+"Container"],r=n[t+"Offset"];i.nodeType==3&&(r?r>=i.nodeValue.length&&n["set"+t.replace(/(\w)/,function(n){return n.toUpperCase()})+"After"](i):n["set"+t.replace(/(\w)/,function(n){return n.toUpperCase()})+"Before"](i))}return(n||!this.collapsed)&&(t(this,"start"),t(this,"end")),this},insertNode:function(n){var t=n,r=1;n.nodeType==11&&(t=n.firstChild,r=n.childNodes.length);this.trimBoundary(!0);var i=this.startContainer,f=this.startOffset,u=i.childNodes[f];return u?i.insertBefore(n,u):i.appendChild(n),t.parentNode===this.endContainer&&(this.endOffset=this.endOffset+r),this.setStartBefore(t)},setCursor:function(n,t){return this.collapse(!n).select(t)},createBookmark:function(n,t){var i,r=this.document.createElement("span");return r.style.cssText="display:none;line-height:0px;",r.appendChild(this.document.createTextNode("‍")),r.id="_baidu_bookmark_start_"+(t?"":c++),this.collapsed||(i=r.cloneNode(!0),i.id="_baidu_bookmark_end_"+(t?"":c++)),this.insertNode(r),i&&this.collapse().insertNode(i).setEndBefore(i),this.setStartAfter(r),{start:n?r.id:r,end:i?n?i.id:i:null,id:n}},moveToBookmark:function(t){var r=t.id?this.document.getElementById(t.start):t.start,i=t.end&&t.id?this.document.getElementById(t.end):t.end;return this.setStartBefore(r),n.remove(r),i?(this.setEndBefore(i),n.remove(i)):this.collapse(!0),this},enlarge:function(t,i){var e=n.isBody,u,r,f=this.document.createTextNode("");if(t){for(r=this.startContainer,r.nodeType==1?r.childNodes[this.startOffset]?u=r=r.childNodes[this.startOffset]:(r.appendChild(f),u=r=f):u=r;;){if(n.isBlockElm(r)){for(r=u;(u=r.previousSibling)&&!n.isBlockElm(u);)r=u;this.setStartBefore(r);break}u=r;r=r.parentNode}for(r=this.endContainer,r.nodeType==1?((u=r.childNodes[this.endOffset])?r.insertBefore(f,u):r.appendChild(f),u=r=f):u=r;;){if(n.isBlockElm(r)){for(r=u;(u=r.nextSibling)&&!n.isBlockElm(u);)r=u;this.setEndAfter(r);break}u=r;r=r.parentNode}f.parentNode===this.endContainer&&this.endOffset--;n.remove(f)}if(!this.collapsed){while(this.startOffset==0){if(i&&i(this.startContainer))break;if(e(this.startContainer))break;this.setStartBefore(this.startContainer)}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(i&&i(this.endContainer))break;if(e(this.endContainer))break;this.setEndAfter(this.endContainer)}}return this},enlargeToBlockElm:function(t){while(!n.isBlockElm(this.startContainer))this.setStartBefore(this.startContainer);if(!t)while(!n.isBlockElm(this.endContainer))this.setEndAfter(this.endContainer);return this},adjustmentBoundary:function(){if(!this.collapsed){while(!n.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length&&this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length)this.setStartAfter(this.startContainer);while(!n.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[this.endContainer.nodeType==3?"nodeValue":"childNodes"].length)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(t,i,r){var p,u,s,w,b,k,v;if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(t){return t.nodeType==1&&n.isBlockElm(t)}).adjustmentBoundary();for(var c=this.createBookmark(),l=c.end,a=function(t){return t.nodeType==1?t.tagName.toLowerCase()!="br":!n.isWhitespace(t)},o=n.getNextDomNode(c.start,!1,a),e,y,h=this.cloneRange();o&&n.getPosition(o,l)&n.POSITION_PRECEDING;)if(o.nodeType==3||f[t][o.tagName]){for(h.setStartBefore(o),e=o;e&&(e.nodeType==3||f[t][e.tagName])&&e!==l;)y=e,e=n.getNextDomNode(e,e.nodeType==1,null,function(n){return f[t][n.tagName]});if(p=h.setEndAfter(y).extractContents(),r&&r.length>0){for(w=s=r[0].cloneNode(!1),b=1;k=r[b++];)s.appendChild(k.cloneNode(!1)),s=s.firstChild;u=s}else u=h.document.createElement(t);if(i&&n.setAttributes(u,i),u.appendChild(p),h.insertNode(r?w:u),t=="span"&&i.style&&/text\-decoration/.test(i.style)&&(v=n.findParentByTagName(u,"a",!0))?(n.setAttributes(v,i),n.remove(u,!0),u=v):(n.mergeSibling(u),n.clearEmptySibling(u)),n.mergeChild(u,i),o=n.getNextDomNode(u,!1,a),n.mergeToParent(u),e===l)break}else o=n.getNextDomNode(o,!0,a);return this.moveToBookmark(c)},removeInlineStyle:function(i){var r,u,f,s,o,e,h;if(this.collapsed)return this;for(i=t.isArray(i)?i:[i],this.shrinkBoundary().adjustmentBoundary(),r=this.startContainer,u=this.endContainer;;){if(r.nodeType==1){if(t.indexOf(i,r.tagName.toLowerCase())>-1)break;if(r.tagName.toLowerCase()=="body"){r=null;break}}r=r.parentNode}for(;;){if(u.nodeType==1){if(t.indexOf(i,u.tagName.toLowerCase())>-1)break;if(u.tagName.toLowerCase()=="body"){u=null;break}}u=u.parentNode}for(f=this.createBookmark(),r&&(o=this.cloneRange().setEndBefore(f.start).setStartBefore(r),s=o.extractContents(),o.insertNode(s),n.clearEmptySibling(r,!0),r.parentNode.insertBefore(f.start,r)),u&&(o=this.cloneRange().setStartAfter(f.end).setEndAfter(u),s=o.extractContents(),o.insertNode(s),n.clearEmptySibling(u,!1,!0),u.parentNode.insertBefore(f.end,u.nextSibling)),e=n.getNextDomNode(f.start,!1,function(n){return n.nodeType==1});e&&e!==f.end;)h=n.getNextDomNode(e,!0,function(n){return n.nodeType==1}),t.indexOf(i,e.tagName.toLowerCase())>-1&&n.remove(e,!0),e=h;return this.moveToBookmark(f)},getClosedNode:function(){var i,t,n;return this.collapsed||(t=this.cloneRange().adjustmentBoundary().shrinkBoundary(),l(t)&&(n=t.startContainer.childNodes[t.startOffset],n&&n.nodeType==1&&(f.$empty[n.tagName]||f.$nonChild[n.tagName])&&(i=n))),i},select:r.ie?function(t,r){var f,l,h,e,v,a,c,s;if(this.collapsed||this.shrinkBoundary(),l=this.getClosedNode(),l&&!r){try{f=this.document.body.createControlRange();f.addElement(l);f.select()}catch(p){}return this}h=this.createBookmark();e=h.start;f=this.document.body.createTextRange();f.moveToElementText(e);f.moveStart("character",1);this.collapsed?t||this.startContainer.nodeType==3||(c=this.document.createTextNode(o),s=this.document.createElement("span"),s.appendChild(this.document.createTextNode(o)),e.parentNode.insertBefore(s,e),e.parentNode.insertBefore(c,e),y(this.document,c),i=c,u(s,"previousSibling"),u(e,"nextSibling"),f.moveStart("character",-1),f.collapse(!0)):(a=this.document.body.createTextRange(),v=h.end,a.moveToElementText(v),f.setEndPoint("EndToEnd",a));this.moveToBookmark(h);s&&n.remove(s);try{f.select()}catch(p){}return this}:function(t){function a(n){function t(t,i,r){t.nodeType==3&&t.nodeValue.length<i&&(n[r+"Offset"]=t.nodeValue.length)}t(n.startContainer,n.startOffset,"start");t(n.endContainer,n.endOffset,"end")}var l=n.getWindow(this.document),c=l.getSelection(),e,s,h,f;if(r.gecko?this.document.body.focus():l.focus(),c){if(c.removeAllRanges(),this.collapsed&&!t&&(s=this.startContainer,f=s,s.nodeType==1&&(f=s.childNodes[this.startOffset]),s.nodeType==3&&this.startOffset||(f?f.previousSibling&&f.previousSibling.nodeType==3:s.lastChild&&s.lastChild.nodeType==3)||(e=this.document.createTextNode(o),this.insertNode(e),y(this.document,e),u(e,"previousSibling"),u(e,"nextSibling"),i=e,this.setStart(e,r.webkit?1:0).collapse(!0))),h=this.document.createRange(),this.collapsed&&r.opera&&this.startContainer.nodeType==1)if(f=this.startContainer.childNodes[this.startOffset],f){while(f&&n.isBlockElm(f))if(f.nodeType==1&&f.childNodes[0])f=f.childNodes[0];else break;f&&this.setStartBefore(f).collapse(!0)}else f=this.startContainer.lastChild,f&&n.isBr(f)&&this.setStartBefore(f).collapse(!0);a(this);h.setStart(this.startContainer,this.startOffset);h.setEnd(this.endContainer,this.endOffset);c.addRange(h)}return this},scrollToView:function(t,i){t=t?window:n.getWindow(this.document);var u=this,r=u.document.createElement("span");return r.innerHTML="&nbsp;",u.cloneRange().insertNode(r),n.scrollToView(r,t,i),n.remove(r),u},inFillChar:function(){var t=this.startContainer;return this.collapsed&&t.nodeType==3&&t.nodeValue.replace(new RegExp("^"+n.fillChar),"").length+1==t.nodeValue.length?!0:!1},createAddress:function(t,i){function f(t){for(var e,o,u,f=t?r.startContainer:r.endContainer,l=n.findParents(f,!0,function(t){return!n.isBody(t)}),s=[],a=0,c;c=l[a++];)s.push(n.getNodeIndex(c,i));if(e=0,i)if(f.nodeType==3){for(o=f.previousSibling;o&&o.nodeType==3;)e+=o.nodeValue.replace(h,"").length,o=o.previousSibling;e+=t?r.startOffset:r.endOffset}else if(f=f.childNodes[t?r.startOffset:r.endOffset],f)e=n.getNodeIndex(f,i);else for(f=t?r.startContainer:r.endContainer,u=f.firstChild;u;){if(n.isFillChar(u)){u=u.nextSibling;continue}if(e++,u.nodeType==3)while(u&&u.nodeType==3)u=u.nextSibling;else u=u.nextSibling}else e=t?n.isFillChar(f)?0:r.startOffset:r.endOffset;return e<0&&(e=0),s.push(e),s}var u={},r=this;return u.startAddress=f(!0),t||(u.endAddress=r.collapsed?[].concat(u.startAddress):f()),u},moveToAddress:function(n,t){function r(n,t){for(var r=i.document.body,u,f,e=0,o,s=n.length;e<s;e++)if(o=n[e],u=r,r=r.childNodes[o],!r){f=o;break}t?r?i.setStartBefore(r):i.setStart(u,f):r?i.setEndBefore(r):i.setEnd(u,f)}var i=this;return r(n.startAddress,!0),!t&&n.endAddress&&r(n.endAddress),i},equals:function(n){for(var t in this)if(this.hasOwnProperty(t)&&this[t]!==n[t])return!1;return!0},traversal:function(t,i){var e;if(this.collapsed)return this;for(var u=this.createBookmark(),f=u.end,r=n.getNextDomNode(u.start,!1,i);r&&r!==f&&n.getPosition(r,f)&n.POSITION_PRECEDING;)e=n.getNextDomNode(r,!1,i),t(r),r=e;return this.moveToBookmark(u)}}})(),function(){function i(t,i){var l=n.getNodeIndex,e,o,y,p;if(t=t.duplicate(),t.collapse(i),e=t.parentElement(),!e.hasChildNodes())return{container:e,offset:0};for(var s=e.children,r,h=t.duplicate(),a=0,v=s.length-1,c=-1,u;a<=v;)if(c=Math.floor((a+v)/2),r=s[c],h.moveToElementText(r),o=h.compareEndPoints("StartToStart",t),o>0)v=c-1;else if(o<0)a=c+1;else return{container:e,offset:l(r)};if(c==-1){if(h.moveToElementText(e),h.setEndPoint("StartToStart",t),u=h.text.replace(/(\r\n|\r)/g,"\n").length,s=e.childNodes,!u)return r=s[s.length-1],{container:r,offset:r.nodeValue.length};for(y=s.length;u>0;)u-=s[--y].nodeValue.length;return{container:s[y],offset:-u}}if(h.collapse(o>0),h.setEndPoint(o>0?"StartToStart":"EndToStart",t),u=h.text.replace(/(\r\n|\r)/g,"\n").length,!u)return f.$empty[r.tagName]||f.$nonChild[r.tagName]?{container:e,offset:l(r)+(o>0?0:1)}:{container:r,offset:o>0?0:r.childNodes.length};while(u>0)try{p=r;r=r[o>0?"previousSibling":"nextSibling"];u-=r.nodeValue.length}catch(w){return{container:e,offset:l(p)}}return{container:r,offset:o>0?-u:r.nodeValue.length+u}}function o(n,t){if(n.item)t.selectNode(n.item(0));else{var r=i(n,!0);t.setStart(r.container,r.offset);n.compareEndPoints("StartToEnd",n)!=0&&(r=i(n,!1),t.setEnd(r.container,r.offset))}return t}function t(n){var t,i;try{t=n.getNative().createRange()}catch(r){return null}return(i=t.item?t.item(0):t.parentElement(),(i.ownerDocument||i)===n.document)?t:null}var s=e.Selection=function(i){var u=this,f;if(u.document=i,r.ie9below){f=n.getWindow(i).frameElement;n.on(f,"beforedeactivate",function(){u._bakIERange=u.getIERange()});n.on(f,"activate",function(){try{!t(u)&&u._bakIERange&&u._bakIERange.select()}catch(n){}u._bakIERange=null})}f=i=null};s.prototype={rangeInBody:function(t,i){var u=r.ie9below||i?t.item?t.item():t.parentElement():t.startContainer;return u===this.document.body||n.inDoc(u,this.document)},getNative:function(){var t=this.document;try{return t?r.ie9below?t.selection:n.getWindow(t).getSelection():null}catch(i){return null}},getIERange:function(){var n=t(this);return!n&&this._bakIERange?this._bakIERange:n},cache:function(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart();this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var t=this.getStart();return t?n.findParents(t,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{if(r.ie9below){var n=t(this);return!!(n&&this.rangeInBody(n))}return!!this.getNative().rangeCount}catch(i){return!1}},getRange:function(){function e(n){for(var t=i.document.body.firstChild,r=n.collapsed;t&&t.firstChild;)n.setStart(t,0),t=t.firstChild;n.startContainer||n.setStart(i.document.body,0);r&&n.collapse(!0)}var i=this,t,s,f,h,c;if(i._cachedRange!=null)return this._cachedRange;if(t=new u.editor.dom.Range(i.document),r.ie9below)if(s=i.getIERange(),s)try{o(s,t)}catch(l){e(t)}else e(t);else if(f=i.getNative(),f&&f.rangeCount)h=f.getRangeAt(0),c=f.getRangeAt(f.rangeCount-1),t.setStart(h.startContainer,h.startOffset).setEnd(c.endContainer,c.endOffset),t.collapsed&&n.isBody(t.startContainer)&&!t.startOffset&&e(t);else{if(this._bakRange&&n.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;e(t)}return this._bakRange=t},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var t=r.ie9below?this.getIERange():this.getRange(),i,n,u,f;if(r.ie9below){if(!t)return this.document.body.firstChild;if(t.item)return t.item(0);for(i=t.duplicate(),i.text.length>0&&i.moveStart("character",1),i.collapse(1),n=i.parentElement(),f=u=t.parentElement();u=u.parentNode;)if(u==n){n=f;break}}else if(t.shrinkBoundary(),n=t.startContainer,n.nodeType==1&&n.hasChildNodes()&&(n=n.childNodes[Math.min(n.childNodes.length-1,t.startOffset)]),n.nodeType==3)return n.parentNode;return n},getText:function(){var n,t;return this.isFocus()&&(n=this.getNative())?(t=r.ie9below?n.createRange():n.getRangeAt(0),r.ie9below?t.text:t.toString()):""},clearRange:function(){this.getNative()[r.ie9below?"empty":"removeAllRanges"]()}}}(),function(){function i(i,r){var u,e,f,o;if(r.textarea)if(t.isString(r.textarea)){for(e=0,o=n.getElementsByTagName(i,"textarea");f=o[e++];)if(f.id=="ueditor_textarea_"+r.options.textarea){u=f;break}}else u=r.textarea;u||(i.appendChild(u=n.createElement(document,"textarea",{name:r.options.textarea,id:"ueditor_textarea_"+r.options.textarea,style:"display:none"})),r.textarea=u);u.getAttribute("name")||u.setAttribute("name",r.options.textarea);u.value=r.hasContents()?r.options.allHtmlEnabled?r.getAllHtml():r.getContent(null,null,!0):""}function a(n){for(var t in n)return t}function h(n){n.langIsReady=!0;n.fireEvent("langReady")}var l=0,s,u=UE.Editor=function(n){var i=this;i.uid=l++;c.call(i);i.commands={};i.options=t.extend(t.clone(n||{}),UEDITOR_CONFIG,!0);i.shortcutkeys={};i.inputRules=[];i.outputRules=[];i.setOpt(u.defaultOptions(i));i.loadServerConfig();t.isEmptyObject(UE.I18N)?t.loadFile(document,{src:i.options.langPath+i.options.lang+"/"+i.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){UE.plugin.load(i);h(i)}):(i.options.lang=a(UE.I18N),UE.plugin.load(i),h(i));UE.instants["ueditorInstant"+i.uid]=i};u.prototype={registerCommand:function(n,t){this.commands[n]=t},ready:function(n){var t=this;n&&(t.isReady?n.apply(t):t.addListener("ready",n))},setOpt:function(n,i){var r={};t.isString(n)?r[n]=i:r=n;t.extend(this.options,r,!0)},getOpt:function(n){return this.options[n]},destroy:function(){var t=this,r,i,f,u;t.fireEvent("destroy");r=t.container.parentNode;i=t.textarea;i?i.style.display="":(i=document.createElement("textarea"),r.parentNode.insertBefore(i,r));i.style.width=t.iframe.offsetWidth+"px";i.style.height=t.iframe.offsetHeight+"px";i.value=t.getContent();i.id=t.key;r.innerHTML="";n.remove(r);f=t.key;for(u in t)t.hasOwnProperty(u)&&delete this[u];UE.delEditor(f)},render:function(i){var e=this,u=e.options,f=function(t){return parseInt(n.getComputedStyle(i,t))},s;t.isString(i)&&(i=document.getElementById(i));i&&(u.minFrameWidth=u.initialFrameWidth?u.initialFrameWidth:u.initialFrameWidth=i.offsetWidth,u.initialFrameHeight?u.minFrameHeight=u.initialFrameHeight:u.initialFrameHeight=u.minFrameHeight=i.offsetHeight,i.style.width=/%$/.test(u.initialFrameWidth)?"100%":u.initialFrameWidth-f("padding-left")-f("padding-right")+"px",i.style.height=/%$/.test(u.initialFrameHeight)?"100%":u.initialFrameHeight-f("padding-top")-f("padding-bottom")+"px",i.style.zIndex=u.zIndex,s=(o&&r.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml' class='view' ><head><style type='text/css'>.view{padding:0;word-wrap:break-word;cursor:text;height:90%;}\nbody{margin:8px;font-family:sans-serif;font-size:16px;}p{margin:5px 0;}<\/style>"+(u.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+t.unhtml(u.iframeCssUrl)+"'/>":"")+(u.initialStyle?"<style>"+u.initialStyle+"<\/style>":"")+"<\/head><body class='view' ><\/body><script type='text/javascript' "+(o?"defer='defer'":"")+" id='_initialScript'>setTimeout(function(){editor = window.parent.UE.instants['ueditorInstant"+e.uid+"'];editor._setup(document);},0);var _tmpScript = document.getElementById('_initialScript');_tmpScript.parentNode.removeChild(_tmpScript);<\/script><\/html>",i.appendChild(n.createElement(document,"iframe",{id:"ueditor_"+e.uid,width:"100%",height:"100%",frameborder:"0",src:"javascript:void(function(){document.open();"+(u.customDomain&&document.domain!=location.hostname?'document.domain="'+document.domain+'";':"")+'document.write("'+s+'");document.close();}())'})),i.style.overflow="hidden",setTimeout(function(){/%$/.test(u.initialFrameWidth)&&(u.minFrameWidth=u.initialFrameWidth=i.offsetWidth);/%$/.test(u.initialFrameHeight)&&(u.minFrameHeight=u.initialFrameHeight=i.offsetHeight,i.style.height=u.initialFrameHeight+"px")}))},_setup:function(t){var u=this,f=u.options,h,s,c;for(o?(t.body.disabled=!0,t.body.contentEditable=!0,t.body.disabled=!1):t.body.contentEditable=!0,t.body.spellcheck=!1,u.document=t,u.window=t.defaultView||t.parentWindow,u.iframe=u.window.frameElement,u.body=t.body,u.selection=new e.Selection(t),r.gecko&&(h=this.selection.getNative())&&h.removeAllRanges(),this._initEvents(),s=this.iframe.parentNode;!n.isBody(s);s=s.parentNode)if(s.tagName=="FORM"){if(u.form=s,u.options.autoSyncData)n.on(u.window,"blur",function(){i(s,u)});else n.on(s,"submit",function(){i(this,u)});break}f.initialContent&&(f.autoClearinitialContent?(c=u.execCommand,u.execCommand=function(){return u.fireEvent("firstBeforeExecCommand"),c.apply(u,arguments)},this._setDefaultContent(f.initialContent)):this.setContent(f.initialContent,!1,!0));n.isEmptyNode(u.body)&&(u.body.innerHTML="<p>"+(r.ie?"":"<br/>")+"<\/p>");f.focus&&setTimeout(function(){u.focus(u.options.focusInEnd);u.options.autoClearinitialContent||u._selectionChange()},0);u.container||(u.container=this.iframe.parentNode);f.fullscreen&&u.ui&&u.ui.setFullScreen(!0);try{u.document.execCommand("2D-position",!1,!1)}catch(l){}try{u.document.execCommand("enableInlineTableEditing",!1,!1)}catch(l){}try{u.document.execCommand("enableObjectResizing",!1,!1)}catch(l){}if(u._bindshortcutKeys(),u.isReady=1,u.fireEvent("ready"),f.onready&&f.onready.call(u),!r.ie9below)n.on(u.window,["blur","focus"],function(n){if(n.type=="blur"){u._bakRange=u.selection.getRange();try{u._bakNativeRange=u.selection.getNative().getRangeAt(0);u.selection.getNative().removeAllRanges()}catch(n){u._bakNativeRange=null}}else try{u._bakRange&&u._bakRange.select()}catch(n){}});r.gecko&&r.version<=10902&&(u.body.contentEditable=!1,setTimeout(function(){u.body.contentEditable=!0},100),setInterval(function(){u.body.style.height=u.iframe.offsetHeight-20+"px"},100));f.isShow||u.setHide();f.readonly&&u.setDisabled()},sync:function(t){var r=this,u=t?document.getElementById(t):n.findParent(r.iframe.parentNode,function(n){return n.tagName=="FORM"},!0);u&&i(u,r)},setHeight:function(n,t){n!==parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=n+"px");t||(this.options.minFrameHeight=this.options.initialFrameHeight=n);this.body.style.height=n+"px";t||this.trigger("setHeight")},addshortcutkey:function(n,i){var r={};i?r[n]=i:r=n;t.extend(this.shortcutkeys,r)},_bindshortcutKeys:function(){var t=this,i=this.shortcutkeys;t.addListener("keydown",function(r,u){var h=u.keyCode||u.which,e,c,l,f,o,s;for(e in i)for(c=i[e].split(","),l=0;f=c[l++];)f=f.split(":"),o=f[0],s=f[1],(/^(ctrl)(\+shift)?\+(\d+)$/.test(o.toLowerCase())||/^(\d+)$/.test(o))&&((RegExp.$1=="ctrl"?u.ctrlKey||u.metaKey:0)&&(RegExp.$2!=""?u[RegExp.$2.slice(1)+"Key"]:1)&&h==RegExp.$3||h==RegExp.$1)&&(t.queryCommandState(e,s)!=-1&&t.execCommand(e,s),n.preventDefault(u))})},getContent:function(n,i,r,u,f){var e=this,o;return(n&&t.isFunction(n)&&(i=n,n=""),i?!i():!this.hasContents())?"":(e.fireEvent("beforegetcontent"),o=UE.htmlparser(e.body.innerHTML,u),e.filterOutputRule(o),e.fireEvent("aftergetcontent",n,o),o.toHtml(f))},getAllHtml:function(){var n=this,u=[],i;return n.fireEvent("getAllHtml",u),r.ie&&r.version>8&&(i="",t.each(n.document.styleSheets,function(n){i+=n.href?'<link rel="stylesheet" type="text/css" href="'+n.href+'" />':"<style>"+n.cssText+"<\/style>"}),t.each(n.document.getElementsByTagName("script"),function(n){i+=n.outerHTML})),"<html><head>"+(n.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+n.options.charset+'"/>':"")+(i||n.document.getElementsByTagName("head")[0].innerHTML)+u.join("\n")+"<\/head><body "+(o&&r.version<9?'class="view"':"")+">"+n.getContent(null,null,!0)+"<\/body><\/html>"},getPlainTxt:function(){var i=new RegExp(n.fillChar,"g"),t=this.body.innerHTML.replace(/[\n\r]/g,"");return t=t.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(n,t,i){return f.$block[i]?"\n":t?t:""}),t.replace(i,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var t=new RegExp(n.fillChar,"g");return this.body[r.ie?"innerText":"textContent"].replace(t,"").replace(/\u00a0/g," ")},setContent:function(t,u,e){function v(n){return n.tagName=="DIV"&&n.getAttribute("cdata_tag")}var s=this,c,o,l,h,a;if(s.fireEvent("beforesetcontent",t),c=UE.htmlparser(t),s.filterInputRule(c),t=c.toHtml(),s.body.innerHTML=(u?s.body.innerHTML:"")+t,s.options.enterTag=="p")if(o=this.body.firstChild,!o||o.nodeType==1&&(f.$cdata[o.tagName]||v(o)||n.isCustomeNode(o))&&o===this.body.lastChild)this.body.innerHTML="<p>"+(r.ie?"&nbsp;":"<br/>")+"<\/p>"+this.body.innerHTML;else for(h=s.document.createElement("p");o;){while(o&&(o.nodeType==3||o.nodeType==1&&f.p[o.tagName]&&!f.$cdata[o.tagName]))l=o.nextSibling,h.appendChild(o),o=l;if(h.firstChild)if(o)o.parentNode.insertBefore(h,o),h=s.document.createElement("p");else{s.body.appendChild(h);break}o=o.nextSibling}s.fireEvent("aftersetcontent");s.fireEvent("contentchange");e||s._selectionChange();s._bakRange=s._bakIERange=s._bakNativeRange=null;r.gecko&&(a=this.selection.getNative())&&a.removeAllRanges();s.options.autoSyncData&&s.form&&i(s.form,s)},focus:function(t){var u,r,i;try{u=this;r=u.selection.getRange();t?(i=u.body.lastChild,i&&i.nodeType==1&&!f.$empty[i.tagName]&&(n.isEmptyBlock(i)?r.setStartAtFirst(i):r.setStartAtLast(i),r.collapse(!0)),r.setCursor(!0)):(!r.collapsed&&n.isBody(r.startContainer)&&r.startOffset==0&&(i=u.body.firstChild,i&&i.nodeType==1&&!f.$empty[i.tagName]&&r.setStartAtFirst(i).collapse(!0)),r.select(!0));this.fireEvent("focus selectionchange")}catch(e){}},isFocus:function(){return this.selection.isFocus()},blur:function(){var t=this.selection.getNative(),n;t.empty&&r.ie?(n=document.body.createTextRange(),n.moveToElementText(document.body),n.collapse(!0),n.select(),t.empty()):t.removeAllRanges()},_initEvents:function(){var i=this,u=i.document,f=i.window;i._proxyDomEvent=t.bind(i._proxyDomEvent,i);n.on(u,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],i._proxyDomEvent);n.on(f,["focus","blur"],i._proxyDomEvent);n.on(i.body,"drop",function(n){r.gecko&&n.stopPropagation&&n.stopPropagation();i.fireEvent("contentchange")});n.on(u,["mouseup","keydown"],function(n){n.type=="keydown"&&(n.ctrlKey||n.metaKey||n.shiftKey||n.altKey)||n.button!=2&&i._selectionChange(250,n)})},_proxyDomEvent:function(n){return this.fireEvent("before"+n.type.replace(/^on/,"").toLowerCase())===!1?!1:this.fireEvent(n.type.replace(/^on/,""),n)===!1?!1:this.fireEvent("after"+n.type.replace(/^on/,"").toLowerCase())},_selectionChange:function(n,t){var i=this,u=!1,f,e,o;r.ie&&r.version<9&&t&&t.type=="mouseup"&&(o=this.selection.getRange(),o.collapsed||(u=!0,f=t.clientX,e=t.clientY));clearTimeout(s);s=setTimeout(function(){var n,r;if(i.selection&&i.selection.getNative()){if(u&&i.selection.getNative().type=="None"){n=i.document.body.createTextRange();try{n.moveToPoint(f,e)}catch(o){n=null}}n&&(r=i.selection.getIERange,i.selection.getIERange=function(){return n});i.selection.cache();r&&(i.selection.getIERange=r);i.selection._cachedRange&&i.selection._cachedStartElement&&(i.fireEvent("beforeselectionchange"),i.fireEvent("selectionchange",!!t),i.fireEvent("afterselectionchange"),i.selection.clear())}},n||50)},_callCmdFn:function(n,t){var u=t[0].toLowerCase(),i,r;if(i=this.commands[u]||UE.commands[u],r=i&&i[n],i&&r||n!="queryCommandState"){if(r)return r.apply(this,t)}else return 0},execCommand:function(n){n=n.toLowerCase();var t=this,r,i=t.commands[n]||UE.commands[n];return!i||!i.execCommand?null:(i.notNeedUndo||t.__hasEnterExecCommand?(r=this._callCmdFn("execCommand",arguments),t.__hasEnterExecCommand||i.ignoreContentChange||t._ignoreContentChange||t.fireEvent("contentchange")):(t.__hasEnterExecCommand=!0,t.queryCommandState.apply(t,arguments)!=-1&&(t.fireEvent("saveScene"),t.fireEvent.apply(t,["beforeexeccommand",n].concat(arguments)),r=this._callCmdFn("execCommand",arguments),t.fireEvent.apply(t,["afterexeccommand",n].concat(arguments)),t.fireEvent("saveScene")),t.__hasEnterExecCommand=!1),t.__hasEnterExecCommand||i.ignoreContentChange||t._ignoreContentChange||t._selectionChange(),r)},queryCommandState:function(){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(t){var i,r,u,f,e;if(t)for(i=0;r=t[i++];)if(this.document.getElementsByTagName(r).length>0)return!0;if(!n.isEmptyBlock(this.body))return!0;for(t=["div"],i=0;r=t[i++];)for(u=n.getElementsByTagName(this.document,r),f=0;e=u[f++];)if(n.isCustomeNode(e))return!0;return!1},reset:function(){this.fireEvent("reset")},setEnabled:function(){var n=this,t;if(n.body.contentEditable=="false"){n.body.contentEditable=!0;t=n.selection.getRange();try{t.moveToBookmark(n.lastBk);delete n.lastBk}catch(i){t.setStartAtFirst(n.body).collapse(!0)}t.select(!0);n.bkqueryCommandState&&(n.queryCommandState=n.bkqueryCommandState,delete n.bkqueryCommandState);n.bkqueryCommandValue&&(n.queryCommandValue=n.bkqueryCommandValue,delete n.bkqueryCommandValue);n.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(n){var i=this;n=n?t.isArray(n)?n:[n]:[];i.body.contentEditable=="true"&&(i.lastBk||(i.lastBk=i.selection.getRange().createBookmark(!0)),i.body.contentEditable=!1,i.bkqueryCommandState=i.queryCommandState,i.bkqueryCommandValue=i.queryCommandValue,i.queryCommandState=function(r){return t.indexOf(n,r)!=-1?i.bkqueryCommandState.apply(i,arguments):-1},i.queryCommandValue=function(r){return t.indexOf(n,r)!=-1?i.bkqueryCommandValue.apply(i,arguments):null},i.fireEvent("selectionchange"))},disable:function(n){return this.setDisabled(n)},_setDefaultContent:function(){function n(){var t=this;t.document.getElementById("initContent")&&(t.body.innerHTML="<p>"+(o?"":"<br/>")+"<\/p>",t.removeListener("firstBeforeExecCommand focus",n),setTimeout(function(){t.focus();t._selectionChange()},0))}return function(t){var i=this;i.body.innerHTML='<p id="initContent">'+t+"<\/p>";i.addListener("firstBeforeExecCommand focus",n)}}(),setShow:function(){var n=this,t=n.selection.getRange();if(n.container.style.display=="none"){try{t.moveToBookmark(n.lastBk);delete n.lastBk}catch(i){t.setStartAtFirst(n.body).collapse(!0)}setTimeout(function(){t.select(!0)},100);n.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var n=this;n.lastBk||(n.lastBk=n.selection.getRange().createBookmark(!0));n.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(n){var t=UE.I18N[this.options.lang],i,r;if(!t)throw Error("not import language file");for(n=(n||"").split("."),i=0;r=n[i++];)if(t=t[r],!t)break;return t},getContentLength:function(n,t){var i=this.getContent(!1,!1,!0).length,r,u;if(n)for(t=(t||[]).concat(["hr","img","iframe"]),i=this.getContentTxt().replace(/[\t\r\n]+/g,"").length,r=0;u=t[r++];)i+=this.document.getElementsByTagName(u).length;return i},addInputRule:function(n){this.inputRules.push(n)},filterInputRule:function(n){for(var i=0,t;t=this.inputRules[i++];)t.call(this,n)},addOutputRule:function(n){this.outputRules.push(n)},filterOutputRule:function(n){for(var i=0,t;t=this.outputRules[i++];)t.call(this,n)},getActionUrl:function(n){var u=this.getOpt(n)||n,r=this.getOpt("imageUrl"),i=this.getOpt("serverUrl");return!i&&r&&(i=r.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2")),i?(i=i+(i.indexOf("?")==-1?"?":"&")+"action="+(u||""),t.formatUrl(i)):""}};t.inherits(u,c)}();UE.Editor.defaultOptions=function(n){var t=n.options.UEDITOR_HOME_URL;return{isShow:!0,initialContent:"",initialStyle:"",autoClearinitialContent:!1,iframeCssUrl:t+"themes/iframe.css",textarea:"editorValue",focus:!1,focusInEnd:!0,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,imagePopup:!0,enterTag:"p",customDomain:!1,lang:"zh-cn",langPath:t+"lang/",theme:"default",themePath:t+"themes/",allHtmlEnabled:!1,scaleEnabled:!1,tableNativeEditInFF:!1,autoSyncData:!0,fileNameFormat:"{time}{rand:6}"}},function(){UE.Editor.prototype.loadServerConfig=function(){function i(n){console&&console.error(n)}var n=this;setTimeout(function(){try{n.options.imageUrl&&n.setOpt("serverUrl",n.options.imageUrl.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2"));var r=n.getActionUrl("config"),u=t.isCrossDomainUrl(r);n._serverConfigLoaded=!1;r&&UE.ajax.request(r,{method:"GET",dataType:u?"jsonp":"",onsuccess:function(r){try{var f=u?r:eval("("+r.responseText+")");t.extend(n.options,f);n.fireEvent("serverConfigLoaded");n._serverConfigLoaded=!0}catch(e){i(n.getLang("loadconfigFormatError"))}},onerror:function(){i(n.getLang("loadconfigHttpError"))}})}catch(f){i(n.getLang("loadconfigError"))}})};UE.Editor.prototype.isServerConfigLoaded=function(){var n=this;return n._serverConfigLoaded||!1};UE.Editor.prototype.afterConfigReady=function(n){if(n&&t.isFunction(n)){var i=this,r=function(){n.apply(i,arguments);i.removeListener("serverConfigLoaded",r)};i.isServerConfigLoaded()?n.call(i,"serverConfigLoaded"):i.addListener("serverConfigLoaded",r)}}}();UE.ajax=function(){function n(n){var u=[],i,r;for(i in n)if(i!="method"&&i!="timeout"&&i!="async"&&i!="dataType"&&i!="callback"&&n[i]!=undefined&&n[i]!=null)if((typeof n[i]).toLowerCase()=="function"||(typeof n[i]).toLowerCase()=="object"){if(t.isArray(n[i]))for(r=0;r<n[i].length;r++)u.push(encodeURIComponent(i)+"[]="+encodeURIComponent(n[i][r]))}else u.push(encodeURIComponent(i)+"="+encodeURIComponent(n[i]));return u.join("&")}function f(i,u){var f=r(),h=!1,c={method:"POST",timeout:5e3,async:!0,data:{},onsuccess:function(){},onerror:function(){}},e,o;if(typeof i=="object"&&(u=i,i=u.url),f&&i){e=u?t.extend(c,u):c;o=n(e);t.isEmptyObject(e.data)||(o+=(o?"&":"")+n(e.data));var l=setTimeout(function(){f.readyState!=4&&(h=!0,f.abort(),clearTimeout(l))},e.timeout),s=e.method.toUpperCase(),a=i+(i.indexOf("?")==-1?"?":"&")+(s=="POST"?"":o+"&noCache="+ +new Date);f.open(s,a,e.async);f.onreadystatechange=function(){if(f.readyState==4)if(h||f.status!=200)e.onerror(f);else e.onsuccess(f)};s=="POST"?(f.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),f.send(o)):f.send(null)}}function u(i,r){function w(n,t,i){n.setAttribute("type","text/javascript");n.setAttribute("defer","defer");i&&n.setAttribute("charset",i);n.setAttribute("src",t);document.getElementsByTagName("head")[0].appendChild(n)}function l(n){return function(){try{if(n)u.onerror&&u.onerror();else try{clearTimeout(v);s.apply(window,arguments)}catch(i){}}catch(t){u.onerror&&u.onerror.call(window,t)}finally{u.oncomplete&&u.oncomplete.apply(window,arguments);e.parentNode&&e.parentNode.removeChild(e);window[f]=null;try{delete window[f]}catch(i){}}}}var s=r.onsuccess||function(){},e=document.createElement("SCRIPT"),u=r||{},p=u.charset,h=u.jsonp||"callback",f,a=u.timeOut||0,v,c=new RegExp("(\\?|&)"+h+"=([^&]*)"),y,o;t.isFunction(s)?(f="bd__editor__"+Math.floor(Math.random()*2147483648).toString(36),window[f]=l(0)):t.isString(s)?f=s:(y=c.exec(i))&&(f=y[2]);i=i.replace(c,"$1"+h+"="+f);i.search(c)<0&&(i+=(i.indexOf("?")<0?"?":"&")+h+"="+f);o=n(r);t.isEmptyObject(r.data)||(o+=(o?"&":"")+n(r.data));o&&(i=i.replace(/\?/,"?"+o+"&"));e.onerror=l(1);a&&(v=setTimeout(l(1),a));w(e,i,p)}var i="XMLHttpRequest()",r;try{new ActiveXObject("Msxml2.XMLHTTP");i="ActiveXObject('Msxml2.XMLHTTP')"}catch(e){try{new ActiveXObject("Microsoft.XMLHTTP");i="ActiveXObject('Microsoft.XMLHTTP')"}catch(e){}}return r=new Function("return new "+i),{request:function(n,t){t&&t.dataType=="jsonp"?u(n,t):f(n,t)},getJSONP:function(n,t,i){var r={data:t,oncomplete:i};u(n,r)}}}();b=UE.filterWord=function(){function i(n){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<(v|o):|lang=)/ig.test(n)}function n(n){return n.replace(/[\d.]+\w+/g,function(n){return t.transUnitToPx(n)})}function u(i){return i.replace(/[\t\r\n]+/g," ").replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(t){if(r.opera)return"";try{if(/Bitmap/i.test(t))return"";var i=t.match(/width:([ \d.]*p[tx])/i)[1],u=t.match(/height:([ \d.]*p[tx])/i)[1],f=t.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+n(i)+'" height="'+n(u)+'" src="'+f+'" />'}catch(e){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1<\/strong><\/p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/ig,function(n,t,i,r){return t=="class"&&r=="MsoListParagraph"?n:""}).replace(/<(font|span)[^>]*>(\s*)<\/\1>/gi,function(n,t,i){return i.replace(/[\t\r\n ]+/g," ")}).replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(i,r,u,f){for(var h,e,c,o=[],a=f.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").replace(/[\d.]+(cm|pt)/g,function(n){return t.transUnitToPx(n)}).split(/;\s*/g),s=0,l;l=a[s];s++)if(c=l.split(":"),c.length==2){if(h=c[0].toLowerCase(),e=c[1].toLowerCase(),/^(background)\w*/.test(h)&&e.replace(/(initial|\s)/g,"").length==0||/^(margin)\w*/.test(h)&&/^0\w+$/.test(e))continue;switch(h){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(r)||(o[s]=h.replace(/^mso-|-alt$/g,"")+":"+n(e));continue;case"horiz-align":o[s]="text-align:"+e;continue;case"vert-align":o[s]="vertical-align:"+e;continue;case"font-color":case"mso-foreground":o[s]="color:"+e;continue;case"mso-background":case"mso-highlight":o[s]="background:"+e;continue;case"mso-default-height":o[s]="min-height:"+n(e);continue;case"mso-default-width":o[s]="min-width:"+n(e);continue;case"mso-padding-between-alt":o[s]="border-collapse:separate;border-spacing:"+n(e);continue;case"text-line-through":(e=="single"||e=="double")&&(o[s]="text-decoration:line-through");continue;case"mso-zero-height":e=="yes"&&(o[s]="display:none");continue;case"margin":if(!/[1-9]/.test(e))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(h)||/text\-indent|padding|margin/.test(h)&&/\-[\d.]+/.test(e))continue;o[s]=h+":"+c[1]}return r+(o.length?' style="'+o.join(";").replace(/;{2,}/g,";")+'"':"")})}return function(n){return i(n)?u(n):n}}(),function(){function i(n,t,i){return n.push(a),t+(i?1:-1)}function r(n,t){for(var i=0;i<t;i++)n.push(l)}function u(n,t,e,o){switch(n.type){case"root":for(var h=0,s;s=n.children[h++];)e&&s.type=="element"&&!f.$inlineWithA[s.tagName]&&h>1&&(i(t,o,!0),r(t,o)),u(s,t,e,o);break;case"text":v(n,t);break;case"element":y(n,t,e,o);break;case"comment":p(n,t,e)}return t}function v(n,i){n.parentNode.tagName=="pre"?i.push(n.data):i.push(c[n.parentNode.tagName]?t.html(n.data):n.data.replace(/[ ]{2}/g," &nbsp;"))}function y(n,e,o,s){var c="",a,l,y,v;if(n.attrs){c=[];a=n.attrs;for(l in a)c.push(l+(a[l]!==undefined?'="'+(h[l]?t.html(a[l]).replace(/["]/g,function(){return"&quot;"}):t.unhtml(a[l]))+'"':""));c=c.join(" ")}if(e.push("<"+n.tagName+(c?" "+c:"")+(f.$empty[n.tagName]?"/":"")+">"),o&&!f.$inlineWithA[n.tagName]&&n.tagName!="pre"&&n.children&&n.children.length&&(s=i(e,s,!0),r(e,s)),n.children&&n.children.length)for(y=0;v=n.children[y++];)o&&v.type=="element"&&!f.$inlineWithA[v.tagName]&&y>1&&(i(e,s),r(e,s)),u(v,e,o,s);f.$empty[n.tagName]||(o&&!f.$inlineWithA[n.tagName]&&n.tagName!="pre"&&n.children&&n.children.length&&(s=i(e,s),r(e,s)),e.push("<\/"+n.tagName+">"))}function p(n,t){t.push("<!--"+n.data+"-->")}function e(n,t){var i,r,u;if(n.type=="element"&&n.getAttr("id")==t)return n;if(n.children&&n.children.length)for(r=0;u=n.children[r++];)if(i=e(u,t))return i}function o(n,t,i){if(n.type=="element"&&n.tagName==t&&i.push(n),n.children&&n.children.length)for(var u=0,r;r=n.children[u++];)o(r,t,i)}function s(n,t){if(n.children&&n.children.length)for(var r=0,i;i=n.children[r];)s(i,t),i.parentNode&&(i.children&&i.children.length&&t(i),i.parentNode&&r++);else t(n)}var n=UE.uNode=function(n){this.type=n.type;this.data=n.data;this.tagName=n.tagName;this.parentNode=n.parentNode;this.attrs=n.attrs||{};this.children=n.children},h={href:1,src:1,_src:1,_href:1,cdata_data:1},c={style:1,script:1},l="    ",a="\n";n.createElement=function(t){return/[<>]/.test(t)?UE.htmlparser(t).children[0]:new n({type:"element",children:[],tagName:t})};n.createText=function(n,i){return new UE.uNode({type:"text",data:i?n:t.unhtml(n||"")})};n.prototype={toHtml:function(n){var t=[];return u(this,t,n,0),t.join("")},innerHTML:function(n){var r,i,u;if(this.type!="element"||f.$empty[this.tagName])return this;if(t.isString(n)){if(this.children)for(r=0;i=this.children[r++];)i.parentNode=null;for(this.children=[],u=UE.htmlparser(n),r=0;i=u.children[r++];)this.children.push(i),i.parentNode=this;return this}return u=new UE.uNode({type:"root",children:this.children}),u.toHtml()},innerText:function(t,i){if(this.type!="element"||f.$empty[this.tagName])return this;if(t){if(this.children)for(var u=0,r;r=this.children[u++];)r.parentNode=null;return this.children=[],this.appendChild(n.createText(t,i)),this}return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){return this.type=="element"?"":this.data},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){for(var t=this.parentNode,n=0,i;i=t.children[n];n++)if(i===this)return n==0?null:t.children[n-1]},nextSibling:function(){for(var n=this.parentNode,t=0,i;i=n.children[t++];)if(i===this)return n.children[t]},replaceChild:function(n,t){if(this.children){n.parentNode&&n.parentNode.removeChild(n);for(var i=0,r;r=this.children[i];i++)if(r===t)return this.children.splice(i,1,n),t.parentNode=null,n.parentNode=this,n}},appendChild:function(n){if(this.type=="root"||this.type=="element"&&!f.$empty[this.tagName]){this.children||(this.children=[]);n.parentNode&&n.parentNode.removeChild(n);for(var t=0,i;i=this.children[t];t++)if(i===n){this.children.splice(t,1);break}return this.children.push(n),n.parentNode=this,n}},insertBefore:function(n,t){if(this.children){n.parentNode&&n.parentNode.removeChild(n);for(var i=0,r;r=this.children[i];i++)if(r===t)return this.children.splice(i,0,n),n.parentNode=this,n}},insertAfter:function(n,t){if(this.children){n.parentNode&&n.parentNode.removeChild(n);for(var i=0,r;r=this.children[i];i++)if(r===t)return this.children.splice(i+1,0,n),n.parentNode=this,n}},removeChild:function(n,t){var r,i,u,f;if(this.children)for(r=0;i=this.children[r];r++)if(i===n){if(this.children.splice(r,1),i.parentNode=null,t&&i.children&&i.children.length)for(u=0;f=i.children[u];u++)this.children.splice(r+u,0,f),f.parentNode=this;return i}},getAttr:function(n){return this.attrs&&this.attrs[n.toLowerCase()]},setAttr:function(n,i){if(!n){delete this.attrs;return}if(this.attrs||(this.attrs={}),t.isObject(n))for(var r in n)n[r]?this.attrs[r.toLowerCase()]=n[r]:delete this.attrs[r];else i?this.attrs[n.toLowerCase()]=i:delete this.attrs[n]},getIndex:function(){for(var i=this.parentNode,n=0,t;t=i.children[n];n++)if(t===this)return n;return-1},getNodeById:function(n){var t,i,r;if(this.children&&this.children.length)for(i=0;r=this.children[i++];)if(t=e(r,n))return t},getNodesByTagName:function(n){n=t.trim(n).replace(/[ ]{2,}/g," ").split(" ");var r=[],i=this;return t.each(n,function(n){if(i.children&&i.children.length)for(var u=0,t;t=i.children[u++];)o(t,n,r)}),r},getStyle:function(n){var i=this.getAttr("style"),r,t;return i?(r=new RegExp("(^|;)\\s*"+n+":([^;]+)","i"),t=i.match(r),t&&t[0])?t[2]:"":""},setStyle:function(n,i){function f(n,i){var u=new RegExp("(^|;)\\s*"+n+":([^;]+;?)","gi");r=r.replace(u,"$1");i&&(r=n+":"+t.unhtml(i)+";"+r)}var r=this.getAttr("style"),u;if(r||(r=""),t.isObject(n))for(u in n)f(u,n[u]);else f(n,i);this.setAttr("style",t.trim(r))},traversal:function(n){return this.children&&this.children.length&&s(this,n),this}}}();k=UE.htmlparser=function(i,r){function h(n,t){if(a[n.tagName]){var i=o.createElement(a[n.tagName]);n.appendChild(i);i.appendChild(o.createText(t));n=i}else n.appendChild(o.createText(t))}function v(n,i,r){var e,s,l,h,c,u;if(e=d[i]){for(s=n;s.type!="root";){if(t.isArray(e)?t.indexOf(e,s.tagName)!=-1:e==s.tagName){n=s;l=!0;break}s=s.parentNode}l||(n=v(n,t.isArray(e)?e[0]:e))}if(h=new o({parentNode:n,type:"element",tagName:i.toLowerCase(),children:f.$empty[i]?null:[]}),r){for(c={};u=w.exec(r);)c[u[1].toLowerCase()]=k[u[1].toLowerCase()]?u[2]||u[3]||u[4]:t.unhtml(u[2]||u[3]||u[4]);h.attrs=c}return n.children.push(h),f.$empty[i]?n:h}function g(n,t){n.children.push(new o({type:"comment",data:t,parentNode:n}))}var l=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/<>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,w=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,b={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1},p;i=i.replace(new RegExp(n.fillChar,"g"),"");r||(i=i.replace(new RegExp("[\\r\\t\\n"+(r?"":" ")+"]*<\/?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(r?"":" ")+"]*","g"),function(n,t){return t&&b[t.toLowerCase()]?n.replace(/(^[\n\r]+)|([\n\r]+$)/g,""):n.replace(new RegExp("^[\\r\\n"+(r?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(r?"":" ")+"]+$"),"")}));for(var k={href:1,src:1},o=UE.uNode,d={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},a={ol:"li",ul:"li"},e,c=0,s=0,y=new o({type:"root",children:[]}),u=y;e=l.exec(i);){c=e.index;try{if(c>s&&h(u,i.slice(s,c)),e[3])f.$cdata[u.tagName]?h(u,e[0]):u=v(u,e[3].toLowerCase(),e[4]);else if(e[1]){if(u.type!="root")if(f.$cdata[u.tagName]&&!f.$cdata[e[1]])h(u,e[0]);else{for(p=u;u.type=="element"&&u.tagName!=e[1].toLowerCase();)if(u=u.parentNode,u.type=="root"){u=p;throw"break";}u=u.parentNode}}else e[2]&&g(u,e[2])}catch(nt){}s=l.lastIndex}return s<i.length&&h(u,i.slice(s)),y};d=UE.filterNode=function(){function n(i,r){var s,h,v,a,o,y,c,l,u,e;switch(i.type){case"element":if(s=r[i.tagName])if(s==="-")i.parentNode.removeChild(i);else if(t.isFunction(s))if(c=i.parentNode,l=i.getIndex(),s(i),i.parentNode){if(i.children)for(u=0;e=i.children[u];)n(e,r),e.parentNode&&u++}else for(u=l;e=c.children[u];)n(e,r),e.parentNode&&u++;else{if(h=s.$,h&&i.attrs){v={};for(o in h)a=i.getAttr(o),o=="style"&&t.isArray(h[o])&&(y=[],t.each(h[o],function(n){var t;(t=i.getStyle(n))&&y.push(n+":"+t)}),a=y.join(";")),a&&(v[o]=a);i.attrs=v}if(i.children)for(u=0;e=i.children[u];)n(e,r),e.parentNode&&u++}else if(f.$cdata[i.tagName])i.parentNode.removeChild(i);else for(c=i.parentNode,l=i.getIndex(),i.parentNode.removeChild(i,!0),u=l;e=c.children[u];)n(e,r),e.parentNode&&u++;break;case"comment":i.parentNode.removeChild(i)}}return function(i,r){var e,u,f;if(t.isEmptyObject(r))return i;for((e=r["-"])&&t.each(e.split(" "),function(n){r[n]="-"}),u=0;f=i.children[u];)n(f,r),f.parentNode&&u++;return i}}();UE.plugin=function(){var n={};return{register:function(i,r,u,f){u&&t.isFunction(u)&&(f=u,u=null);n[i]={optionName:u||i,execFn:r,afterDisabled:f}},load:function(i){t.each(n,function(n){var r=n.execFn.call(i);i.options[n.optionName]!==!1?r&&t.each(r,function(n,r){switch(r.toLowerCase()){case"shortcutkey":i.addshortcutkey(n);break;case"bindevents":t.each(n,function(n,t){i.addListener(t,n)});break;case"bindmultievents":t.each(t.isArray(n)?n:[n],function(n){var r=t.trim(n.type).split(/\s+/);t.each(r,function(t){i.addListener(t,n.handler)})});break;case"commands":t.each(n,function(n,t){i.commands[t]=n});break;case"outputrule":i.addOutputRule(n);break;case"inputrule":i.addInputRule(n);break;case"defaultoptions":i.setOpt(n)}}):n.afterDisabled&&n.afterDisabled.call(i)});t.each(UE.plugins,function(n){n.call(i)})},run:function(t,i){var r=n[t];r&&r.exeFn.call(i)}}}();a=UE.keymap={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Del:46,NumLock:144,Cmd:91,"=":187,"-":189,b:66,i:73,z:90,y:89,v:86,x:88,s:83,n:78};s=UE.LocalStorage=function(){function i(){var n=document.createElement("div");return(n.style.display="none",!n.addBehavior)?null:(n.addBehavior("#default#userdata"),{getItem:function(i){var r=null;try{document.body.appendChild(n);n.load(t);r=n.getAttribute(i);document.body.removeChild(n)}catch(u){}return r},setItem:function(i,r){document.body.appendChild(n);n.setAttribute(i,r);n.save(t);document.body.removeChild(n)},removeItem:function(i){document.body.appendChild(n);n.removeAttribute(i);n.save(t);document.body.removeChild(n)}})}var n=window.localStorage||i()||null,t="localStorage";return{saveLocalData:function(t,i){return n&&i?(n.setItem(t,i),!0):!1},getLocalData:function(t){return n?n.getItem(t):null},removeItem:function(t){n&&n.removeItem(t)}}}(),function(){var n="ueditor_preference";UE.Editor.prototype.setPreferences=function(i,r){var f={},u;t.isString(i)?f[i]=r:f=i;u=s.getLocalData(n);u&&(u=t.str2json(u))?t.extend(u,f):u=f;u&&s.saveLocalData(n,t.json2str(u))};UE.Editor.prototype.getPreferences=function(i){var r=s.getLocalData(n);return r&&(r=t.str2json(r))?i?r[i]:r:null};UE.Editor.prototype.removePreferences=function(i){var r=s.getLocalData(n);r&&(r=t.str2json(r))&&(r[i]=undefined,delete r[i]);r&&s.saveLocalData(n,t.json2str(r))}}();UE.plugins.defaultfilter=function(){var n=this;n.setOpt({allowDivTransToP:!0,disabledTableInTable:!0});n.addInputRule(function(i){function o(n){while(n&&n.type=="element"){if(n.tagName=="td")return!0;n=n.parentNode}return!1}var e=this.options.allowDivTransToP,u;i.traversal(function(i){var h,s,c,l;if(i.type=="element"){if(!f.$cdata[i.tagName]&&n.options.autoClearEmptyNode&&f.$inline[i.tagName]&&!f.$empty[i.tagName]&&(!i.attrs||t.isEmptyObject(i.attrs))){i.firstChild()?i.tagName=="span"&&(!i.attrs||t.isEmptyObject(i.attrs))&&i.parentNode.removeChild(i,!0):i.parentNode.removeChild(i);return}switch(i.tagName){case"style":case"script":i.setAttr({cdata_tag:i.tagName,cdata_data:i.innerHTML()||"",_ue_custom_node_:"true"});i.tagName="div";i.innerHTML("");break;case"a":(u=i.getAttr("href"))&&i.setAttr("_href",u);break;case"img":if((u=i.getAttr("src"))&&/^data:/.test(u)){i.parentNode.removeChild(i);break}i.setAttr("_src",i.getAttr("src"));break;case"span":r.webkit&&(u=i.getStyle("white-space"))&&/nowrap|normal/.test(u)&&(i.setStyle("white-space",""),n.options.autoClearEmptyNode&&t.isEmptyObject(i.attrs)&&i.parentNode.removeChild(i,!0));u=i.getAttr("id");u&&/^_baidu_bookmark_/i.test(u)&&i.parentNode.removeChild(i);break;case"p":(u=i.getAttr("align"))&&(i.setAttr("align"),i.setStyle("text-align",u));t.each(i.children,function(n){var t,r,u;if(n.type=="element"&&n.tagName=="p"){for(t=n.nextSibling(),i.parentNode.insertAfter(n,i),r=n;t;)u=t.nextSibling(),i.parentNode.insertAfter(t,r),r=t,t=u;return!1}});i.firstChild()||i.innerHTML(r.ie?"&nbsp;":"<br/>");break;case"div":if(i.getAttr("cdata_tag"))break;if(u=i.getAttr("class"),u&&/^line number\d+/.test(u))break;if(!e)break;for(s=UE.uNode.createElement("p");h=i.firstChild();)h.type!="text"&&UE.dom.dtd.$block[h.tagName]?s.firstChild()?(i.parentNode.insertBefore(s,i),s=UE.uNode.createElement("p")):i.parentNode.insertBefore(h,i):s.appendChild(h);s.firstChild()&&i.parentNode.insertBefore(s,i);i.parentNode.removeChild(i);break;case"dl":i.tagName="ul";break;case"dt":case"dd":i.tagName="li";break;case"li":c=i.getAttr("class");c&&/list\-/.test(c)||i.setAttr();l=i.getNodesByTagName("ol ul");UE.utils.each(l,function(n){i.parentNode.insertAfter(n,i)});break;case"td":case"th":case"caption":i.children&&i.children.length||i.appendChild(r.ie11below?UE.uNode.createText(" "):UE.uNode.createElement("br"));break;case"table":n.options.disabledTableInTable&&o(i)&&(i.parentNode.insertBefore(UE.uNode.createText(i.innerText()),i),i.parentNode.removeChild(i))}}})});n.addOutputRule(function(i){var r;i.traversal(function(i){if(i.type=="element"){if(n.options.autoClearEmptyNode&&f.$inline[i.tagName]&&!f.$empty[i.tagName]&&(!i.attrs||t.isEmptyObject(i.attrs))){i.firstChild()?i.tagName=="span"&&(!i.attrs||t.isEmptyObject(i.attrs))&&i.parentNode.removeChild(i,!0):i.parentNode.removeChild(i);return}switch(i.tagName){case"div":(r=i.getAttr("cdata_tag"))&&(i.tagName=r,i.appendChild(UE.uNode.createText(i.getAttr("cdata_data"))),i.setAttr({cdata_tag:"",cdata_data:"",_ue_custom_node_:""}));break;case"a":(r=i.getAttr("_href"))&&i.setAttr({href:t.html(r),_href:""});break;case"span":r=i.getAttr("id");r&&/^_baidu_bookmark_/i.test(r)&&i.parentNode.removeChild(i);break;case"img":(r=i.getAttr("_src"))&&i.setAttr({src:i.getAttr("_src"),_src:""})}}})})};UE.commands.inserthtml={execCommand:function(i,u,e){var l=this,s,b,g,c,o,w,k,nt,y,p,d,tt,it,v,a;if(u&&l.fireEvent("beforeinserthtml",u)!==!0){if(s=l.selection.getRange(),b=s.document.createElement("div"),b.style.display="inline",e||(g=UE.htmlparser(u),l.options.filterRules&&UE.filterNode(g,l.options.filterRules),l.filterInputRule(g),u=g.toHtml()),b.innerHTML=t.trim(u),!s.collapsed&&(c=s.startContainer,n.isFillChar(c)&&s.setStartBefore(c),c=s.endContainer,n.isFillChar(c)&&s.setEndAfter(c),s.txtToElmBoundary(),s.endContainer&&s.endContainer.nodeType==1&&(c=s.endContainer.childNodes[s.endOffset],c&&n.isBr(c)&&s.setEndAfter(c)),s.startOffset==0&&(c=s.startContainer,n.isBoundaryNode(c,"firstChild")&&(c=s.endContainer,s.endOffset==(c.nodeType==3?c.nodeValue.length:c.childNodes.length)&&n.isBoundaryNode(c,"lastChild")&&(l.body.innerHTML="<p>"+(r.ie?"":"<br/>")+"<\/p>",s.setStart(l.body.firstChild,0).collapse(!0)))),s.collapsed||s.deleteContents(),s.startContainer.nodeType==1&&(o=s.startContainer.childNodes[s.startOffset],o&&n.isBlockElm(o)&&(v=o.previousSibling)&&n.isBlockElm(v)))){for(s.setEnd(v,v.childNodes.length).collapse();o.firstChild;)v.appendChild(o.firstChild);n.remove(o)}if(nt=0,s.inFillChar()&&(o=s.startContainer,n.isFillChar(o)?(s.setStartBefore(o).collapse(!0),n.remove(o)):n.isFillChar(o,!0)&&(o.nodeValue=o.nodeValue.replace(h,""),s.startOffset--,s.collapsed&&s.collapse(!0))),p=n.findParentByTagName(s.startContainer,"li",!0),p){while(o=b.firstChild){while(o&&(o.nodeType==3||!n.isBlockElm(o)||o.tagName=="HR"))a=o.nextSibling,s.insertNode(o).collapse(),d=o,o=a;if(o)if(/^(ol|ul)$/i.test(o.tagName)){while(o.firstChild)d=o.firstChild,n.insertAfter(p,o.firstChild),p=p.nextSibling;n.remove(o)}else a=o.nextSibling,tt=l.document.createElement("li"),n.insertAfter(p,tt),tt.appendChild(o),d=o,o=a,p=tt}p=n.findParentByTagName(s.startContainer,"li",!0);n.isEmptyBlock(p)&&n.remove(p);d&&s.setStartAfter(d).collapse(!0).select(!0)}else{while(o=b.firstChild){if(nt){for(it=l.document.createElement("p");o&&(o.nodeType==3||!f.$block[o.tagName]);)y=o.nextSibling,it.appendChild(o),o=y;it.firstChild&&(o=it)}if(s.insertNode(o),y=o.nextSibling,!nt&&o.nodeType==n.NODE_ELEMENT&&n.isBlockElm(o)&&(w=n.findParent(o,function(t){return n.isBlockElm(t)}),w&&w.tagName.toLowerCase()!="body"&&!(f[w.tagName][o.nodeName]&&o.parentNode===w))){if(f[w.tagName][o.nodeName])for(k=o.parentNode;k!==w;)v=k,k=k.parentNode;else v=w;n.breakParent(o,v||k);v=o.previousSibling;n.trimWhiteTextNode(v);v.childNodes.length||n.remove(v);!r.ie&&(a=o.nextSibling)&&n.isBlockElm(a)&&a.lastChild&&!n.isBr(a.lastChild)&&a.appendChild(l.document.createElement("br"));nt=1}if(a=o.nextSibling,!b.firstChild&&a&&n.isBlockElm(a)){s.setStart(a,0).collapse(!0);break}s.setEndAfter(o).collapse()}if(o=s.startContainer,y&&n.isBr(y)&&n.remove(y),n.isBlockElm(o)&&n.isEmptyNode(o))if(y=o.nextSibling)n.remove(o),y.nodeType==1&&f.$block[y.tagName]&&s.setStart(y,0).collapse(!0).shrinkBoundary();else try{o.innerHTML=r.ie?n.fillChar:"<br/>"}catch(rt){s.setStartBefore(o);n.remove(o)}try{s.select(!0)}catch(rt){}}setTimeout(function(){s=l.selection.getRange();s.scrollToView(l.autoHeightEnabled,l.autoHeightEnabled?n.getXY(l.iframe).y:0);l.fireEvent("afterinserthtml",u)},200)}}};UE.plugins.autotypeset=function(){function o(t,i){return!t||t.nodeType==3?0:n.isBr(t)?1:t&&t.parentNode&&l[t.tagName.toLowerCase()]?u&&u.contains(t)||t.getAttribute("pagebreak")?0:i?!n.isEmptyBlock(t):n.isEmptyBlock(t,new RegExp("[\\s"+n.fillChar+"]","g")):void 0}function s(t){t.style.cssText||(n.removeAttributes(t,["style"]),t.tagName.toLowerCase()=="span"&&n.hasNoAttributes(t)&&n.remove(t,!0))}function e(t,r){var b=this,w,tt,it,e,rt,d,p,l,k,y,nt,ut,g;if(r){if(!i.pasteFilter)return;w=b.document.createElement("div");w.innerHTML=r.html}else w=b.document.body;for(tt=n.getElementsByTagName(w,"*"),it=0;e=tt[it++];)if(b.fireEvent("excludeNodeinautotype",e)!==!0){if(i.clearFontSize&&e.style.fontSize&&(n.removeStyle(e,"font-size"),s(e)),i.clearFontFamily&&e.style.fontFamily&&(n.removeStyle(e,"font-family"),s(e)),o(e)){if(i.mergeEmptyline)for(y=e.nextSibling,rt=n.isBr(e);o(y);){if(l=y,y=l.nextSibling,rt&&(!y||y&&!n.isBr(y)))break;n.remove(l)}if(i.removeEmptyline&&n.inDoc(e,w)&&!c[e.parentNode.tagName.toLowerCase()]){if(n.isBr(e)&&(y=e.nextSibling,y&&!n.isBr(y)))continue;n.remove(e);continue}}if(o(e,!0)&&e.tagName!="SPAN"&&(i.indent&&(e.style.textIndent=i.indentValue),i.textAlign&&(e.style.textAlign=i.textAlign)),i.removeClass&&e.className&&!h[e.className.toLowerCase()]){if(u&&u.contains(e))continue;n.removeAttributes(e,["class"])}if(i.imageBlockLine&&e.tagName.toLowerCase()=="img"&&!e.getAttribute("emotion"))if(r){d=e;switch(i.imageBlockLine){case"left":case"right":case"none":for(p=d.parentNode;f.$inline[p.tagName]||p.tagName=="A";)p=p.parentNode;if(l=p,l.tagName=="P"&&n.getStyle(l,"text-align")=="center"&&!n.isBody(l)&&n.getChildCount(l,function(t){return!n.isBr(t)&&!n.isWhitespace(t)})==1)if(k=l.previousSibling,y=l.nextSibling,k&&y&&k.nodeType==1&&y.nodeType==1&&k.tagName==y.tagName&&n.isBlockElm(k)){for(k.appendChild(l.firstChild);y.firstChild;)k.appendChild(y.firstChild);n.remove(l);n.remove(y)}else n.setStyle(l,"text-align","");n.setStyle(d,"float",i.imageBlockLine);break;case"center":if(b.queryCommandValue("imagefloat")!="center"){for(p=d.parentNode,n.setStyle(d,"float","none"),l=d;p&&n.getChildCount(p,function(t){return!n.isBr(t)&&!n.isWhitespace(t)})==1&&(f.$inline[p.tagName]||p.tagName=="A");)l=p,p=p.parentNode;nt=b.document.createElement("p");n.setAttributes(nt,{style:"text-align:center"});l.parentNode.insertBefore(nt,l);nt.appendChild(l);n.setStyle(l,"float","")}}}else ut=b.selection.getRange(),ut.selectNode(e).select(),b.execCommand("imagefloat",i.imageBlockLine);i.removeEmptyNode&&i.removeTagNames[e.tagName.toLowerCase()]&&n.hasNoAttributes(e)&&n.isEmptyBlock(e)&&n.remove(e)}i.tobdc&&(g=UE.htmlparser(w.innerHTML),g.traversal(function(n){n.type=="text"&&(n.data=v(n.data))}),w.innerHTML=g.toHtml());i.bdc2sb&&(g=UE.htmlparser(w.innerHTML),g.traversal(function(n){n.type=="text"&&(n.data=a(n.data))}),w.innerHTML=g.toHtml());r&&(r.html=w.innerHTML)}function a(n){for(var i,r="",t=0;t<n.length;t++)i=n.charCodeAt(t),r+=i>=65281&&i<=65373?String.fromCharCode(n.charCodeAt(t)-65248):i==12288?String.fromCharCode(n.charCodeAt(t)-12256):n.charAt(t);return r}function v(n){var i,u,r;for(n=t.html(n),i="",u="",r=0;r<n.length;r++)n.charCodeAt(r)==32?i=i+String.fromCharCode(12288):n.charCodeAt(r)<127?i=i+String.fromCharCode(n.charCodeAt(r)+65248):i+=n.charAt(r);return i}function y(){var n=r.getPreferences("autotypeset");t.extend(r.options.autotypeset,n)}this.setOpt({autotypeset:{mergeEmptyline:!0,removeClass:!0,removeEmptyline:!1,textAlign:"left",imageBlockLine:"center",pasteFilter:!1,clearFontSize:!1,clearFontFamily:!1,removeEmptyNode:!1,removeTagNames:t.extend({div:1},f.$removeEmpty),indent:!1,indentValue:"2em",bdc2sb:!1,tobdc:!1}});var r=this,i=r.options.autotypeset,h={selectTdClass:1,pagebreak:1,anchorclass:1},c={li:1},l={div:1,p:1,blockquote:1,center:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,span:1},u;i&&(y(),i.pasteFilter&&r.addListener("beforepaste",e),r.commands.autotypeset={execCommand:function(){r.removeListener("beforepaste",e);i.pasteFilter&&r.addListener("beforepaste",e);e.call(r)}})};UE.plugin.register("autosubmit",function(){return{shortcutkey:{autosubmit:"ctrl+13"},commands:{autosubmit:{execCommand:function(){var t=this,i=n.findParentByTagName(t.iframe,"form",!1);if(i){if(t.fireEvent("beforesubmit")===!1)return;t.sync();i.submit()}}}}}});UE.plugin.register("background",function(){function s(n){var i={},r=n.split(";");return t.each(r,function(n){var r=n.indexOf(":"),u=t.trim(n.substr(0,r)).toLowerCase();u&&(i[u]=t.trim(n.substr(r+1)||""))}),i}function e(n){var r,f;if(n){r=[];for(f in n)n.hasOwnProperty(f)&&r.push(f+":"+n[f]+"; ");t.cssRule(u,r.length?"body{"+r.join("")+"}":"",i.document)}else t.cssRule(u,"",i.document)}var i=this,u="editor_background",f,o=new RegExp("body[\\s]*\\{(.+)\\}","i"),h=i.hasContents;return i.hasContents=function(){return i.queryCommandValue("background")?!0:h.apply(i,arguments)},{bindEvents:{getAllHtml:function(t,u){var f=this.body,e=n.getComputedStyle(f,"background-image"),c="",o,s,h;c=e.indexOf(i.options.imagePath)>0?e.substring(e.indexOf(i.options.imagePath),e.length-1).replace(/"|\(|\)/ig,""):e!="none"?e.replace(/url\("?|"?\)/ig,""):"";o='<style type="text/css">body{';s={"background-color":n.getComputedStyle(f,"background-color")||"#ffffff","background-image":c?"url("+c+")":"","background-repeat":n.getComputedStyle(f,"background-repeat")||"","background-position":r.ie?n.getComputedStyle(f,"background-position-x")+" "+n.getComputedStyle(f,"background-position-y"):n.getComputedStyle(f,"background-position"),height:n.getComputedStyle(f,"height")};for(h in s)s.hasOwnProperty(h)&&(o+=h+":"+s[h]+"; ");o+="}<\/style> ";u.push(o)},aftersetcontent:function(){f==!1&&e()}},inputRule:function(n){f=!1;t.each(n.getNodesByTagName("p"),function(n){var t=n.getAttr("data-background");t&&(f=!0,e(s(t)),n.parentNode.removeChild(n))})},outputRule:function(n){var r=this,i=(t.cssRule(u,r.document)||"").replace(/[\n\r]+/g,"").match(o);i&&n.appendChild(UE.uNode.createElement('<p style="display:none;" data-background="'+t.trim(i[1].replace(/"/g,"").replace(/[\s]+/g," "))+'"><br/><\/p>'))},commands:{background:{execCommand:function(n,t){e(t)},queryCommandValue:function(){var i=this,n=(t.cssRule(u,i.document)||"").replace(/[\n\r]+/g,"").match(o);return n?s(n[1]):null},notNeedUndo:!0}}}});UE.commands.imagefloat={execCommand:function(t,i){var h=this,c=h.selection.getRange(),e,u,r,s,o;if(!c.collapsed&&(e=c.getClosedNode(),e&&e.tagName=="IMG"))switch(i){case"left":case"right":case"none":for(u=e.parentNode;f.$inline[u.tagName]||u.tagName=="A";)u=u.parentNode;if(r=u,r.tagName=="P"&&n.getStyle(r,"text-align")=="center"){if(!n.isBody(r)&&n.getChildCount(r,function(t){return!n.isBr(t)&&!n.isWhitespace(t)})==1)if(s=r.previousSibling,o=r.nextSibling,s&&o&&s.nodeType==1&&o.nodeType==1&&s.tagName==o.tagName&&n.isBlockElm(s)){for(s.appendChild(r.firstChild);o.firstChild;)s.appendChild(o.firstChild);n.remove(r);n.remove(o)}else n.setStyle(r,"text-align","");c.selectNode(e).select()}n.setStyle(e,"float",i=="none"?"":i);i=="none"&&n.removeAttributes(e,"align");break;case"center":if(h.queryCommandValue("imagefloat")!="center"){for(u=e.parentNode,n.setStyle(e,"float",""),n.removeAttributes(e,"align"),r=e;u&&n.getChildCount(u,function(t){return!n.isBr(t)&&!n.isWhitespace(t)})==1&&(f.$inline[u.tagName]||u.tagName=="A");)r=u,u=u.parentNode;c.setStartBefore(r).setCursor(!1);u=h.document.createElement("div");u.appendChild(r);n.setStyle(r,"float","");h.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+u.innerHTML+"<\/p>");r=h.document.getElementById("_img_parent_tmp");r.removeAttribute("id");r=r.firstChild;c.selectNode(r).select();o=r.parentNode.nextSibling;o&&n.isEmptyNode(o)&&n.remove(o)}}},queryCommandValue:function(){var r=this.selection.getRange(),t,i;return r.collapsed?"none":(t=r.getClosedNode(),t&&t.nodeType==1&&t.tagName=="IMG")?(i=n.getComputedStyle(t,"float")||t.getAttribute("align"),i=="none"&&(i=n.getComputedStyle(t.parentNode,"text-align")=="center"?"center":i),{left:1,right:1,center:1}[i]?i:"none"):"none"},queryCommandState:function(){var t=this.selection.getRange(),n;return t.collapsed?-1:(n=t.getClosedNode(),n&&n.nodeType==1&&n.tagName=="IMG")?0:-1}};UE.commands.insertimage={execCommand:function(i,r){function l(n){t.each("width,height,border,hspace,vspace".split(","),function(t){n[t]&&(n[t]=parseInt(n[t],10)||0)});t.each("src,_src".split(","),function(i){n[i]&&(n[i]=t.unhtmlForUrl(n[i]))});t.each("title,alt".split(","),function(i){n[i]&&(n[i]=t.unhtml(n[i]))})}var s,a,h,e,u,v;if(r=t.isArray(r)?r:[r],r.length){var o=this,c=o.selection.getRange(),f=c.getClosedNode();if(o.fireEvent("beforeinsertimage",r)!==!0){if(f&&/img/i.test(f.tagName)&&(f.className!="edui-faked-video"||f.className.indexOf("edui-upload-video")!=-1)&&!f.getAttribute("word_img"))s=r.shift(),a=s.floatStyle,delete s.floatStyle,n.setAttributes(f,s),o.execCommand("imagefloat",a),r.length>0&&(c.setStartAfter(f).setCursor(!1,!0),o.execCommand("insertimage",r));else{if(h=[],e="",u=r[0],r.length==1)l(u),e='<img src="'+u.src+'" '+(u._src?' _src="'+u._src+'" ':"")+(u.width?'width="'+u.width+'" ':"")+(u.height?' height="'+u.height+'" ':"")+(u.floatStyle=="left"||u.floatStyle=="right"?' style="float:'+u.floatStyle+';"':"")+(u.title&&u.title!=""?' title="'+u.title+'"':"")+(u.border&&u.border!="0"?' border="'+u.border+'"':"")+(u.alt&&u.alt!=""?' alt="'+u.alt+'"':"")+(u.hspace&&u.hspace!="0"?' hspace = "'+u.hspace+'"':"")+(u.vspace&&u.vspace!="0"?' vspace = "'+u.vspace+'"':"")+"/>",u.floatStyle=="center"&&(e='<p style="text-align: center">'+e+"<\/p>"),h.push(e);else for(v=0;u=r[v++];)l(u),e="<p "+(u.floatStyle=="center"?'style="text-align: center" ':"")+'><img src="'+u.src+'" '+(u.width?'width="'+u.width+'" ':"")+(u._src?' _src="'+u._src+'" ':"")+(u.height?' height="'+u.height+'" ':"")+' style="'+(u.floatStyle&&u.floatStyle!="center"?"float:"+u.floatStyle+";":"")+(u.border||"")+'" '+(u.title?' title="'+u.title+'"':"")+" /><\/p>",h.push(e);o.execCommand("insertHtml",h.join(""))}o.fireEvent("afterinsertimage",r)}}}};UE.plugins.justify=function(){var f=this,i=n.isBlockElm,r={left:1,right:1,center:1,justify:1},u=function(r,u){var v=r.createBookmark(),c=function(t){return t.nodeType==1?t.tagName.toLowerCase()!="br"&&!n.isBookmarkNode(t):!n.isWhitespace(t)},o,s,a;r.enlarge(!0);for(var h=r.createBookmark(),f=n.getNextDomNode(h.start,!1,c),e=r.cloneRange(),l;f&&!(n.getPosition(f,h.end)&n.POSITION_FOLLOWING);)if(f.nodeType!=3&&i(f))f=n.getNextDomNode(f,!0,c);else{for(e.setStartBefore(f);f&&f!==h.end&&!i(f);)l=f,f=n.getNextDomNode(f,!1,null,function(n){return!i(n)});e.setEndAfter(l);o=e.getCommonAncestor();!n.isBody(o)&&i(o)?(n.setStyles(o,t.isString(u)?{"text-align":u}:u),f=o):(s=r.document.createElement("p"),n.setStyles(s,t.isString(u)?{"text-align":u}:u),a=e.extractContents(),s.appendChild(a),e.insertNode(s),f=s);f=n.getNextDomNode(f,!1,c)}return r.moveToBookmark(h).moveToBookmark(v)};UE.commands.justify={execCommand:function(t,i){var r=this.selection.getRange(),f;return r.collapsed&&(f=this.document.createTextNode("p"),r.insertNode(f)),u(r,i),f&&(r.setStartBefore(f).collapse(!0),n.remove(f)),r.select(),!0},queryCommandValue:function(){var i=this.selection.getStart(),t=n.getComputedStyle(i,"text-align");return r[t]?t:"left"},queryCommandState:function(){var t=this.selection.getStart(),i=t&&n.findParentByTagName(t,["td","th","caption"],!0);return i?-1:0}}};UE.plugins.font=function(){function l(t){for(var i;i=t.parentNode;)if(i.tagName=="SPAN"&&n.getChildCount(i,function(t){return!n.isBookmarkNode(t)&&!n.isBr(t)})==1)i.style.cssText+=t.style.cssText,n.remove(t,!0),t=i;else break}function a(i,r,u){var f,e;c[r]&&(i.adjustmentBoundary(),i.collapsed||i.startContainer.nodeType!=1||(f=i.startContainer.childNodes[i.startOffset],f&&n.isTagNode(f,"span")&&(e=i.createBookmark(),t.each(n.getElementsByTagName(f,"span"),function(t){t.parentNode&&!n.isBookmarkNode(t)&&(r!="backcolor"||n.getComputedStyle(t,"background-color").toLowerCase()!==u)&&(n.removeStyle(t,c[r]),t.style.cssText.replace(/^\s+$/,"").length==0&&n.remove(t,!0))}),i.moveToBookmark(e))))}function u(i,u,e){var h=i.collapsed,s=i.createBookmark(),o;if(h)for(o=s.start.parentNode;f.$inline[o.tagName];)o=o.parentNode;else o=n.getCommonAncestor(s.start,s.end);t.each(n.getElementsByTagName(o,"span"),function(t){var i,f;if(t.parentNode&&!n.isBookmarkNode(t)){if(/\s*border\s*:\s*none;?\s*/i.test(t.style.cssText)){/^\s*border\s*:\s*none;?\s*$/.test(t.style.cssText)?n.remove(t,!0):n.removeStyle(t,"border");return}if(/border/i.test(t.style.cssText)&&t.parentNode.tagName=="SPAN"&&/border/i.test(t.parentNode.style.cssText)&&(t.style.cssText=t.style.cssText.replace(/border[^:]*:[^;]+;?/gi,"")),!(u=="fontborder"&&e=="none"))for(i=t.nextSibling;i&&i.nodeType==1&&i.tagName=="SPAN";){if(n.isBookmarkNode(i)&&u=="fontborder"){t.appendChild(i);i=t.nextSibling;continue}if(i.style.cssText==t.style.cssText&&(n.moveChild(i,t),n.remove(i)),t.nextSibling===i)break;i=t.nextSibling}l(t);r.ie&&r.version>8&&(f=n.findParent(t,function(n){return n.tagName=="SPAN"&&/background-color/.test(n.style.cssText)}),f&&!/background-color/.test(t.style.cssText)&&(t.style.backgroundColor=f.style.backgroundColor))}});i.moveToBookmark(s);a(i,u,e)}var o=this,s={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration",fontborder:"border"},i={underline:1,strikethrough:1,fontborder:1},c={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family"},e;o.setOpt({fontfamily:[{name:"songti",val:"宋体,SimSun"},{name:"yahei",val:"微软雅黑,Microsoft YaHei"},{name:"kaiti",val:"楷体,楷体_GB2312, SimKai"},{name:"heiti",val:"黑体, SimHei"},{name:"lishu",val:"隶书, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]});o.addInputRule(function(n){t.each(n.getNodesByTagName("u s del font strike"),function(n){var i,t,r;if(n.tagName=="font"){i=[];for(t in n.attrs)switch(t){case"size":i.push("font-size:"+({"1":"10","2":"12","3":"16","4":"18","5":"24","6":"32","7":"48"}[n.attrs[t]]||n.attrs[t])+"px");break;case"color":i.push("color:"+n.attrs[t]);break;case"face":i.push("font-family:"+n.attrs[t]);break;case"style":i.push(n.attrs[t])}n.attrs={style:i.join(";")}}else r=n.tagName=="u"?"underline":"line-through",n.attrs={style:(n.getAttr("style")||"")+"text-decoration:"+r+";"};n.tagName="span"})});for(e in s)(function(t,e){UE.commands[t]={execCommand:function(f,o){var a,s,c,l,v;if(o=o||(this.queryCommandState(f)?"none":f=="underline"?"underline":f=="fontborder"?"1px solid #000":"line-through"),a=this,s=this.selection.getRange(),o=="default")s.collapsed&&(c=a.document.createTextNode("font"),s.insertNode(c).select()),a.execCommand("removeFormat","span,a",e),c&&(s.setStartBefore(c).collapse(!0),n.remove(c)),u(s,f,o),s.select();else if(s.collapsed){if(l=n.findParentByTagName(s.startContainer,"span",!0),c=a.document.createTextNode("font"),!l||l.children.length||l[r.ie?"innerText":"textContent"].replace(h,"").length){if(s.insertNode(c),s.selectNode(c).select(),l=s.document.createElement("span"),i[t]){if(n.findParentByTagName(c,"a",!0)){s.setStartBefore(c).setCursor();n.remove(c);return}a.execCommand("removeFormat","span,a",e)}if(l.style.cssText=e+":"+o,c.parentNode.insertBefore(l,c),!r.ie||r.ie&&r.version==9)for(v=l.parentNode;!n.isBlockElm(v);)v.tagName=="SPAN"&&(l.style.cssText=v.style.cssText+";"+l.style.cssText),v=v.parentNode;p?setTimeout(function(){s.setStart(l,0).collapse(!0);u(s,f,o);s.select()}):(s.setStart(l,0).collapse(!0),u(s,f,o),s.select())}else s.insertNode(c),i[t]&&(s.selectNode(c).select(),a.execCommand("removeFormat","span,a",e,null),l=n.findParentByTagName(c,"span",!0),s.setStartBefore(c)),l&&(l.style.cssText+=";"+e+":"+o),s.collapse(!0).select();n.remove(c)}else i[t]&&a.queryCommandValue(t)&&a.execCommand("removeFormat","span,a",e),s=a.selection.getRange(),s.applyInlineStyle("span",{style:e+":"+o}),u(s,f,o),s.select();return!0},queryCommandValue:function(t){var u=this.selection.getStart(),r,s,o,h,i;if(t=="underline"||t=="strikethrough"){for(r=u;r&&!n.isBlockElm(r)&&!n.isBody(r);){if(r.nodeType==1&&(s=n.getComputedStyle(r,e),s!="none"))return s;r=r.parentNode}return"none"}if(t=="fontborder"){for(i=u;i&&f.$inline[i.tagName];){if((o=n.getComputedStyle(i,"border"))&&/1px/.test(o)&&/solid/.test(o))return o;i=i.parentNode}return""}return t=="FontSize"?(h=n.getComputedStyle(u,e),i=/^([\d\.]+)(\w+)$/.exec(h),i)?Math.floor(i[1])+i[2]:h:n.getComputedStyle(u,e)},queryCommandState:function(n){if(!i[n])return 0;var t=this.queryCommandValue(n);return n=="fontborder"?/1px/.test(t)&&/solid/.test(t):n=="underline"?/underline/.test(t):/line\-through/.test(t)}}})(e,s[e])};UE.plugins.link=function(){function i(t){var i=t.startContainer,r=t.endContainer;(i=n.findParentByTagName(i,"a",!0))&&t.setStartBefore(i);(r=n.findParentByTagName(r,"a",!0))&&t.setEndAfter(r)}function u(u,f,e){var s=u.cloneRange(),l=e.queryCommandValue("link"),o,h,c;i(u=u.adjustmentBoundary());o=u.startContainer;o.nodeType==1&&l&&(o=o.childNodes[u.startOffset],o&&o.nodeType==1&&o.tagName=="A"&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(o[r.ie?"innerText":"textContent"])&&(o[r.ie?"innerText":"textContent"]=t.html(f.textValue||f.href)));(!s.collapsed||l)&&(u.removeInlineStyle("a"),s=u.cloneRange());s.collapsed?(h=u.document.createElement("a"),c="",f.textValue?(c=t.html(f.textValue),delete f.textValue):c=t.html(f.href),n.setAttributes(h,f),o=n.findParentByTagName(s.startContainer,"a",!0),o&&n.isInNodeEndBoundary(s,o)&&u.setStartAfter(o).collapse(!0),h[r.ie?"innerText":"textContent"]=c,u.insertNode(h).selectNode(h)):u.applyInlineStyle("a",f)}UE.commands.unlink={execCommand:function(){var t=this.selection.getRange(),r;(!t.collapsed||n.findParentByTagName(t.startContainer,"a",!0))&&(r=t.createBookmark(),i(t),t.removeInlineStyle("a").moveToBookmark(r).select())},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}};UE.commands.link={execCommand:function(n,i){var r;i._href&&(i._href=t.unhtml(i._href,/[<">]/g));i.href&&(i.href=t.unhtml(i.href,/[<">]/g));i.textValue&&(i.textValue=t.unhtml(i.textValue,/[<">]/g));u(r=this.selection.getRange(),i,this);r.collapse().select(!0)},queryCommandValue:function(){var t=this.selection.getRange(),i,o,f,e,s,r;if(t.collapsed){if(i=t.startContainer,i=i.nodeType==1?i:i.parentNode,i&&(i=n.findParentByTagName(i,"a",!0))&&!n.isInNodeEndBoundary(t,i))return i}else{t.shrinkBoundary();var h=t.startContainer.nodeType==3||!t.startContainer.childNodes[t.startOffset]?t.startContainer:t.startContainer.childNodes[t.startOffset],c=t.endContainer.nodeType==3||t.endOffset==0?t.endContainer:t.endContainer.childNodes[t.endOffset-1],u=t.getCommonAncestor();if(i=n.findParentByTagName(u,"a",!0),!i&&u.nodeType==1)for(o=u.getElementsByTagName("a"),s=0;r=o[s++];)if(f=n.getPosition(r,h),e=n.getPosition(r,c),(f&n.POSITION_FOLLOWING||f&n.POSITION_CONTAINS)&&(e&n.POSITION_PRECEDING||e&n.POSITION_CONTAINS)){i=r;break}return i}},queryCommandState:function(){var n=this.selection.getRange().getClosedNode(),t=n&&(n.className=="edui-faked-video"||n.className.indexOf("edui-upload-video")!=-1);return t?-1:0}}};UE.plugins.insertframe=function(){function t(){n._iframe&&delete n._iframe}var n=this;n.addListener("selectionchange",function(){t()})};UE.commands.scrawl={queryCommandState:function(){return r.ie&&r.version<=8?-1:0}};UE.plugins.removeformat=function(){var t=this;t.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"});t.commands.removeformat={execCommand:function(t,i,u,o,s){function y(n){var t,i,u;if(n.nodeType==3||n.tagName.toLowerCase()!="span")return 0;if(r.ie&&(t=n.attributes,t.length)){for(i=0,u=t.length;i<u;i++)if(t[i].specified)return 0;return 1}return!n.attributes.length}function w(t){var k=t.createBookmark(),o,r,w,e,i,a,b;for(t.collapsed&&t.enlarge(!0),s||(o=n.findParentByTagName(t.startContainer,"a",!0),o&&t.setStartBefore(o),o=n.findParentByTagName(t.endContainer,"a",!0),o&&t.setEndAfter(o)),h=t.createBookmark(),i=h.start;(c=i.parentNode)&&!n.isBlockElm(c);)n.breakParent(i,c),n.clearEmptySibling(i);if(h.end){for(i=h.end;(c=i.parentNode)&&!n.isBlockElm(c);)n.breakParent(i,c),n.clearEmptySibling(i);for(r=n.getNextDomNode(h.start,!1,v);r;){if(r==h.end)break;w=n.getNextDomNode(r,!0,v);f.$empty[r.tagName.toLowerCase()]||n.isBookmarkNode(r)||(p.test(r.tagName)?u?(n.removeStyle(r,u),y(r)&&u!="text-decoration"&&n.remove(r,!0)):n.remove(r,!0):f.$tableContent[r.tagName]||f.$list[r.tagName]||(n.removeAttributes(r,l),y(r)&&n.remove(r,!0)));r=w}}for(e=h.start.parentNode,!n.isBlockElm(e)||f.$tableContent[e.tagName]||f.$list[e.tagName]||n.removeAttributes(e,l),e=h.end.parentNode,h.end&&n.isBlockElm(e)&&!f.$tableContent[e.tagName]&&!f.$list[e.tagName]&&n.removeAttributes(e,l),t.moveToBookmark(h).moveToBookmark(k),i=t.startContainer,b=t.collapsed;i.nodeType==1&&n.isEmptyNode(i)&&f.$removeEmpty[i.tagName];)a=i.parentNode,t.setStartBefore(i),t.startContainer===t.endContainer&&t.endOffset--,n.remove(i),i=a;if(!b)for(i=t.endContainer;i.nodeType==1&&n.isEmptyNode(i)&&f.$removeEmpty[i.tagName];)a=i.parentNode,t.setEndBefore(i),n.remove(i),i=a}var p=new RegExp("^(?:"+(i||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),l=u?[]:(o||this.options.removeFormatAttributes).split(","),a=new e.Range(this.document),h,c,v=function(n){return n.nodeType==1};a=this.selection.getRange();w(a);a.select()}}};UE.plugins.blockquote=function(){function t(t){return n.filterNodeList(t.selection.getStartElementPath(),"blockquote")}var i=this;i.commands.blockquote={execCommand:function(i,r){var l=this.selection.getRange(),c=t(this),b=f.blockquote,nt=l.createBookmark(),k,a,g,v,w;if(c){var y=l.startContainer,s=n.isBlockElm(y)?y:n.findParent(y,function(t){return n.isBlockElm(t)}),p=l.endContainer,h=n.isBlockElm(p)?p:n.findParent(p,function(t){return n.isBlockElm(t)});for(s=n.findParentByTagName(s,"li",!0)||s,h=n.findParentByTagName(h,"li",!0)||h,s.tagName=="LI"||s.tagName=="TD"||s===c||n.isBody(s)?n.remove(c,!0):n.breakParent(s,c),s!==h&&(c=n.findParentByTagName(h,"blockquote"),c&&(h.tagName=="LI"||h.tagName=="TD"||n.isBody(h)?c.parentNode&&n.remove(c,!0):n.breakParent(h,c))),k=n.getElementsByTagName(this.document,"blockquote"),v=0;a=k[v++];)a.childNodes.length?n.getPosition(a,s)&n.POSITION_FOLLOWING&&n.getPosition(a,h)&n.POSITION_PRECEDING&&n.remove(a,!0):n.remove(a)}else{for(var e=l.cloneRange(),u=e.startContainer.nodeType==1?e.startContainer:e.startContainer.parentNode,o=u,d=1;;){if(n.isBody(u)){o!==u?l.collapsed?(e.selectNode(o),d=0):e.setStartBefore(o):e.setStart(u,0);break}if(!b[u.tagName]){l.collapsed?e.selectNode(o):e.setStartBefore(o);break}o=u;u=u.parentNode}if(d)for(o=u=u=e.endContainer.nodeType==1?e.endContainer:e.endContainer.parentNode;;){if(n.isBody(u)){o!==u?e.setEndAfter(o):e.setEnd(u,u.childNodes.length);break}if(!b[u.tagName]){e.setEndAfter(o);break}o=u;u=u.parentNode}for(u=l.document.createElement("blockquote"),n.setAttributes(u,r),u.appendChild(e.extractContents()),e.insertNode(u),g=n.getElementsByTagName(u,"blockquote"),v=0;w=g[v++];)w.parentNode&&n.remove(w,!0)}l.moveToBookmark(nt).select()},queryCommandState:function(){return t(this)?1:0}}};UE.commands.touppercase=UE.commands.tolowercase={execCommand:function(t){var o=this,r=o.selection.getRange();if(r.collapsed)return r;for(var u=r.createBookmark(),f=u.end,e=function(t){return!n.isBr(t)&&!n.isWhitespace(t)},i=n.getNextDomNode(u.start,!1,e);i&&n.getPosition(i,f)&n.POSITION_PRECEDING;)if(i.nodeType==3&&(i.nodeValue=i.nodeValue[t=="touppercase"?"toUpperCase":"toLowerCase"]()),i=n.getNextDomNode(i,!0,e),i===f)break;r.moveToBookmark(u).select()}};UE.commands.indent={execCommand:function(){var n=this,t=n.queryCommandState("indent")?"0em":n.options.indentValue||"2em";n.execCommand("Paragraph","p",{style:"text-indent:"+t})},queryCommandState:function(){var t=n.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return t&&t.style.textIndent&&parseInt(t.style.textIndent)?1:0}};UE.commands.print={execCommand:function(){this.window.print()},notNeedUndo:1};UE.commands.preview={execCommand:function(){var t=window.open("","_blank",""),n=t.document;n.open();n.write('<!DOCTYPE html><html><head><meta charset="utf-8"/><script src="'+this.options.UEDITOR_HOME_URL+"ueditor.parse.js\"><\/script><script>setTimeout(function(){uParse('div',{rootPath: '"+this.options.UEDITOR_HOME_URL+"'})},300)<\/script><\/head><body><div>"+this.getContent(null,null,!0)+"<\/div><\/body><\/html>");n.close()},notNeedUndo:1};UE.plugins.selectall=function(){var t=this;t.commands.selectall={execCommand:function(){var u=this,t=u.body,i=u.selection.getRange();i.selectNodeContents(t);n.isEmptyBlock(t)&&(r.opera&&t.firstChild&&t.firstChild.nodeType==1&&i.setStartAtFirst(t.firstChild),i.collapse(!0));i.select(!0)},notNeedUndo:1};t.addshortcutkey({selectAll:"ctrl+65"})};UE.plugins.paragraph=function(){var u=this,i=n.isBlockElm,f=["TD","LI","PRE"],e=function(r,u,e,o){var p=r.createBookmark(),v=function(t){return t.nodeType==1?t.tagName.toLowerCase()!="br"&&!n.isBookmarkNode(t):!n.isWhitespace(t)},s,h;r.enlarge(!0);for(var l=r.createBookmark(),c=n.getNextDomNode(l.start,!1,v),a=r.cloneRange(),y;c&&!(n.getPosition(c,l.end)&n.POSITION_FOLLOWING);)if(c.nodeType!=3&&i(c))c=n.getNextDomNode(c,!0,v);else{for(a.setStartBefore(c);c&&c!==l.end&&!i(c);)y=c,c=n.getNextDomNode(c,!1,null,function(n){return!i(n)});a.setEndAfter(y);s=r.document.createElement(u);e&&(n.setAttributes(s,e),o&&o=="customstyle"&&e.style&&(s.style.cssText=e.style));s.appendChild(a.extractContents());n.isEmptyNode(s)&&n.fillChar(r.document,s);a.insertNode(s);h=s.parentNode;i(h)&&!n.isBody(s.parentNode)&&t.indexOf(f,h.tagName)==-1&&(o&&o=="customstyle"||(h.getAttribute("dir")&&s.setAttribute("dir",h.getAttribute("dir")),h.style.cssText&&(s.style.cssText=h.style.cssText+";"+s.style.cssText),h.style.textAlign&&!s.style.textAlign&&(s.style.textAlign=h.style.textAlign),h.style.textIndent&&!s.style.textIndent&&(s.style.textIndent=h.style.textIndent),h.style.padding&&!s.style.padding&&(s.style.padding=h.style.padding)),e&&/h\d/i.test(h.tagName)&&!/h\d/i.test(s.tagName)?(n.setAttributes(h,e),o&&o=="customstyle"&&e.style&&(h.style.cssText=e.style),n.remove(s,!0),s=h):n.remove(s.parentNode,!0));c=t.indexOf(f,h.tagName)!=-1?h:s;c=n.getNextDomNode(c,!1,v)}return r.moveToBookmark(l).moveToBookmark(p)};u.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""});u.commands.paragraph={execCommand:function(t,i,u,f){var o=this.selection.getRange(),s,h,c;return o.collapsed&&(s=this.document.createTextNode("p"),o.insertNode(s),r.ie&&(h=s.previousSibling,h&&n.isWhitespace(h)&&n.remove(h),h=s.nextSibling,h&&n.isWhitespace(h)&&n.remove(h))),o=e(o,i,u,f),s&&(o.setStartBefore(s).collapse(!0),pN=s.parentNode,n.remove(s),n.isBlockElm(pN)&&n.isEmptyNode(pN)&&n.fillNode(this.document,pN)),r.gecko&&o.collapsed&&o.startContainer.nodeType==1&&(c=o.startContainer.childNodes[o.startOffset],c&&c.nodeType==1&&c.tagName.toLowerCase()==i&&o.setStart(c,0).collapse(!0)),o.select(),!0},queryCommandValue:function(){var t=n.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return t?t.tagName.toLowerCase():""}}},function(){var t=n.isBlockElm,i=function(t){return n.filterNodeList(t.selection.getStartElementPath(),function(n){return n&&n.nodeType==1&&n.getAttribute("dir")})},r=function(r,u,f){var a,l=function(t){return t.nodeType==1?!n.isBookmarkNode(t):!n.isWhitespace(t)},v=i(u),s,h,p;if(v&&r.collapsed)return v.setAttribute("dir",f),r;a=r.createBookmark();r.enlarge(!0);for(var c=r.createBookmark(),e=n.getNextDomNode(c.start,!1,l),o=r.cloneRange(),y;e&&!(n.getPosition(e,c.end)&n.POSITION_FOLLOWING);)if(e.nodeType!=3&&t(e))e=n.getNextDomNode(e,!0,l);else{for(o.setStartBefore(e);e&&e!==c.end&&!t(e);)y=e,e=n.getNextDomNode(e,!1,null,function(n){return!t(n)});o.setEndAfter(y);s=o.getCommonAncestor();!n.isBody(s)&&t(s)?(s.setAttribute("dir",f),e=s):(h=r.document.createElement("p"),h.setAttribute("dir",f),p=o.extractContents(),h.appendChild(p),o.insertNode(h),e=h);e=n.getNextDomNode(e,!1,l)}return r.moveToBookmark(c).moveToBookmark(a)};UE.commands.directionality={execCommand:function(t,i){var u=this.selection.getRange(),f;return u.collapsed&&(f=this.document.createTextNode("d"),u.insertNode(f)),r(u,this,i),f&&(u.setStartBefore(f).collapse(!0),n.remove(f)),u.select(),!0},queryCommandValue:function(){var n=i(this);return n?n.getAttribute("dir"):"ltr"}}}();UE.plugins.horizontal=function(){var t=this;t.commands.horizontal={execCommand:function(n){var r=this,i,u,t;if(r.queryCommandState(n)!==-1)return r.execCommand("insertHtml","<hr>"),i=r.selection.getRange(),u=i.startContainer,u.nodeType!=1||u.childNodes[i.startOffset]||(t=u.childNodes[i.startOffset-1])&&t.nodeType==1&&t.tagName=="HR"&&(r.options.enterTag=="p"?(t=r.document.createElement("p"),i.insertNode(t),i.setStart(t,0).setCursor()):(t=r.document.createElement("br"),i.insertNode(t),i.setStartBefore(t).setCursor())),!0},queryCommandState:function(){return n.filterNodeList(this.selection.getStartElementPath(),"table")?-1:0}};t.addListener("delkeydown",function(t,i){var r=this.selection.getRange(),f,u;return r.txtToElmBoundary(!0),n.isStartInblock(r)&&(f=r.startContainer,u=f.previousSibling,u&&n.isTagNode(u,"hr"))?(n.remove(u),r.select(),n.preventDefault(i),!0):void 0})};UE.commands.time=UE.commands.date={execCommand:function(n,t){function r(n,t){var i=("0"+n.getHours()).slice(-2),r=("0"+n.getMinutes()).slice(-2),u=("0"+n.getSeconds()).slice(-2);return t=t||"hh:ii:ss",t.replace(/hh/ig,i).replace(/ii/ig,r).replace(/ss/ig,u)}function u(n,t){var i=("000"+n.getFullYear()).slice(-4),r=i.slice(-2),u=("0"+(n.getMonth()+1)).slice(-2),f=("0"+n.getDate()).slice(-2);return t=t||"yyyy-mm-dd",t.replace(/yyyy/ig,i).replace(/yy/ig,r).replace(/mm/ig,u).replace(/dd/ig,f)}var i=new Date;this.execCommand("insertHtml",n=="time"?r(i,t):u(i,t))}};UE.plugins.rowspacing=function(){var t=this;t.setOpt({rowspacingtop:["5","10","15","20","25"],rowspacingbottom:["5","10","15","20","25"]});t.commands.rowspacing={execCommand:function(n,t,i){return this.execCommand("paragraph","p",{style:"margin-"+i+":"+t+"px"}),!0},queryCommandValue:function(t,i){var u=n.filterNodeList(this.selection.getStartElementPath(),function(t){return n.isBlockElm(t)}),r;return u?(r=n.getComputedStyle(u,"margin-"+i).replace(/[^\d]/g,""),r?r:0):0}}};UE.plugins.lineheight=function(){var t=this;t.setOpt({lineheight:["1","1.5","1.75","2","3","4","5"]});t.commands.lineheight={execCommand:function(n,t){return this.execCommand("paragraph","p",{style:"line-height:"+(t=="1"?"normal":t+"em")}),!0},queryCommandValue:function(){var i=n.filterNodeList(this.selection.getStartElementPath(),function(t){return n.isBlockElm(t)}),t;if(i)return t=n.getComputedStyle(i,"line-height"),t=="normal"?1:t.replace(/[^\d.]*/ig,"")}}};UE.plugins.insertcode=function(){var i=this,u;i.ready(function(){t.cssRule("pre","pre{margin:.5em 0;padding:.4em .6em;border-radius:8px;background:#f8f8f8;}",i.document)});i.setOpt("insertcode",{as3:"ActionScript3",bash:"Bash/Shell",cpp:"C/C++",css:"Css",cf:"CodeFunction","c#":"C#",delphi:"Delphi",diff:"Diff",erlang:"Erlang",groovy:"Groovy",html:"Html",java:"Java",jfx:"JavaFx",js:"Javascript",pl:"Perl",php:"Php",plain:"Plain Text",ps:"PowerShell",python:"Python",ruby:"Ruby",scala:"Scala",sql:"Sql",vb:"Vb",xml:"Xml"});i.commands.insertcode={execCommand:function(i,u){var s=this,h=s.selection.getRange(),o=n.findParentByTagName(h.startContainer,"pre",!0),e,a,l,c;o?o.className="brush:"+u+";toolbar:false;":(e="",h.collapsed?e=r.ie&&r.ie11below?r.version<=8?"&nbsp;":"":"<br/>":(a=h.extractContents(),l=s.document.createElement("div"),l.appendChild(a),t.each(UE.filterNode(UE.htmlparser(l.innerHTML.replace(/[\r\t]/g,"")),s.options.filterTxtRules).children,function(n){if(r.ie&&r.ie11below&&r.version>8)n.type=="element"?n.tagName=="br"?e+="\n":f.$empty[n.tagName]||(t.each(n.children,function(t){t.type=="element"?t.tagName=="br"?e+="\n":f.$empty[n.tagName]||(e+=t.innerText()):e+=t.data}),/\n$/.test(e)||(e+="\n")):e+=n.data+"\n",!n.nextSibling()&&/\n$/.test(e)&&(e=e.replace(/\n$/,""));else if(r.ie&&r.ie11below)n.type=="element"?n.tagName=="br"?e+="<br>":f.$empty[n.tagName]||(t.each(n.children,function(t){t.type=="element"?t.tagName=="br"?e+="<br>":f.$empty[n.tagName]||(e+=t.innerText()):e+=t.data}),/br>$/.test(e)||(e+="<br>")):e+=n.data+"<br>",!n.nextSibling()&&/<br>$/.test(e)&&(e=e.replace(/<br>$/,""));else if(e+=n.type=="element"?f.$empty[n.tagName]?"":n.innerText():n.data,!/br\/?\s*>$/.test(e)){if(!n.nextSibling())return;e+="<br>"}})),s.execCommand("inserthtml",'<pre id="coder"class="brush:'+u+';toolbar:false">'+e+"<\/pre>",!0),o=s.document.getElementById("coder"),n.removeAttributes(o,"id"),c=o.previousSibling,c&&(c.nodeType==3&&c.nodeValue.length==1&&r.ie&&r.version==6||n.isEmptyBlock(c))&&n.remove(c),h=s.selection.getRange(),n.isEmptyBlock(o)?h.setStart(o,0).setCursor(!1,!0):h.selectNodeContents(o).select())},queryCommandValue:function(){var i=this.selection.getStartElementPath(),n="";return t.each(i,function(t){if(t.nodeName=="PRE"){var i=t.className.match(/brush:([^;]+)/);return n=i&&i[1]?i[1]:"",!1}}),n}};i.addInputRule(function(n){t.each(n.getNodesByTagName("pre"),function(n){var i=n.getNodesByTagName("br"),u;if(i.length){r.ie&&r.ie11below&&r.version>8&&t.each(i,function(n){var t=UE.uNode.createText("\n");n.parentNode.insertBefore(t,n);n.parentNode.removeChild(n)});return}r.ie&&r.ie11below&&r.version>8||(u=n.innerText().split(/\n/),n.innerHTML(""),t.each(u,function(t){t.length&&n.appendChild(UE.uNode.createText(t));n.appendChild(UE.uNode.createElement("br"))}))})});i.addOutputRule(function(n){t.each(n.getNodesByTagName("pre"),function(n){var i="";t.each(n.children,function(n){i+=n.type=="text"?n.data.replace(/[ ]/g,"&nbsp;").replace(/\n$/,""):n.tagName=="br"?"\n":f.$empty[n.tagName]?n.innerText():""});n.innerText(i.replace(/(&nbsp;|\n)+$/,""))})});i.notNeedCodeQuery={help:1,undo:1,redo:1,source:1,print:1,searchreplace:1,fullscreen:1,preview:1,insertparagraph:1,elementpath:1,insertcode:1,inserthtml:1,selectall:1};u=i.queryCommandState;i.queryCommandState=function(n){var t=this;return!t.notNeedCodeQuery[n.toLowerCase()]&&t.selection&&t.queryCommandValue("insertcode")?-1:UE.Editor.prototype.queryCommandState.apply(this,arguments)};i.addListener("beforeenterkeydown",function(){var u=i.selection.getRange(),t=n.findParentByTagName(u.startContainer,"pre",!0),a,s,c,v,h,e,l,f,o;if(t){if(i.fireEvent("saveScene"),u.collapsed||u.deleteContents(),!r.ie||r.ie9above){for(e=i.document.createElement("br"),u.insertNode(e).setStartAfter(e).collapse(!0),a=e.nextSibling,!a&&(!r.ie||r.version>10)?u.insertNode(e.cloneNode(!1)):u.setStartAfter(e),t=e.previousSibling;t;)if(l=t,t=t.previousSibling,!t||t.nodeName=="BR"){t=l;break}if(t){for(f="";t&&t.nodeName!="BR"&&new RegExp("^[\\s"+n.fillChar+"]*$").test(t.nodeValue);)f+=t.nodeValue,t=t.nextSibling;t.nodeName!="BR"&&(o=t.nodeValue.match(new RegExp("^([\\s"+n.fillChar+"]+)")),o&&o[1]&&(f+=o[1]));f&&(f=i.document.createTextNode(f),u.insertNode(f).setStartAfter(f))}u.collapse(!0).select(!0)}else if(r.version>8)s=i.document.createTextNode("\n"),c=u.startContainer,u.startOffset==0?(v=c.previousSibling,v&&(u.insertNode(s),h=i.document.createTextNode(" "),u.setStartAfter(s).insertNode(h).setStart(h,0).collapse(!0).select(!0))):(u.insertNode(s).setStartAfter(s),h=i.document.createTextNode(" "),c=u.startContainer.childNodes[u.startOffset],c&&!/^\n/.test(c.nodeValue)&&u.setStartBefore(s),u.insertNode(h).setStart(h,0).collapse(!0).select(!0));else{for(e=i.document.createElement("br"),u.insertNode(e),u.insertNode(i.document.createTextNode(n.fillChar)),u.setStartAfter(e),t=e.previousSibling;t;)if(l=t,t=t.previousSibling,!t||t.nodeName=="BR"){t=l;break}if(t){for(f="";t&&t.nodeName!="BR"&&new RegExp("^[ "+n.fillChar+"]*$").test(t.nodeValue);)f+=t.nodeValue,t=t.nextSibling;t.nodeName!="BR"&&(o=t.nodeValue.match(new RegExp("^([ "+n.fillChar+"]+)")),o&&o[1]&&(f+=o[1]));f=i.document.createTextNode(f);u.insertNode(f).setStartAfter(f)}u.collapse(!0).select()}return i.fireEvent("saveScene"),!0}});i.addListener("tabkeydown",function(t,r){var o=i.selection.getRange(),f=n.findParentByTagName(o.startContainer,"pre",!0),e,u,s,h;if(f){if(i.fireEvent("saveScene"),!r.shiftKey)if(o.collapsed)h=i.document.createTextNode("    "),o.insertNode(h).setStartAfter(h).collapse(!0).select(!0);else{for(e=o.createBookmark(),u=e.start.previousSibling;u;){if(f.firstChild===u&&!n.isBr(u)){f.insertBefore(i.document.createTextNode("    "),u);break}if(n.isBr(u)){f.insertBefore(i.document.createTextNode("    "),u.nextSibling);break}u=u.previousSibling}for(s=e.end,u=e.start.nextSibling,f.firstChild===e.start&&f.insertBefore(i.document.createTextNode("    "),u.nextSibling);u&&u!==s;){if(n.isBr(u)&&u.nextSibling){if(u.nextSibling===s)break;f.insertBefore(i.document.createTextNode("    "),u.nextSibling)}u=u.nextSibling}o.moveToBookmark(e).select()}return i.fireEvent("saveScene"),!0}});i.addListener("beforeinserthtml",function(i,u){var s=this,h=s.selection.getRange(),l=n.findParentByTagName(h.startContainer,"pre",!0),e,c,o;if(l)return h.collapsed||h.deleteContents(),e="",r.ie&&r.version>8?(t.each(UE.filterNode(UE.htmlparser(u),s.options.filterTxtRules).children,function(n){n.type=="element"?n.tagName=="br"?e+="\n":f.$empty[n.tagName]||(t.each(n.children,function(t){t.type=="element"?t.tagName=="br"?e+="\n":f.$empty[n.tagName]||(e+=t.innerText()):e+=t.data}),/\n$/.test(e)||(e+="\n")):e+=n.data+"\n";!n.nextSibling()&&/\n$/.test(e)&&(e=e.replace(/\n$/,""))}),c=s.document.createTextNode(t.html(e.replace(/&nbsp;/g," "))),h.insertNode(c).selectNode(c).select()):(o=s.document.createDocumentFragment(),t.each(UE.filterNode(UE.htmlparser(u),s.options.filterTxtRules).children,function(n){n.type=="element"?n.tagName=="br"?o.appendChild(s.document.createElement("br")):f.$empty[n.tagName]||(t.each(n.children,function(i){i.type=="element"?i.tagName=="br"?o.appendChild(s.document.createElement("br")):f.$empty[n.tagName]||o.appendChild(s.document.createTextNode(t.html(i.innerText().replace(/&nbsp;/g," ")))):o.appendChild(s.document.createTextNode(t.html(i.data.replace(/&nbsp;/g," "))))}),o.lastChild.nodeName!="BR"&&o.appendChild(s.document.createElement("br"))):o.appendChild(s.document.createTextNode(t.html(n.data.replace(/&nbsp;/g," "))));n.nextSibling()||o.lastChild.nodeName!="BR"||o.removeChild(o.lastChild)}),h.insertNode(o).select()),!0});i.addListener("keydown",function(t,i){var e=this,s=i.keyCode||i.which,r,f,o,u;if(s==40&&(r=e.selection.getRange(),o=r.startContainer,r.collapsed&&(f=n.findParentByTagName(r.startContainer,"pre",!0))&&!f.nextSibling)){for(u=f.lastChild;u&&u.nodeName=="BR";)u=u.previousSibling;(u===o||r.startContainer===f&&r.startOffset==f.childNodes.length)&&(e.execCommand("insertparagraph"),n.preventDefault(i))}});i.addListener("delkeydown",function(t,r){var u=this.selection.getRange(),f,e;return u.txtToElmBoundary(!0),f=u.startContainer,n.isTagNode(f,"pre")&&u.collapsed&&n.isStartInblock(u)?(e=i.document.createElement("p"),n.fillNode(i.document,e),f.parentNode.insertBefore(e,f),n.remove(f),u.setStart(e,0).setCursor(!1,!0),n.preventDefault(r),!0):void 0})};UE.commands.cleardoc={execCommand:function(){var n=this,i=n.options.enterTag,t=n.selection.getRange();i=="br"?(n.body.innerHTML="<br/>",t.setStart(n.body,0).setCursor()):(n.body.innerHTML="<p>"+(o?"":"<br/>")+"<\/p>",t.setStart(n.body.firstChild,0).setCursor(!1,!0));setTimeout(function(){n.fireEvent("clearDoc")},0)}};UE.plugin.register("anchor",function(){return{bindEvents:{ready:function(){t.cssRule("anchor",".anchorclass{background: url('"+this.options.themePath+this.options.theme+"/images/anchor.gif') no-repeat scroll left center transparent;cursor: auto;display: inline-block;height: 16px;width: 15px;}",this.document)}},outputRule:function(n){t.each(n.getNodesByTagName("img"),function(n){var t;(t=n.getAttr("anchorname"))&&(n.tagName="a",n.setAttr({anchorname:"",name:t,"class":""}))})},inputRule:function(n){t.each(n.getNodesByTagName("a"),function(n){var t;(t=n.getAttr("name"))&&!n.getAttr("href")&&(n.tagName="img",n.setAttr({anchorname:n.getAttr("name"),"class":"anchorclass"}),n.setAttr("name"))})},commands:{anchor:{execCommand:function(t,i){var u=this.selection.getRange(),r=u.getClosedNode(),f;r&&r.getAttribute("anchorname")?i?r.setAttribute("anchorname",i):(u.setStartBefore(r).setCursor(),n.remove(r)):i&&(f=this.document.createElement("img"),u.collapse(!0),n.setAttributes(f,{anchorname:i,"class":"anchorclass"}),u.insertNode(f).setStartAfter(f).setCursor(!1,!0))}}}}});UE.plugins.wordcount=function(){var t=this,i;t.setOpt("wordCount",!0);t.addListener("contentchange",function(){t.fireEvent("wordcount")});t.addListener("ready",function(){var t=this;n.on(t.body,"keyup",function(n){var r=n.keyCode||n.which;r in{"16":1,"18":1,"20":1,"37":1,"38":1,"39":1,"40":1}||(clearTimeout(i),i=setTimeout(function(){t.fireEvent("wordcount")},200))})})};UE.plugins.pagebreak=function(){function r(t){if(n.isEmptyBlock(t)){for(var r=t.firstChild,u;r&&r.nodeType==1&&n.isEmptyBlock(r);)u=r,r=r.firstChild;u||(u=t);n.fillNode(i.document,u)}}function u(n){return n&&n.nodeType==1&&n.tagName=="HR"&&n.className=="pagebreak"}var i=this,f=["td"];i.setOpt("pageBreakTag","_ueditor_page_break_tag_");i.ready(function(){t.cssRule("pagebreak",".pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}",i.document)});i.addInputRule(function(n){n.traversal(function(n){if(n.type=="text"&&n.data==i.options.pageBreakTag){var t=UE.uNode.createElement('<hr class="pagebreak" noshade="noshade" size="5" style="-webkit-user-select: none;">');n.parentNode.insertBefore(t,n);n.parentNode.removeChild(n)}})});i.addOutputRule(function(n){t.each(n.getNodesByTagName("hr"),function(n){if(n.getAttr("class")=="pagebreak"){var t=UE.uNode.createText(i.options.pageBreakTag);n.parentNode.insertBefore(t,n);n.parentNode.removeChild(n)}})});i.commands.pagebreak={execCommand:function(){var o=i.selection.getRange(),t=i.document.createElement("hr"),l,a,y,h,e,s,c,v;if(n.setAttributes(t,{"class":"pagebreak",noshade:"noshade",size:"5"}),n.unSelectable(t),l=n.findParentByTagName(o.startContainer,f,!0),a=[],l)switch(l.tagName){case"TD":e=l.parentNode;e.previousSibling?(e.parentNode.insertBefore(t,e),a=n.findParents(t)):(y=n.findParentByTagName(e,"table"),y.parentNode.insertBefore(t,y),a=n.findParents(t,!0));e=a[1];t!==e&&n.breakParent(t,e);i.fireEvent("afteradjusttable",i.document)}else{if(!o.collapsed)for(o.deleteContents(),h=o.startContainer;!n.isBody(h)&&n.isBlockElm(h)&&n.isEmptyNode(h);)o.setStartBefore(h).collapse(!0),n.remove(h),h=o.startContainer;for(o.insertNode(t),e=t.parentNode;!n.isBody(e);)n.breakParent(t,e),s=t.nextSibling,s&&n.isEmptyBlock(s)&&n.remove(s),e=t.parentNode;s=t.nextSibling;c=t.previousSibling;u(c)?n.remove(c):c&&r(c);s?(u(s)?n.remove(s):r(s),o.setEndAfter(t).collapse(!1)):(v=i.document.createElement("p"),t.parentNode.appendChild(v),n.fillNode(i.document,v),o.setStart(v,0).collapse(!0));o.select(!0)}}}};UE.plugin.register("wordimage",function(){var i=this,r=[];return{commands:{wordimage:{execCommand:function(){for(var t,f=n.getElementsByTagName(i.body,"img"),r=[],e=0,u;u=f[e++];)t=u.getAttribute("word_img"),t&&r.push(t);return r},queryCommandState:function(){r=n.getElementsByTagName(i.body,"img");for(var u=0,t;t=r[u++];)if(t.getAttribute("word_img"))return 1;return-1},notNeedUndo:!0}},inputRule:function(n){t.each(n.getNodesByTagName("img"),function(n){var t=n.attrs,u=parseInt(t.width)<128||parseInt(t.height)<43,r=i.options,f=r.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";t.src&&/^(?:(file:\/+))/.test(t.src)&&n.setAttr({width:t.width,height:t.height,alt:t.alt,word_img:t.src,src:f,style:"background:url("+(u?r.themePath+r.theme+"/images/word.gif":r.langPath+r.lang+"/images/localimage.png")+") no-repeat center center;border:1px solid #ddd"})})}}});UE.plugins.dragdrop=function(){var t=this;t.ready(function(){n.on(this.body,"dragend",function(){var f=t.selection.getRange(),u=f.getClosedNode()||t.selection.getStart(),r,i;if(u&&u.tagName=="IMG"){for(r=u.previousSibling;i=u.nextSibling;)if(i.nodeType!=1||i.tagName!="SPAN"||i.firstChild)break;else n.remove(i);(!r||r.nodeType!=1||n.isEmptyBlock(r))&&r||i&&(!i||n.isEmptyBlock(i))||(r&&r.tagName=="P"&&!n.isEmptyBlock(r)?(r.appendChild(u),n.moveChild(i,r),n.remove(i)):i&&i.tagName=="P"&&!n.isEmptyBlock(i)&&i.insertBefore(u,i.firstChild),r&&r.tagName=="P"&&n.isEmptyBlock(r)&&n.remove(r),i&&i.tagName=="P"&&n.isEmptyBlock(i)&&n.remove(i),f.selectNode(u).select(),t.fireEvent("saveScene"))}})});t.addListener("keyup",function(i,r){var e=r.keyCode||r.which,f,u;e==13&&(f=t.selection.getRange(),(u=n.findParentByTagName(f.startContainer,"p",!0))&&n.getComputedStyle(u,"text-align")=="center"&&n.removeStyle(u,"text-align"))})};UE.plugins.undo=function(){function c(n,t){if(n.length!=t.length)return 0;for(var i=0,r=n.length;i<r;i++)if(n[i]!=t[i])return 0;return 1}function b(n,t){return n.collapsed!=t.collapsed?0:!c(n.startAddress,t.startAddress)||!c(n.endAddress,t.endAddress)?0:1}function k(){this.list=[];this.index=0;this.hasUndo=!1;this.hasRedo=!1;this.undo=function(){if(this.hasUndo){if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content)if(this.index--,this.index==0)return this.restore(0);this.restore(--this.index)}};this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content)if(this.index++,this.index==this.list.length-1)return this.restore(this.index);this.restore(++this.index)}};this.restore=function(){var i=this.editor,f=this.list[this.index],o=UE.htmlparser(f.content.replace(p,"")),u;i.options.autoClearEmptyNode=!1;i.filterInputRule(o);i.options.autoClearEmptyNode=h;i.document.body.innerHTML=o.toHtml();i.fireEvent("afterscencerestore");r.ie&&t.each(n.getElementsByTagName(i.document,"td th caption p"),function(t){n.isEmptyNode(t)&&n.fillNode(i.document,t)});try{u=new e.Range(i.document).moveToAddress(f.address);u.select(w[u.startContainer.nodeName.toLowerCase()])}catch(s){}this.update();this.clearKey();i.fireEvent("reset",!0)};this.getScene=function(){var n=this.editor,r=n.selection.getRange(),u=r.createAddress(!1,!0),t,i;return n.fireEvent("beforegetscene"),t=UE.htmlparser(n.body.innerHTML),n.options.autoClearEmptyNode=!1,n.filterOutputRule(t),n.options.autoClearEmptyNode=h,i=t.toHtml(),n.fireEvent("aftergetscene"),{address:u,content:i}};this.save=function(n,t){clearTimeout(o);var u=this.getScene(t),r=this.list[this.index];(r&&r.content!=u.content&&i.trigger("contentchange"),r&&r.content==u.content&&(n?1:b(r.address,u.address)))||(this.list=this.list.slice(0,this.index+1),this.list.push(u),this.list.length>v&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update())};this.update=function(){this.hasRedo=!!this.list[this.index+1];this.hasUndo=!!this.list[this.index-1]};this.reset=function(){this.list=[];this.index=0;this.hasUndo=!1;this.hasRedo=!1;this.clearKey()};this.clearKey=function(){s=0;a=null}}var o,i=this,v=i.options.maxUndoCount||20,y=i.options.maxInputCount||20,p=new RegExp(n.fillChar+"|<\/hr>","gi"),w={ol:1,ul:1,table:1,tbody:1,tr:1,body:1},h=i.options.autoClearEmptyNode,f;i.undoManger=new k;i.undoManger.editor=i;i.addListener("saveScene",function(){var n=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,n)});i.addListener("reset",function(n,t){t||this.undoManger.reset()});i.commands.redo=i.commands.undo={execCommand:function(n){this.undoManger[n]()},queryCommandState:function(n){return this.undoManger["has"+(n.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var l={16:1,17:1,18:1,37:1,38:1,39:1,40:1},s=0,a,u=!1;i.addListener("ready",function(){n.on(this.body,"compositionstart",function(){u=!0});n.on(this.body,"compositionend",function(){u=!1})});i.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"});f=!0;i.addListener("keydown",function(n,t){var i=this,e=t.keyCode||t.which;if(!l[e]&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey){if(u)return;if(!i.selection.getRange().collapsed){i.undoManger.save(!1,!0);f=!1;return}i.undoManger.list.length==0&&i.undoManger.save(!0);clearTimeout(o);function r(n){n.undoManger.save(!1,!0);n.fireEvent("selectionchange")}o=setTimeout(function(){if(u){var n=setInterval(function(){u||(r(i),clearInterval(n))},300);return}r(i)},200);a=e;s++;s>=y&&r(i)}});i.addListener("keyup",function(n,t){var i=t.keyCode||t.which;if(!l[i]&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey){if(u)return;f||(this.undoManger.save(!1,!0),f=!0)}});i.stopCmdUndo=function(){i.__hasEnterExecCommand=!0};i.startCmdUndo=function(){i.__hasEnterExecCommand=!1}};UE.plugin.register("copy",function(){function u(){ZeroClipboard.config({debug:!1,swfPath:i.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.swf"});var t=i.zeroclipboard=new ZeroClipboard;t.on("copy",function(n){var r=n.client,u=i.selection.getRange(),t=document.createElement("div");t.appendChild(u.cloneContents());r.setText(t.innerText||t.textContent);r.setHtml(t.innerHTML);u.select()});t.on("mouseover mouseout",function(t){var i=t.target;t.type=="mouseover"?n.addClass(i,"edui-state-hover"):t.type=="mouseout"&&n.removeClasses(i,"edui-state-hover")});t.on("wrongflash noflash",function(){ZeroClipboard.destroy()})}var i=this;return{bindEvents:{ready:function(){r.ie||(window.ZeroClipboard?u():t.loadFile(document,{src:i.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.js",tag:"script",type:"text/javascript",defer:"defer"},function(){u()}))}},commands:{copy:{execCommand:function(){i.document.execCommand("copy")||alert(i.getLang("copymsg"))}}}}});UE.plugins.paste=function(){function o(t){var u=this.document;if(!u.getElementById("baidu_pastebin")){var f=this.selection.getRange(),e=f.createBookmark(),i=u.createElement("div");i.id="baidu_pastebin";r.webkit&&i.appendChild(u.createTextNode(n.fillChar+n.fillChar));u.body.appendChild(i);e.start.style.display="";i.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+n.getXY(e.start).y+"px";f.selectNodeContents(i).select(!0);setTimeout(function(){if(r.webkit)for(var s=0,h=u.querySelectorAll("#baidu_pastebin"),o;o=h[s++];)if(n.isEmptyNode(o))n.remove(o);else{i=o;break}try{i.parentNode.removeChild(i)}catch(c){}f.moveToBookmark(e).select(!0);t(i)},0)}}function s(n){return n.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(n,i,r,u){return(r=r.toLowerCase(),{img:1}[r])?n:(u=u.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(n,t,i){return{src:1,href:1,name:1}[t.toLowerCase()]?t+"="+i+" ":""}),{span:1,div:1}[r]?"":"<"+i+r+" "+t.trim(u)+">")})}function h(o){var l,d,w,g,y,nt,v,k,tt,b,it,rt,h,a,c,p;if(o.firstChild){for(d=n.getElementsByTagName(o,"span"),h=0;w=d[h++];)(w.id=="_baidu_cut_start"||w.id=="_baidu_cut_end")&&n.remove(w);if(r.webkit){for(b=o.querySelectorAll("div br"),h=0;g=b[h++];)y=g.parentNode,y.tagName=="DIV"&&y.childNodes.length==1&&(y.innerHTML="<p><br/><\/p>",n.remove(y));for(nt=o.querySelectorAll("#baidu_pastebin"),h=0;v=nt[h++];){for(k=i.document.createElement("p"),v.parentNode.insertBefore(k,v);v.firstChild;)k.appendChild(v.firstChild);n.remove(v)}for(tt=o.querySelectorAll("meta"),h=0;a=tt[h++];)n.remove(a);for(b=o.querySelectorAll("br"),h=0;a=b[h++];)/^apple-/i.test(a.className)&&n.remove(a)}if(r.gecko)for(it=o.querySelectorAll("[_moz_dirty]"),h=0;a=it[h++];)a.removeAttribute("_moz_dirty");if(!r.ie)for(rt=o.querySelectorAll("span.Apple-style-span"),h=0;a=rt[h++];)n.remove(a,!0);if(l=o.innerHTML,l=UE.filterWord(l),c=UE.htmlparser(l),i.options.filterRules&&UE.filterNode(c,i.options.filterRules),i.filterInputRule(c),r.webkit&&(p=c.lastChild(),p&&p.type=="element"&&p.tagName=="br"&&c.removeChild(p),t.each(i.body.querySelectorAll("div"),function(t){n.isEmptyBlock(t)&&n.remove(t,!0)})),l={html:c.toHtml()},i.fireEvent("beforepaste",l,c),!l.html)return;c=UE.htmlparser(l.html,!0);i.queryCommandState("pasteplain")===1?i.execCommand("insertHtml",UE.filterNode(c,i.options.filterTxtRules).toHtml(),!0):(UE.filterNode(c,i.options.filterTxtRules),f=c.toHtml(),u=l.html,e=i.selection.getRange().createAddress(!0),i.execCommand("insertHtml",i.getOpt("retainOnlyLabelPasted")===!0?s(u):u,!0));i.fireEvent("afterpaste",l)}}var i=this,f,u,e;i.setOpt({retainOnlyLabelPasted:!1});i.addListener("pasteTransfer",function(t,r){var o,c,a,l,v,y,h,p;if(e&&f&&u&&f!=u){if(o=i.selection.getRange(),o.moveToAddress(e,!0),!o.collapsed){while(!n.isBody(o.startContainer)){if(c=o.startContainer,c.nodeType==1){if(c=c.childNodes[o.startOffset],!c){o.setStartBefore(o.startContainer);continue}a=c.previousSibling;a&&a.nodeType==3&&new RegExp("^[\n\r\t "+n.fillChar+"]*$").test(a.nodeValue)&&o.setStartBefore(a)}if(o.startOffset==0)o.setStartBefore(o.startContainer);else break}while(!n.isBody(o.endContainer)){if(l=o.endContainer,l.nodeType==1){if(l=l.childNodes[o.endOffset],!l){o.setEndAfter(o.endContainer);continue}v=l.nextSibling;v&&v.nodeType==3&&new RegExp("^[\n\r\t"+n.fillChar+"]*$").test(v.nodeValue)&&o.setEndAfter(v)}if(o.endOffset==o.endContainer[o.endContainer.nodeType==3?"nodeValue":"childNodes"].length)o.setEndAfter(o.endContainer);else break}}for(o.deleteContents(),o.select(!0),i.__hasEnterExecCommand=!0,y=u,r===2?y=s(y):r&&(y=f),i.execCommand("inserthtml",y,!0),i.__hasEnterExecCommand=!1,h=i.selection.getRange();!n.isBody(h.startContainer)&&!h.startOffset&&h.startContainer[h.startContainer.nodeType==3?"nodeValue":"childNodes"].length;)h.setStartBefore(h.startContainer);p=h.createAddress(!0);e.endAddress=p.startAddress}});i.addListener("ready",function(){n.on(i.body,"cut",function(){var n=i.selection.getRange();!n.collapsed&&i.undoManger&&i.undoManger.save()});n.on(i.body,r.ie||r.opera?"keydown":"paste",function(n){(r.ie||r.opera)&&(!n.ctrlKey&&!n.metaKey||n.keyCode!="86")||o.call(i,function(n){h(n)})})});i.commands.paste={execCommand:function(){r.ie?(o.call(i,function(n){h(n)}),i.document.execCommand("paste")):alert(i.getLang("pastemsg"))}}};UE.plugins.pasteplain=function(){var t=this,n;t.setOpt({pasteplain:!1,filterTxtRules:function(){function n(n){n.tagName="p";n.setStyle()}function t(n){n.parentNode.removeChild(n,!0)}return{"-":"script style object iframe embed input select",p:{$:{}},br:{$:{}},div:function(n){for(var i,t=UE.uNode.createElement("p");i=n.firstChild();)i.type!="text"&&UE.dom.dtd.$block[i.tagName]?t.firstChild()?(n.parentNode.insertBefore(t,n),t=UE.uNode.createElement("p")):n.parentNode.insertBefore(i,n):t.appendChild(i);t.firstChild()&&n.parentNode.insertBefore(t,n);n.parentNode.removeChild(n)},ol:t,ul:t,dl:t,dt:t,dd:t,li:t,caption:n,th:n,tr:n,h1:n,h2:n,h3:n,h4:n,h5:n,h6:n,td:function(n){var t=!!n.innerText();t&&n.parentNode.insertAfter(UE.uNode.createText(" &nbsp; &nbsp;"),n);n.parentNode.removeChild(n,n.innerText())}}}()});n=t.options.pasteplain;t.commands.pasteplain={queryCommandState:function(){return n?1:0},execCommand:function(){n=!n|0},notNeedUndo:1}};UE.plugins.list=function(){function y(n){var t=[];for(var i in n)t.push(i);return t}function e(t){var i=t.className;return n.hasClass(t,/custom_/)?i.match(/custom_(\w+)/)[1]:n.getStyle(t,"list-style-type")}function p(i,r){t.each(n.getElementsByTagName(i,"ol ul"),function(f){var l,y,w,a,c,v,p;n.inDoc(f,i)&&(l=f.parentNode,l.tagName==f.tagName&&(y=e(f)||(f.tagName=="OL"?"decimal":"disc"),w=e(l)||(l.tagName=="OL"?"decimal":"disc"),y==w&&(a=t.indexOf(u[f.tagName],y),a=a+1==u[f.tagName].length?0:a+1,h(f,u[f.tagName][a]))),c=0,v=2,n.hasClass(f,/custom_/)?/[ou]l/i.test(l.tagName)&&n.hasClass(l,/custom_/)||(v=1):/[ou]l/i.test(l.tagName)&&n.hasClass(l,/custom_/)&&(v=3),p=n.getStyle(f,"list-style-type"),p&&(f.style.cssText="list-style-type:"+p),f.className=t.trim(f.className.replace(/list-paddingleft-\w+/,""))+" list-paddingleft-"+v,t.each(n.getElementsByTagName(f,"li"),function(t){var r,i,u;if(t.style.cssText&&(t.style.cssText=""),!t.firstChild){n.remove(t);return}if(t.parentNode===f){if(c++,n.hasClass(f,/custom_/))if(r=1,i=e(f),f.tagName=="OL"){if(i)switch(i){case"cn":case"cn1":case"cn2":c>10&&(c%10==0||c>10&&c<20)?r=2:c>20&&(r=3);break;case"num2":c>9&&(r=2)}t.className="list-"+o[i]+c+" list-"+i+"-paddingleft-"+r}else t.className="list-"+o[i]+" list-"+i+"-paddingleft";else t.className=t.className.replace(/list-[\w\-]+/gi,"");u=t.getAttribute("class");u===null||u.replace(/\s/g,"")||n.removeAttributes(t,"class")}}),r||s(f,f.tagName.toLowerCase(),e(f)||n.getStyle(f,"list-style-type"),!0))})}function s(t,i,r,u){var f=t.nextSibling,o;f&&f.nodeType==1&&f.tagName.toLowerCase()==i&&(e(f)||n.getStyle(f,"list-style-type")||(i=="ol"?"decimal":"disc"))==r&&(n.moveChild(f,t),f.childNodes.length==0&&n.remove(f));f&&n.isFillChar(f)&&n.remove(f);o=t.previousSibling;o&&o.nodeType==1&&o.tagName.toLowerCase()==i&&(e(o)||n.getStyle(o,"list-style-type")||(i=="ol"?"decimal":"disc"))==r&&n.moveChild(t,o);o&&n.isFillChar(o)&&n.remove(o);!u&&n.isEmptyBlock(t)&&n.remove(t);e(t)&&p(t.ownerDocument,!0)}function h(t,i){o[i]&&(t.className="custom_"+i);try{n.setStyle(t,"list-style-type",i)}catch(r){}}function a(t){var i=t.previousSibling;i&&n.isEmptyBlock(i)&&n.remove(i);i=t.nextSibling;i&&n.isEmptyBlock(i)&&n.remove(i)}function w(t){while(t&&!n.isBody(t)){if(t.nodeName=="TABLE")return null;if(t.nodeName=="LI")return t;t=t.parentNode}}var i=this,v={TD:1,PRE:1,BLOCKQUOTE:1},o={cn:"cn-1-",cn1:"cn-2-",cn2:"cn-3-",num:"num-1-",num1:"num-2-",num2:"num-3-",dash:"dash",dot:"dot"},u,l,c;i.setOpt({autoTransWordToList:!1,insertorderedlist:{num:"",num1:"",num2:"",cn:"",cn1:"",cn2:"",decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:"",dash:"",dot:""},listDefaultPaddingLeft:"30",listiconpath:"http://bs.baidu.com/listicon/",maxListLevel:-1,disablePInList:!1});u={OL:y(i.options.insertorderedlist),UL:y(i.options.insertunorderedlist)};l=i.options.listiconpath;for(c in o)i.options.insertorderedlist.hasOwnProperty(c)||i.options.insertunorderedlist.hasOwnProperty(c)||delete o[c];i.ready(function(){var u=[],n,f;for(n in o){if(n=="dash"||n=="dot")u.push("li.list-"+o[n]+"{background-image:url("+l+o[n]+".gif)}"),u.push("ul.custom_"+n+"{list-style:none;}ul.custom_"+n+" li{background-position:0 3px;background-repeat:no-repeat}");else{for(f=0;f<99;f++)u.push("li.list-"+o[n]+f+"{background-image:url("+l+"list-"+o[n]+f+".gif)}");u.push("ol.custom_"+n+"{list-style:none;}ol.custom_"+n+" li{background-position:0 3px;background-repeat:no-repeat}")}switch(n){case"cn":u.push("li.list-"+n+"-paddingleft-1{padding-left:25px}");u.push("li.list-"+n+"-paddingleft-2{padding-left:40px}");u.push("li.list-"+n+"-paddingleft-3{padding-left:55px}");break;case"cn1":u.push("li.list-"+n+"-paddingleft-1{padding-left:30px}");u.push("li.list-"+n+"-paddingleft-2{padding-left:40px}");u.push("li.list-"+n+"-paddingleft-3{padding-left:55px}");break;case"cn2":u.push("li.list-"+n+"-paddingleft-1{padding-left:40px}");u.push("li.list-"+n+"-paddingleft-2{padding-left:55px}");u.push("li.list-"+n+"-paddingleft-3{padding-left:68px}");break;case"num":case"num1":u.push("li.list-"+n+"-paddingleft-1{padding-left:25px}");break;case"num2":u.push("li.list-"+n+"-paddingleft-1{padding-left:35px}");u.push("li.list-"+n+"-paddingleft-2{padding-left:40px}");break;case"dash":u.push("li.list-"+n+"-paddingleft{padding-left:35px}");break;case"dot":u.push("li.list-"+n+"-paddingleft{padding-left:20px}")}}u.push(".list-paddingleft-1{padding-left:0}");u.push(".list-paddingleft-2{padding-left:"+i.options.listDefaultPaddingLeft+"px}");u.push(".list-paddingleft-3{padding-left:"+i.options.listDefaultPaddingLeft*2+"px}");t.cssRule("list","ol,ul{margin:0;pading:0;"+(r.ie?"":"width:95%")+"}li{clear:both;}"+u.join("\n"),i.document)});i.ready(function(){n.on(i.body,"cut",function(){setTimeout(function(){var t=i.selection.getRange(),u,r,f,e;t.collapsed||(u=n.findParentByTagName(t.startContainer,"li",!0))&&!u.nextSibling&&n.isEmptyBlock(u)&&(r=u.parentNode,(f=r.previousSibling)?(n.remove(r),t.setStartAtLast(f).collapse(!0),t.select(!0)):(f=r.nextSibling)?(n.remove(r),t.setStartAtFirst(f).collapse(!0),t.select(!0)):(e=i.document.createElement("p"),n.fillNode(i.document,e),r.parentNode.insertBefore(e,r),n.remove(r),t.setStart(e,0).collapse(!0),t.select(!0)))})})});i.addListener("beforepaste",function(i,r){var l=this,a=l.selection.getRange(),h,s=UE.htmlparser(r.html,!0),f,c;(h=n.findParentByTagName(a.startContainer,"li",!0))&&(f=h.parentNode,c=f.tagName=="OL"?"ul":"ol",t.each(s.getNodesByTagName(c),function(n){var h,r,c;n.tagName=f.tagName;n.setAttr();n.parentNode===s?i=e(f)||(f.tagName=="OL"?"decimal":"disc"):(h=n.parentNode.getAttr("class"),i=h&&/custom_/.test(h)?h.match(/custom_(\w+)/)[1]:n.parentNode.getStyle("list-style-type"),i||(i=f.tagName=="OL"?"decimal":"disc"));r=t.indexOf(u[f.tagName],i);n.parentNode!==s&&(r=r+1==u[f.tagName].length?0:r+1);c=u[f.tagName][r];o[c]?n.setAttr("class","custom_"+c):n.setStyle("list-style-type",c)}));r.html=s.toHtml()});i.getOpt("disablePInList")===!0&&i.addOutputRule(function(n){t.each(n.getNodesByTagName("li"),function(n){var i=[],r=0;t.each(n.children,function(t){var u,f;if(t.tagName=="p"){while(u=t.children.pop())i.splice(r,0,u),u.parentNode=n,lastNode=u;u=i[i.length-1];u&&u.type=="element"&&u.tagName=="br"||(f=UE.uNode.createElement("br"),f.parentNode=n,i.push(f));r=i.length}});i.length&&(n.children=i)})});i.addInputRule(function(n){if(t.each(n.getNodesByTagName("li"),function(n){for(var o,u,t=UE.uNode.createElement("p"),e=0,i;i=n.children[e];)i.type=="text"||f.p[i.tagName]?t.appendChild(i):t.firstChild()?(n.insertBefore(t,i),t=UE.uNode.createElement("p"),e=e+2):e++;(!t.firstChild()||t.parentNode)&&n.firstChild()||n.appendChild(t);t.firstChild()||t.innerHTML(r.ie?"&nbsp;":"<br/>");o=n.firstChild();u=o.lastChild();u&&u.type=="text"&&/^\s*$/.test(u.data)&&o.removeChild(u)}),i.options.autoTransWordToList){var u={num1:/^\d+\)/,decimal:/^\d+\./,"lower-alpha":/^[a-z]+\)/,"upper-alpha":/^[A-Z]+\./,cn:/^[\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+[\u3001]/,cn2:/^\([\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+\)/},e={square:"n"};function s(n,t){var r=t.firstChild(),i;if(r&&r.type=="element"&&r.tagName=="span"&&/Wingdings|Symbol/.test(r.getStyle("font-family"))){for(i in e)if(e[i]==r.data)return i;return"disc"}for(i in u)if(u[i].test(n))return i}t.each(n.getNodesByTagName("p"),function(n){function l(n,t,i){var f,e;n.tagName=="ol"?r.ie?(f=t.firstChild(),f.type=="element"&&f.tagName=="span"&&u[i].test(f.innerText())&&t.removeChild(f)):t.innerHTML(t.innerHTML().replace(u[i],"")):t.removeChild(t.firstChild());e=UE.uNode.createElement("li");e.appendChild(t);n.appendChild(e)}var h,e,c,t,f;if(n.getAttr("class")=="MsoListParagraph"){if(n.setStyle("margin",""),n.setStyle("margin-left",""),n.setAttr("class",""),h=n,c=n,n.parentNode.tagName!="li"&&(e=s(n.innerText(),n))){for(t=UE.uNode.createElement(i.options.insertorderedlist.hasOwnProperty(e)?"ol":"ul"),o[e]?t.setAttr("class","custom_"+e):t.setStyle("list-style-type",e);n&&n.parentNode.tagName!="li"&&s(n.innerText(),n);)h=n.nextSibling(),h||n.parentNode.insertBefore(t,n),l(t,n,e),n=h;!t.parentNode&&n&&n.parentNode&&n.parentNode.insertBefore(t,n)}f=c.firstChild();f&&f.type=="element"&&f.tagName=="span"&&/^\s*(&nbsp;)+\s*$/.test(f.innerText())&&f.parentNode.removeChild(f)}})}});i.addListener("contentchange",function(){p(i.document)});i.addListener("keydown",function(t,r){function d(){r.preventDefault?r.preventDefault():r.returnValue=!1;i.fireEvent("contentchange");i.undoManger&&i.undoManger.save()}function it(t,i){while(t&&!n.isBody(t)){if(i(t))return null;if(t.nodeType==1&&/[ou]l/i.test(t.tagName))return t;t=t.parentNode}return null}var g=r.keyCode||r.which,tt,y,u,c,v,k,s,h,o,p;if(g==13&&!r.shiftKey){var nt=i.selection.getRange(),w=n.findParent(nt.startContainer,function(t){return n.isBlockElm(t)},!0),u=n.findParentByTagName(nt.startContainer,"li",!0);w&&w.tagName!="PRE"&&!u&&(tt=w.innerHTML.replace(new RegExp(n.fillChar,"g"),""),/^\s*1\s*\.[^\d]/.test(tt)&&(w.innerHTML=tt.replace(/^\s*1\s*\./,""),nt.setStartAtLast(w).collapse(!0).select(),i.__hasEnterExecCommand=!0,i.execCommand("insertorderedlist"),i.__hasEnterExecCommand=!1));var e=i.selection.getRange(),l=it(e.startContainer,function(n){return n.tagName=="TABLE"}),b=e.collapsed?l:it(e.endContainer,function(n){return n.tagName=="TABLE"});if(l&&b&&l===b){if(!e.collapsed)if(l=n.findParentByTagName(e.startContainer,"li",!0),b=n.findParentByTagName(e.endContainer,"li",!0),l&&b&&l===b){if(e.deleteContents(),u=n.findParentByTagName(e.startContainer,"li",!0),u&&n.isEmptyBlock(u)){s=u.previousSibling;next=u.nextSibling;h=i.document.createElement("p");n.fillNode(i.document,h);o=u.parentNode;s&&next?(e.setStart(next,0).collapse(!0).select(!0),n.remove(u)):((s||next)&&s?u.parentNode.parentNode.insertBefore(h,o.nextSibling):o.parentNode.insertBefore(h,o),n.remove(u),o.firstChild||n.remove(o),e.setStart(h,0).setCursor());d();return}}else{y=e.cloneRange();p=y.collapse(!1).createBookmark();e.deleteContents();y.moveToBookmark(p);u=n.findParentByTagName(y.startContainer,"li",!0);a(u);y.select();d();return}if(u=n.findParentByTagName(e.startContainer,"li",!0),u){if(n.isEmptyBlock(u)){if(p=e.createBookmark(),o=u.parentNode,u!==o.lastChild?(n.breakParent(u,o),a(u)):(o.parentNode.insertBefore(u,o.nextSibling),n.isEmptyNode(o)&&n.remove(o)),!f.$list[u.parentNode.tagName])if(n.isBlockElm(u.firstChild))n.remove(u,!0);else{for(h=i.document.createElement("p"),u.parentNode.insertBefore(h,u);u.firstChild;)h.appendChild(u.firstChild);n.remove(u)}e.moveToBookmark(p).select()}else{if(c=u.firstChild,!c||!n.isBlockElm(c)){for(h=i.document.createElement("p"),u.firstChild||n.fillNode(i.document,h);u.firstChild;)h.appendChild(u.firstChild);u.appendChild(h);c=h}v=i.document.createElement("span");e.insertNode(v);n.breakParent(v,u);k=v.nextSibling;c=k.firstChild;c||(h=i.document.createElement("p"),n.fillNode(i.document,h),k.appendChild(h),c=h);n.isEmptyNode(c)&&(c.innerHTML="",n.fillNode(i.document,c));e.setStart(c,0).collapse(!0).shrinkBoundary().select();n.remove(v);s=k.previousSibling;s&&n.isEmptyBlock(s)&&(s.innerHTML="<p><\/p>",n.fillNode(i.document,s.firstChild))}d()}}}if(g==8&&(e=i.selection.getRange(),e.collapsed&&n.isStartInblock(e)&&(y=e.cloneRange().trimBoundary(),u=n.findParentByTagName(e.startContainer,"li",!0),u&&n.isStartInblock(y)))){if(l=n.findParentByTagName(e.startContainer,"p",!0),l&&l!==u.firstChild){o=n.findParentByTagName(l,["ol","ul"]);n.breakParent(l,o);a(l);i.fireEvent("contentchange");e.setStart(l,0).setCursor(!1,!0);i.fireEvent("saveScene");n.preventDefault(r);return}if(u&&(s=u.previousSibling)){if(g==46&&u.childNodes.length)return;if(f.$list[s.tagName]&&(s=s.lastChild),i.undoManger&&i.undoManger.save(),c=u.firstChild,n.isBlockElm(c))if(n.isEmptyNode(c))for(s.appendChild(c),e.setStart(c,0).setCursor(!1,!0);u.firstChild;)s.appendChild(u.firstChild);else v=i.document.createElement("span"),e.insertNode(v),n.isEmptyBlock(s)&&(s.innerHTML=""),n.moveChild(u,s),e.setStartBefore(v).collapse(!0).select(!0),n.remove(v);else if(n.isEmptyNode(u))h=i.document.createElement("p"),s.appendChild(h),e.setStart(h,0).setCursor();else for(e.setEnd(s,s.childNodes.length).collapse().select(!0);u.firstChild;)s.appendChild(u.firstChild);n.remove(u);i.fireEvent("contentchange");i.fireEvent("saveScene");n.preventDefault(r);return}if(u&&!u.previousSibling){if(o=u.parentNode,p=e.createBookmark(),n.isTagNode(o.parentNode,"ol ul"))o.parentNode.insertBefore(u,o),n.isEmptyNode(o)&&n.remove(o);else{while(u.firstChild)o.parentNode.insertBefore(u.firstChild,o);n.remove(u);n.isEmptyNode(o)&&n.remove(o)}e.moveToBookmark(p).setCursor(!1,!0);i.fireEvent("contentchange");i.fireEvent("saveScene");n.preventDefault(r);return}}});i.addListener("keyup",function(t,r){var o=r.keyCode||r.which,f,u;o==8&&(f=i.selection.getRange(),(u=n.findParentByTagName(f.startContainer,["ol","ul"],!0))&&s(u,u.tagName.toLowerCase(),e(u)||n.getComputedStyle(u,"list-style-type"),!0))});i.addListener("tabkeydown",function(){function b(n){if(i.options.maxListLevel!=-1){for(var t=n.parentNode,r=0;/[ou]l/i.test(t.tagName);)r++,t=t.parentNode;if(r>=i.options.maxListLevel)return!0}}var l=i.selection.getRange(),r=n.findParentByTagName(l.startContainer,"li",!0),a,y,k,p,d,w,o;if(r)if(l.collapsed){if(b(r))return!0;var c=r.parentNode,f=i.document.createElement(c.tagName),v=t.indexOf(u[f.tagName],e(c)||n.getComputedStyle(c,"list-style-type"));if(v=v+1==u[f.tagName].length?0:v+1,y=u[f.tagName][v],h(f,y),n.isStartInblock(l))return i.fireEvent("saveScene"),a=l.createBookmark(),c.insertBefore(f,r),f.appendChild(r),s(f,f.tagName.toLowerCase(),y),i.fireEvent("contentchange"),l.moveToBookmark(a).select(!0),!0}else{for(i.fireEvent("saveScene"),a=l.createBookmark(),k=0,d=n.findParents(r);w=d[k++];)if(n.isTagNode(w,"ol ul")){p=w;break}if(o=r,a.end)while(o&&!(n.getPosition(o,a.end)&n.POSITION_FOLLOWING)){if(b(o)){o=n.getNextDomNode(o,!1,null,function(n){return n!==p});continue}var c=o.parentNode,f=i.document.createElement(c.tagName),v=t.indexOf(u[f.tagName],e(c)||n.getComputedStyle(c,"list-style-type")),g=v+1==u[f.tagName].length?0:v+1,y=u[f.tagName][g];for(h(f,y),c.insertBefore(f,o);o&&!(n.getPosition(o,a.end)&n.POSITION_FOLLOWING);){if(r=o.nextSibling,f.appendChild(o),!r||n.isTagNode(r,"ol ul")){if(r){while(r=r.firstChild)if(r.tagName=="LI")break}else r=n.getNextDomNode(o,!1,null,function(n){return n!==p});break}o=r}s(f,f.tagName.toLowerCase(),y);o=r}return i.fireEvent("contentchange"),l.moveToBookmark(a).select(),!0}});i.commands.insertorderedlist=i.commands.insertunorderedlist={execCommand:function(t,i){var ut,pt,ht,tt,ft,et,lt,it,k,ct,g,bt;i||(i=t.toLowerCase()=="insertorderedlist"?"decimal":"disc");var c=this,a=this.selection.getRange(),rt=function(t){return t.nodeType==1?t.tagName.toLowerCase()!="br":!n.isWhitespace(t)},ot=t.toLowerCase()=="insertorderedlist"?"ol":"ul",l=c.document.createDocumentFragment();a.adjustmentBoundary().shrinkBoundary();var nt=a.createBookmark(!0),r=w(c.document.getElementById(nt.start)),vt=0,y=w(c.document.getElementById(nt.end)),yt=0,p,d,b,u;if(r||y){if(r&&(p=r.parentNode),nt.end||(y=r),y&&(d=y.parentNode),p===d){while(r!==y){if(u=r,r=r.nextSibling,!n.isBlockElm(u.firstChild)){for(ut=c.document.createElement("p");u.firstChild;)ut.appendChild(u.firstChild);u.appendChild(ut)}l.appendChild(u)}if(u=c.document.createElement("span"),p.insertBefore(u,y),!n.isBlockElm(y.firstChild)){for(ut=c.document.createElement("p");y.firstChild;)ut.appendChild(y.firstChild);y.appendChild(ut)}if(l.appendChild(y),n.breakParent(u,p),n.isEmptyNode(u.previousSibling)&&n.remove(u.previousSibling),n.isEmptyNode(u.nextSibling)&&n.remove(u.nextSibling),pt=e(p)||n.getComputedStyle(p,"list-style-type")||(t.toLowerCase()=="insertorderedlist"?"decimal":"disc"),p.tagName.toLowerCase()==ot&&pt==i){for(ct=0,ht=c.document.createDocumentFragment();g=l.firstChild;)if(n.isTagNode(g,"ol ul"))ht.appendChild(g);else while(g.firstChild)ht.appendChild(g.firstChild),n.remove(g);u.parentNode.insertBefore(ht,u)}else b=c.document.createElement(ot),h(b,i),b.appendChild(l),u.parentNode.insertBefore(b,u);n.remove(u);b&&s(b,ot,i);a.moveToBookmark(nt).select();return}if(r){while(r){if(u=r.nextSibling,n.isTagNode(r,"ol ul"))l.appendChild(r);else{for(tt=c.document.createDocumentFragment(),ft=0;r.firstChild;)n.isBlockElm(r.firstChild)&&(ft=1),tt.appendChild(r.firstChild);ft?l.appendChild(tt):(et=c.document.createElement("p"),et.appendChild(tt),l.appendChild(et));n.remove(r)}r=u}p.parentNode.insertBefore(l,p.nextSibling);n.isEmptyNode(p)?(a.setStartBefore(p),n.remove(p)):a.setStartAfter(p);vt=1}if(y&&n.inDoc(d,c.document)){for(r=d.firstChild;r&&r!==y;){if(u=r.nextSibling,n.isTagNode(r,"ol ul"))l.appendChild(r);else{for(tt=c.document.createDocumentFragment(),ft=0;r.firstChild;)n.isBlockElm(r.firstChild)&&(ft=1),tt.appendChild(r.firstChild);ft?l.appendChild(tt):(et=c.document.createElement("p"),et.appendChild(tt),l.appendChild(et));n.remove(r)}r=u}lt=n.createElement(c.document,"div",{tmpDiv:1});n.moveChild(y,lt);l.appendChild(lt);n.remove(y);d.parentNode.insertBefore(l,d);a.setEndBefore(d);n.isEmptyNode(d)&&n.remove(d);yt=1}}vt||a.setStartBefore(c.document.getElementById(nt.start));nt.end&&!yt&&a.setEndAfter(c.document.getElementById(nt.end));a.enlarge(!0,function(n){return v[n.tagName]});l=c.document.createDocumentFragment();for(var st=a.createBookmark(),o=n.getNextDomNode(st.start,!1,rt),at=a.cloneRange(),k,wt=n.isBlockElm;o&&o!==st.end&&n.getPosition(o,st.end)&n.POSITION_PRECEDING;)if(o.nodeType==3||f.li[o.tagName]){if(o.nodeType==1&&f.$list[o.tagName]){while(o.firstChild)l.appendChild(o.firstChild);k=n.getNextDomNode(o,!1,rt);n.remove(o);o=k;continue}for(k=o,at.setStartBefore(o);o&&o!==st.end&&(!wt(o)||n.isBookmarkNode(o));)k=o,o=n.getNextDomNode(o,!1,null,function(n){return!v[n.tagName]});if(o&&wt(o)&&(u=n.getNextDomNode(k,!1,rt),u&&n.isBookmarkNode(u)&&(o=n.getNextDomNode(u,!1,rt),k=u)),at.setEndAfter(k),o=n.getNextDomNode(k,!1,rt),it=a.document.createElement("li"),it.appendChild(at.extractContents()),n.isEmptyNode(it)){for(k=a.document.createElement("p");it.firstChild;)k.appendChild(it.firstChild);it.appendChild(k)}l.appendChild(it)}else o=n.getNextDomNode(o,!0,rt);for(a.moveToBookmark(st).collapse(!0),b=c.document.createElement(ot),h(b,i),b.appendChild(l),a.insertNode(b),s(b,ot,i),ct=0,bt=n.getElementsByTagName(b,"div");g=bt[ct++];)g.getAttribute("tmpDiv")&&n.remove(g,!0);a.moveToBookmark(nt).select()},queryCommandState:function(n){for(var i=n.toLowerCase()=="insertorderedlist"?"ol":"ul",r=this.selection.getStartElementPath(),u=0,t;t=r[u++];){if(t.nodeName=="TABLE")return 0;if(i==t.nodeName.toLowerCase())return 1}return 0},queryCommandValue:function(t){for(var u=t.toLowerCase()=="insertorderedlist"?"ol":"ul",f=this.selection.getStartElementPath(),i,o=0,r;r=f[o++];){if(r.nodeName=="TABLE"){i=null;break}if(u==r.nodeName.toLowerCase()){i=r;break}}return i?e(i)||n.getComputedStyle(i,"list-style-type"):null}}},function(){var i={textarea:function(n,t){var i=t.ownerDocument.createElement("textarea");return i.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;",r.ie&&r.version<8&&(i.style.width=t.offsetWidth+"px",i.style.height=t.offsetHeight+"px",t.onresize=function(){i.style.width=t.offsetWidth+"px";i.style.height=t.offsetHeight+"px"}),t.appendChild(i),{setContent:function(n){i.value=n},getContent:function(){return i.value},select:function(){var n;r.ie?(n=i.createTextRange(),n.collapse(!0),n.select()):(i.setSelectionRange(0,0),i.focus())},dispose:function(){t.removeChild(i);t.onresize=null;i=null;t=null}}},codemirror:function(n,t){var i=window.CodeMirror(t,{mode:"text/html",tabMode:"indent",lineNumbers:!0,lineWrapping:!0}),r=i.getWrapperElement();return r.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;',i.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;",i.refresh(),{getCodeMirror:function(){return i},setContent:function(n){i.setValue(n)},getContent:function(){return i.getValue()},select:function(){i.focus()},dispose:function(){t.removeChild(r);r=null;i=null}}}};UE.plugins.source=function(){function y(n){return i[e.sourceEditor=="codemirror"&&window.CodeMirror?"codemirror":"textarea"](u,n)}var u=this,e=this.options,s=!1,o,c,l,a,h,v;e.sourceEditor=r.ie?"textarea":e.sourceEditor||"codemirror";u.setOpt({sourceEditorFirst:!1});u.commands.source={execCommand:function(){var i,p,e,v,t;if(s=!s,s)h=u.selection.getRange().createAddress(!1,!0),u.undoManger&&u.undoManger.save(!0),r.gecko&&(u.body.contentEditable=!1),l=u.iframe.style.cssText,u.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;",u.fireEvent("beforegetcontent"),i=UE.htmlparser(u.body.innerHTML),u.filterOutputRule(i),i.traversal(function(n){if(n.type=="element")switch(n.tagName){case"td":case"th":case"caption":n.children&&n.children.length==1&&n.firstChild().tagName=="br"&&n.removeChild(n.firstChild());break;case"pre":n.innerText(n.innerText().replace(/&nbsp;/g," "))}}),u.fireEvent("aftergetcontent"),p=i.toHtml(!0),o=y(u.iframe.parentNode),o.setContent(p),c=u.setContent,u.setContent=function(n){var t=UE.htmlparser(n);u.filterInputRule(t);n=t.toHtml();o.setContent(n)},setTimeout(function(){o.select();u.addListener("fullscreenchanged",function(){try{o.getCodeMirror().refresh()}catch(n){}})}),a=u.getContent,u.getContent=function(){return o.getContent()||"<p>"+(r.ie?"":"<br/>")+"<\/p>"};else if(u.iframe.style.cssText=l,e=o.getContent()||"<p>"+(r.ie?"":"<br/>")+"<\/p>",e=e.replace(new RegExp("[\\r\\t\\n ]*<\/?(\\w+)\\s*(?:[^>]*)>","g"),function(n,t){return t&&!f.$inlineWithA[t.toLowerCase()]?n.replace(/(^[\n\r\t ]*)|([\n\r\t ]*$)/g,""):n.replace(/(^[\n\r\t]*)|([\n\r\t]*$)/g,"")}),u.setContent=c,u.setContent(e),o.dispose(),o=null,u.getContent=a,v=u.body.firstChild,v||(u.body.innerHTML="<p>"+(r.ie?"":"<br/>")+"<\/p>",v=u.body.firstChild),u.undoManger&&u.undoManger.save(!0),r.gecko)t=document.createElement("input"),t.style.cssText="position:absolute;left:0;top:-32768px",document.body.appendChild(t),u.body.contentEditable=!1,setTimeout(function(){n.setViewportOffset(t,{left:-32768,top:0});t.focus();setTimeout(function(){u.body.contentEditable=!0;u.selection.getRange().moveToAddress(h).select(!0);n.remove(t)})});else try{u.selection.getRange().moveToAddress(h).select(!0)}catch(w){}this.fireEvent("sourcemodechanged",s)},queryCommandState:function(){return s|0},notNeedUndo:1};v=u.queryCommandState;u.queryCommandState=function(n){return(n=n.toLowerCase(),s)?n in{source:1,fullscreen:1}?1:-1:v.apply(this,arguments)};e.sourceEditor=="codemirror"&&u.addListener("ready",function(){t.loadFile(document,{src:e.codeMirrorJsUrl||e.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.js",tag:"script",type:"text/javascript",defer:"defer"},function(){e.sourceEditorFirst&&setTimeout(function(){u.execCommand("source")},0)});t.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:e.codeMirrorCssUrl||e.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.css"})})}}();UE.plugins.enterkey=function(){var i,t=this,u=t.options.enterTag;t.addListener("keyup",function(u,f){var v=f.keyCode||f.which,o,h,c,a,s,e,l;if(v==13)if(o=t.selection.getRange(),h=o.startContainer,r.ie)t.fireEvent("saveScene",!0,!0);else{if(/h\d/i.test(i)){if(r.gecko)a=n.findParentByTagName(h,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],!0),a||(t.document.execCommand("formatBlock",!1,"<p>"),c=1);else if(h.nodeType==1){if(s=t.document.createTextNode(""),o.insertNode(s),e=n.findParentByTagName(s,"div",!0),e){for(l=t.document.createElement("p");e.firstChild;)l.appendChild(e.firstChild);e.parentNode.insertBefore(l,e);n.remove(e);o.setStartBefore(s).setCursor();c=1}n.remove(s)}t.undoManger&&c&&t.undoManger.save()}r.opera&&o.select()}});t.addListener("keydown",function(e,o){var y=o.keyCode||o.which,s,c,v;if(y==13){if(t.fireEvent("beforeenterkeydown")){n.preventDefault(o);return}if(t.fireEvent("saveScene",!0,!0),i="",s=t.selection.getRange(),!s.collapsed){var h=s.startContainer,p=s.endContainer,l=n.findParentByTagName(h,"td",!0),a=n.findParentByTagName(p,"td",!0);if(l&&a&&l!==a||!l&&a||l&&!a){o.preventDefault?o.preventDefault():o.returnValue=!1;return}}if(u=="p")r.ie||(h=n.findParentByTagName(s.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],!0),h||r.opera?(i=h.tagName,h.tagName.toLowerCase()=="p"&&r.gecko&&n.removeDirtyAttr(h)):(t.document.execCommand("formatBlock",!1,"<p>"),r.gecko&&(s=t.selection.getRange(),h=n.findParentByTagName(s.startContainer,"p",!0),h&&n.removeDirtyAttr(h))));else if(o.preventDefault?o.preventDefault():o.returnValue=!1,s.collapsed)c=s.document.createElement("br"),s.insertNode(c),v=c.parentNode,v.lastChild===c?(c.parentNode.insertBefore(c.cloneNode(!0),c),s.setStartBefore(c)):s.setStartAfter(c),s.setCursor();else if(s.deleteContents(),h=s.startContainer,h.nodeType==1&&(h=h.childNodes[s.startOffset])){while(h.nodeType==1){if(f.$empty[h.tagName])return s.setStartBefore(h).setCursor(),t.undoManger&&t.undoManger.save(),!1;if(!h.firstChild)return c=s.document.createElement("br"),h.appendChild(c),s.setStart(h,0).setCursor(),t.undoManger&&t.undoManger.save(),!1;h=h.firstChild}h===s.startContainer.childNodes[s.startOffset]?(c=s.document.createElement("br"),s.insertNode(c).setCursor()):s.setStart(h,0).setCursor()}else c=s.document.createElement("br"),s.insertNode(c).setStartAfter(c).setCursor()}})};UE.plugins.keystrokes=function(){var t=this,i=!0;t.addListener("keydown",function(u,f){var c=f.keyCode||f.which,e=t.selection.getRange(),s,o,l,k,h,p,w,nt,b,v,y;if(!e.collapsed&&!(f.ctrlKey||f.shiftKey||f.altKey||f.metaKey)&&(c>=65&&c<=90||c>=48&&c<=57||c>=96&&c<=111||{13:1,8:1,46:1}[c])&&(s=e.startContainer,n.isFillChar(s)&&e.setStartBefore(s),s=e.endContainer,n.isFillChar(s)&&e.setEndAfter(s),e.txtToElmBoundary(),e.endContainer&&e.endContainer.nodeType==1&&(s=e.endContainer.childNodes[e.endOffset],s&&n.isBr(s)&&e.setEndAfter(s)),e.startOffset==0&&(s=e.startContainer,n.isBoundaryNode(s,"firstChild")&&(s=e.endContainer,e.endOffset==(s.nodeType==3?s.nodeValue.length:s.childNodes.length)&&n.isBoundaryNode(s,"lastChild"))))){t.fireEvent("saveScene");t.body.innerHTML="<p>"+(r.ie?"":"<br/>")+"<\/p>";e.setStart(t.body.firstChild,0).setCursor(!1,!0);t._selectionChange();return}if(c==a.Backspace){if(e=t.selection.getRange(),i=e.collapsed,t.fireEvent("delkeydown",f))return;if(e.collapsed&&e.inFillChar()&&(o=e.startContainer,n.isFillChar(o)?(e.setStartBefore(o).shrinkBoundary(!0).collapse(!0),n.remove(o)):(o.nodeValue=o.nodeValue.replace(new RegExp("^"+n.fillChar),""),e.startOffset--,e.collapse(!0).select(!0))),o=e.getClosedNode()){t.fireEvent("saveScene");e.setStartBefore(o);n.remove(o);e.setCursor();t.fireEvent("saveScene");n.preventDefault(f);return}if(!r.ie&&(o=n.findParentByTagName(e.startContainer,"table",!0),l=n.findParentByTagName(e.endContainer,"table",!0),o&&!l||!o&&l||o!==l)){f.preventDefault();return}}if(c==a.Tab){if(k={ol:1,ul:1,table:1},t.fireEvent("tabkeydown",f)){n.preventDefault(f);return}h=t.selection.getRange();t.fireEvent("saveScene");for(var d=0,g="",tt=t.options.tabSize||4,it=t.options.tabNode||"&nbsp;";d<tt;d++)g+=it;if(p=t.document.createElement("span"),p.innerHTML=g+n.fillChar,h.collapsed)h.insertNode(p.cloneNode(!0).firstChild).setCursor(!0);else if(w=function(t){return n.isBlockElm(t)&&!k[t.tagName.toLowerCase()]},o=n.findParent(h.startContainer,w,!0),l=n.findParent(h.endContainer,w,!0),o&&l&&o===l)h.deleteContents(),h.insertNode(p.cloneNode(!0).firstChild).setCursor(!0);else{for(nt=h.createBookmark(),h.enlarge(!0),b=h.createBookmark(),v=n.getNextDomNode(b.start,!1,w);v&&!(n.getPosition(v,b.end)&n.POSITION_FOLLOWING);)v.insertBefore(p.cloneNode(!0).firstChild,v.firstChild),v=n.getNextDomNode(v,!1,w);h.moveToBookmark(b).moveToBookmark(nt).select()}n.preventDefault(f)}if(r.gecko&&c==46&&(h=t.selection.getRange(),h.collapsed&&(o=h.startContainer,n.isEmptyBlock(o)))){for(y=o.parentNode;n.getChildCount(y)==1&&!n.isBody(y);)o=y,y=y.parentNode;o===y.lastChild&&f.preventDefault();return}});t.addListener("keyup",function(t,u){var v=u.keyCode||u.which,f,c=this,l,o,s,e,h;if(v==a.Backspace){if(c.fireEvent("delkeyup"))return;if(f=c.selection.getRange(),f.collapsed){if(l=["h1","h2","h3","h4","h5","h6"],(e=n.findParentByTagName(f.startContainer,l,!0))&&n.isEmptyBlock(e)){if(o=e.previousSibling,o&&o.nodeName!="TABLE"){n.remove(e);f.setStartAtLast(o).setCursor(!1,!0);return}if(s=e.nextSibling,s&&s.nodeName!="TABLE"){n.remove(e);f.setStartAtFirst(s).setCursor(!1,!0);return}}n.isBody(f.startContainer)&&(e=n.createElement(c.document,"p",{innerHTML:r.ie?n.fillChar:"<br/>"}),f.insertNode(e).setStart(e,0).setCursor(!1,!0))}!i&&(f.startContainer.nodeType==3||f.startContainer.nodeType==1&&n.isEmptyBlock(f.startContainer))&&(r.ie?(h=f.document.createElement("span"),f.insertNode(h).setStartBefore(h).collapse(!0),f.select(),n.remove(h)):f.select())}})};UE.plugins.fiximgclick=function(){function f(){this.editor=null;this.resizer=null;this.cover=null;this.doc=document;this.prePos={x:0,y:0};this.startPos={x:0,y:0}}var u=!1;return function(){var r=[[0,0,-1,-1],[0,0,0,-1],[0,0,1,-1],[0,0,-1,0],[0,0,1,0],[0,0,-1,1],[0,0,0,1],[0,0,1,1]];f.prototype={init:function(t){var r=this;r.editor=t;r.startPos=this.prePos={x:0,y:0};r.dragId=-1;var e=[],f=r.cover=document.createElement("div"),u=r.resizer=document.createElement("div");f.id=r.editor.ui.id+"_imagescale_cover";f.style.cssText="position:absolute;display:none;z-index:"+r.editor.options.zIndex+";filter:alpha(opacity=0); opacity:0;background:#CCC;";n.on(f,"mousedown click",function(){r.hide()});for(i=0;i<8;i++)e.push('<span class="edui-editor-imagescale-hand'+i+'"><\/span>');u.id=r.editor.ui.id+"_imagescale";u.className="edui-editor-imagescale";u.innerHTML=e.join("");u.style.cssText+=";display:none;border:1px solid #3b77ff;z-index:"+r.editor.options.zIndex+";";r.editor.ui.getDom().appendChild(f);r.editor.ui.getDom().appendChild(u);r.initStyle();r.initEvents()},initStyle:function(){t.cssRule("imagescale",".edui-editor-imagescale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;}.edui-editor-imagescale span{position:absolute;width:6px;height:6px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}.edui-editor-imagescale .edui-editor-imagescale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}")},initEvents:function(){var n=this;n.startPos.x=n.startPos.y=0;n.isDraging=!1},_eventHandler:function(t){var i=this,r;switch(t.type){case"mousedown":if(r=t.target||t.srcElement,r.className.indexOf("edui-editor-imagescale-hand")!=-1&&i.dragId==-1){i.dragId=r.className.slice(-1);i.startPos.x=i.prePos.x=t.clientX;i.startPos.y=i.prePos.y=t.clientY;n.on(i.doc,"mousemove",i.proxy(i._eventHandler,i))}break;case"mousemove":i.dragId!=-1&&(i.updateContainerStyle(i.dragId,{x:t.clientX-i.prePos.x,y:t.clientY-i.prePos.y}),i.prePos.x=t.clientX,i.prePos.y=t.clientY,u=!0,i.updateTargetElement());break;case"mouseup":i.dragId!=-1&&(i.updateContainerStyle(i.dragId,{x:t.clientX-i.prePos.x,y:t.clientY-i.prePos.y}),i.updateTargetElement(),i.target.parentNode&&i.attachTo(i.target),i.dragId=-1);n.un(i.doc,"mousemove",i.proxy(i._eventHandler,i));u&&(u=!1,i.editor.fireEvent("contentchange"))}},updateTargetElement:function(){var t=this;n.setStyles(t.target,{width:t.resizer.style.width,height:t.resizer.style.height});t.target.width=parseInt(t.resizer.style.width);t.target.height=parseInt(t.resizer.style.height);t.attachTo(t.target)},updateContainerStyle:function(n,t){var f=this,i=f.resizer,u;r[n][0]!=0&&(u=parseInt(i.style.left)+t.x,i.style.left=f._validScaledProp("left",u)+"px");r[n][1]!=0&&(u=parseInt(i.style.top)+t.y,i.style.top=f._validScaledProp("top",u)+"px");r[n][2]!=0&&(u=i.clientWidth+r[n][2]*t.x,i.style.width=f._validScaledProp("width",u)+"px");r[n][3]!=0&&(u=i.clientHeight+r[n][3]*t.y,i.style.height=f._validScaledProp("height",u)+"px")},_validScaledProp:function(n,t){var i=this.resizer,r=document;t=isNaN(t)?0:t;switch(n){case"left":return t<0?0:t+i.clientWidth>r.clientWidth?r.clientWidth-i.clientWidth:t;case"top":return t<0?0:t+i.clientHeight>r.clientHeight?r.clientHeight-i.clientHeight:t;case"width":return t<=0?1:t+i.offsetLeft>r.clientWidth?r.clientWidth-i.offsetLeft:t;case"height":return t<=0?1:t+i.offsetTop>r.clientHeight?r.clientHeight-i.offsetTop:t}},hideCover:function(){this.cover.style.display="none"},showCover:function(){var t=this,i=n.getXY(t.editor.ui.getDom()),r=n.getXY(t.editor.iframe);n.setStyles(t.cover,{width:t.editor.iframe.offsetWidth+"px",height:t.editor.iframe.offsetHeight+"px",top:r.y-i.y+"px",left:r.x-i.x+"px",position:"absolute",display:""})},show:function(t){var i=this;i.resizer.style.display="block";t&&i.attachTo(t);n.on(this.resizer,"mousedown",i.proxy(i._eventHandler,i));n.on(i.doc,"mouseup",i.proxy(i._eventHandler,i));i.showCover();i.editor.fireEvent("afterscaleshow",i);i.editor.fireEvent("saveScene")},hide:function(){var t=this;t.hideCover();t.resizer.style.display="none";n.un(t.resizer,"mousedown",t.proxy(t._eventHandler,t));n.un(t.doc,"mouseup",t.proxy(t._eventHandler,t));t.editor.fireEvent("afterscalehide",t)},proxy:function(n,t){return function(){return n.apply(t||this,arguments)}},attachTo:function(t){var i=this,u=i.target=t,r=this.resizer,f=n.getXY(u),e=n.getXY(i.editor.iframe),o=n.getXY(r.parentNode);n.setStyles(r,{width:u.width+"px",height:u.height+"px",left:e.x+f.x-i.editor.document.body.scrollLeft-o.x-parseInt(r.style.borderLeftWidth)+"px",top:e.y+f.y-i.editor.document.body.scrollTop-o.y-parseInt(r.style.borderTopWidth)+"px"})}}}(),function(){var t=this,i;t.setOpt("imageScaleEnabled",!0);!r.ie&&t.options.imageScaleEnabled&&t.addListener("click",function(){var s=t.selection.getRange(),r=s.getClosedNode(),u,e,o;if(r&&r.tagName=="IMG"&&t.body.contentEditable!="false"){if(r.className.indexOf("edui-faked-music")!=-1||r.getAttribute("anchorname")||n.hasClass(r,"loadingclass")||n.hasClass(r,"loaderrorclass"))return;if(!i){i=new f;i.init(t);t.ui.getDom().appendChild(i.resizer);u=function(){i.hide();i.target&&t.selection.getRange().selectNode(i.target).select()};e=function(n){var t=n.target||n.srcElement;t&&(t.className===undefined||t.className.indexOf("edui-editor-imagescale")==-1)&&u(n)};t.addListener("afterscaleshow",function(){t.addListener("beforekeydown",u);t.addListener("beforemousedown",e);n.on(document,"keydown",u);n.on(document,"mousedown",e);t.selection.getNative().removeAllRanges()});t.addListener("afterscalehide",function(){t.removeListener("beforekeydown",u);t.removeListener("beforemousedown",e);n.un(document,"keydown",u);n.un(document,"mousedown",e);var r=i.target;r.parentNode&&t.selection.getRange().selectNode(r).select()});n.on(i.resizer,"mousedown",function(n){t.selection.getNative().removeAllRanges();var r=n.target||n.srcElement;r&&r.className.indexOf("edui-editor-imagescale-hand")==-1&&(o=setTimeout(function(){i.hide();i.target&&t.selection.getRange().selectNode(r).select()},200))});n.on(i.resizer,"mouseup",function(n){var t=n.target||n.srcElement;t&&t.className.indexOf("edui-editor-imagescale-hand")==-1&&clearTimeout(o)})}i.show(r)}else i&&i.resizer.style.display!="none"&&i.hide()});r.webkit&&t.addListener("click",function(n,i){if(i.target.tagName=="IMG"&&t.body.contentEditable!="false"){var r=new e.Range(t.document);r.selectNode(i.target).select()}})}}();UE.plugin.register("autolink",function(){var i=0;return r.ie?{}:{bindEvents:{reset:function(){i=0},keydown:function(i,r){var o=this,v=r.keyCode||r.which,f,e,a,s;if(v==32||v==13){for(var h=o.selection.getNative(),u=h.getRangeAt(0).cloneRange(),c,l,f=u.startContainer;f.nodeType==1&&u.startOffset>0;){if(f=u.startContainer.childNodes[u.startOffset-1],!f)break;u.setStart(f,f.nodeType==1?f.childNodes.length:f.nodeValue.length);u.collapse(!0);f=u.startContainer}do{if(u.startOffset==0){for(f=u.startContainer.previousSibling;f&&f.nodeType==1;)f=f.lastChild;if(!f||n.isFillChar(f))break;c=f.nodeValue.length}else f=u.startContainer,c=u.startOffset;u.setStart(f,c-1);l=u.toString().charCodeAt(0)}while(l!=160&&l!=32);if(u.toString().replace(new RegExp(n.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){while(u.toString().length){if(/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(u.toString()))break;try{u.setStart(u.startContainer,u.startOffset+1)}catch(y){for(f=u.startContainer;!(next=f.nextSibling);){if(n.isBody(f))return;f=f.parentNode}u.setStart(next,0)}}if(n.findParentByTagName(u.startContainer,"a",!0))return;e=o.document.createElement("a");a=o.document.createTextNode(" ");o.undoManger&&o.undoManger.save();e.appendChild(u.extractContents());e.href=e.innerHTML=e.innerHTML.replace(/<[^>]+>/g,"");s=e.getAttribute("href").replace(new RegExp(n.fillChar,"g"),"");s=/^(?:https?:\/\/)/ig.test(s)?s:"http://"+s;e.setAttribute("_src",t.html(s));e.href=t.html(s);u.insertNode(e);e.parentNode.insertBefore(a,e.nextSibling);u.setStart(a,0);u.collapse(!0);h.removeAllRanges();h.addRange(u);o.undoManger&&o.undoManger.save()}}}}}},function(){function i(t){if(t.nodeType==3)return null;if(t.nodeName=="A")return t;for(var i=t.lastChild;i;){if(i.nodeName=="A")return i;if(i.nodeType==3){if(n.isWhitespace(i)){i=i.previousSibling;continue}return null}i=i.lastChild}}var t={37:1,38:1,39:1,40:1,13:1,32:1};r.ie&&this.addListener("keyup",function(r,u){var c=this,s=u.keyCode,o,f,e,h;if(t[s])if(o=c.selection.getRange(),f=o.startContainer,s==13){while(f&&!n.isBody(f)&&!n.isBlockElm(f))f=f.parentNode;f&&!n.isBody(f)&&f.nodeName=="P"&&(e=f.previousSibling,e&&e.nodeType==1&&(e=i(e),e&&!e.getAttribute("_href")&&n.remove(e,!0)))}else s==32?f.nodeType==3&&/^\s$/.test(f.nodeValue)&&(f=f.previousSibling,f&&f.nodeName=="A"&&!f.getAttribute("_href")&&n.remove(f,!0)):(f=n.findParentByTagName(f,"a",!0),f&&!f.getAttribute("_href")&&(h=o.createBookmark(),n.remove(f,!0),o.moveToBookmark(h).select(!0)))})});UE.plugins.autoheight=function(){function i(){var t=this;(clearTimeout(s),h)||(!t.queryCommandState||t.queryCommandState&&t.queryCommandState("source")!=1)&&(s=setTimeout(function(){for(var i=t.body.lastChild;i&&i.nodeType!=1;)i=i.previousSibling;i&&i.nodeType==1&&(i.style.clear="both",u=Math.max(n.getXY(i).y+i.offsetHeight+25,Math.max(e.minFrameHeight,e.initialFrameHeight)),u!=f&&(u!==parseInt(t.iframe.parentNode.style.height)&&(t.iframe.parentNode.style.height=u+"px"),t.body.style.height=u+"px",f=u),n.removeStyle(i,"clear"))},50))}var t=this,o,f,e,u,s,h;if(t.autoHeightEnabled=t.options.autoHeightEnabled!==!1,t.autoHeightEnabled){f=0;e=t.options;t.addListener("fullscreenchanged",function(n,t){h=t});t.addListener("destroy",function(){t.removeListener("contentchange afterinserthtml keyup mouseup",i)});t.enableAutoHeight=function(){var n=this,t;n.autoHeightEnabled&&(t=n.document,n.autoHeightEnabled=!0,o=t.body.style.overflowY,t.body.style.overflowY="hidden",n.addListener("contentchange afterinserthtml keyup mouseup",i),setTimeout(function(){i.call(n)},r.gecko?100:0),n.fireEvent("autoheightchanged",n.autoHeightEnabled))};t.disableAutoHeight=function(){t.body.style.overflowY=o||"";t.removeListener("contentchange",i);t.removeListener("keyup",i);t.removeListener("mouseup",i);t.autoHeightEnabled=!1;t.fireEvent("autoheightchanged",t.autoHeightEnabled)};t.on("setHeight",function(){t.disableAutoHeight()});t.addListener("ready",function(){var f,u;t.enableAutoHeight();n.on(r.ie?t.body:t.document,r.webkit?"dragover":"drop",function(){clearTimeout(f);f=setTimeout(function(){i.call(t)},100)});window.onscroll=function(){u===null?u=this.scrollY:this.scrollY==0&&u!=0&&(t.window.scrollTo(0,0),u=null)}})}};UE.plugins.autofloat=function(){function d(){return UE.ui?1:(alert(w.autofloatMsg),0)}function g(){var n=document.body.style;n.backgroundImage='url("about:blank")';n.backgroundAttachment="fixed"}function nt(){var e=n.getXY(i),t=n.getComputedStyle(i,"position"),h=n.getComputedStyle(i,"left");i.style.width=i.offsetWidth+"px";i.style.zIndex=u.options.zIndex*1+1;i.parentNode.insertBefore(f,i);a||k&&r.ie?(i.style.position!="absolute"&&(i.style.position="absolute"),i.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-y+s+"px"):(r.ie7Compat&&o&&(o=!1,i.style.left=n.getXY(i).x-document.documentElement.getBoundingClientRect().left+2+"px"),i.style.position!="fixed"&&(i.style.position="fixed",i.style.top=s+"px",(t=="absolute"||t=="relative")&&parseFloat(h)&&(i.style.left=e.x+"px")))}function p(){o=!0;f.parentNode&&f.parentNode.removeChild(f);i.style.cssText=v}function e(){var n=h(u.container),t=u.options.toolbarTopOffset||0;n.top<0&&n.bottom-i.offsetHeight>t?nt():p()}var u=this,w=u.getLang(),l,s,v,f,i,y,h,o,c;if(u.setOpt({topOffset:0}),l=u.options.autoFloatEnabled!==!1,s=u.options.topOffset,l){var b=UE.ui.uiUtils,a=r.ie&&r.version<=6,k=r.quirks;f=document.createElement("div");o=!0;c=t.defer(function(){e()},r.ie?200:100,!0);u.addListener("destroy",function(){n.un(window,["scroll","resize"],e);u.removeListener("keydown",c)});u.addListener("ready",function(){if(d(u)){if(!u.ui)return;h=b.getClientRect;i=u.ui.getDom("toolbarbox");y=h(i).top;v=i.style.cssText;f.style.height=i.offsetHeight+"px";a&&g();n.on(window,["scroll","resize"],e);u.addListener("keydown",c);u.addListener("beforefullscreenchange",function(n,t){t&&p()});u.addListener("fullscreenchanged",function(n,t){t||e()});u.addListener("sourcemodechanged",function(){setTimeout(function(){e()},0)});u.addListener("clearDoc",function(){setTimeout(function(){e()},0)})}})}};UE.plugins.video=function(){function r(n,r,u,f,e,o,s){var h,c;n=t.unhtmlForUrl(n);e=t.unhtml(e);o=t.unhtml(o);r=parseInt(r,10)||0;u=parseInt(u,10)||0;switch(s){case"image":h="<img "+(f?'id="'+f+'"':"")+' width="'+r+'" height="'+u+'" _url="'+n+'" class="'+o.replace(/\bvideo-js\b/,"")+'" src="'+i.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+i.options.UEDITOR_HOME_URL+"themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;"+(e?"float:"+e+";":"")+'" />';break;case"embed":h='<embed type="application/x-shockwave-flash" class="'+o+'" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+t.html(n)+'" width="'+r+'" height="'+u+'"'+(e?' style="float:'+e+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >';break;case"video":c=n.substr(n.lastIndexOf(".")+1);c=="ogv"&&(c="ogg");h="<video"+(f?' id="'+f+'"':"")+' class="'+o+' video-js" '+(e?' style="float:'+e+'"':"")+' controls preload="none" width="'+r+'" height="'+u+'" src="'+n+'" data-setup="{}"><source src="'+n+'" type="video/'+c+'" /><\/video>'}return h}function u(n,i){t.each(n.getNodesByTagName(i?"img":"embed video"),function(n){var t=n.getAttr("class"),u;t&&t.indexOf("edui-faked-video")!=-1&&(u=r(i?n.getAttr("_url"):n.getAttr("src"),n.getAttr("width"),n.getAttr("height"),null,n.getStyle("float")||"",t,i?"embed":"image"),n.parentNode.replaceChild(UE.uNode.createElement(u),n));t&&t.indexOf("edui-upload-video")!=-1&&(u=r(i?n.getAttr("_url"):n.getAttr("src"),n.getAttr("width"),n.getAttr("height"),null,n.getStyle("float")||"",t,i?"video":"image"),n.parentNode.replaceChild(UE.uNode.createElement(u),n))})}var i=this;i.addOutputRule(function(n){u(n,!0)});i.addInputRule(function(n){u(n)});i.commands.insertvideo={execCommand:function(u,f,e){var c,a,v,s,y,o,h,l;for(f=t.isArray(f)?f:[f],c=[],a="tmpVedio",o=0,h=f.length;o<h;o++)s=f[o],v=e=="upload"?"edui-upload-video video-js vjs-default-skin":"edui-faked-video",c.push(r(s.url,s.width||420,s.height||280,a+o,null,v,"image"));for(i.execCommand("inserthtml",c.join(""),!0),y=this.selection.getRange(),o=0,h=f.length;o<h;o++)l=this.document.getElementById("tmpVedio"+o),n.removeAttributes(l,"id"),y.selectNode(l).select(),i.execCommand("imagefloat",f[o].align)},queryCommandState:function(){var n=i.selection.getRange().getClosedNode(),t=n&&(n.className=="edui-faked-video"||n.className.indexOf("edui-upload-video")!=-1);return t?1:0}}},function(){function u(){}var i=UE.UETable=function(n){this.table=n;this.indexTable=[];this.selectedTds=[];this.cellsRange={};this.update(n)};i.removeSelectedClass=function(i){t.each(i,function(t){n.removeClasses(t,"selectTdClass")})};i.addSelectedClass=function(i){t.each(i,function(t){n.addClass(t,"selectTdClass")})};i.isEmptyBlock=function(t){var u=new RegExp(n.fillChar,"g"),i;if(t[r.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(u,"").length>0)return 0;for(i in f.$isNotEmpty)if(f.$isNotEmpty.hasOwnProperty(i)&&t.getElementsByTagName(i).length)return 0;return 1};i.getWidth=function(t){return t?parseInt(n.getComputedStyle(t,"width"),10):0};i.getTableCellAlignState=function(n){t.isArray(n)||(n=[n]);var i={},f=["align","valign"],r=null,u=!0;return t.each(n,function(n){return t.each(f,function(t){if(r=n.getAttribute(t),!i[t]&&r)i[t]=r;else if(!i[t]||r!==i[t])return u=!1,!1}),u}),u?i:null};i.getTableItemsByRange=function(t){var i=t.selection.getStart();i&&i.id&&i.id.indexOf("_baidu_bookmark_start_")===0&&i.nextSibling&&(i=i.nextSibling);var r=i&&n.findParentByTagName(i,["td","th"],!0),u=r&&r.parentNode,f=i&&n.findParentByTagName(i,"caption",!0),e=f?f.parentNode:u&&u.parentNode.parentNode;return{cell:r,tr:u,table:e,caption:f}};i.getUETableBySelected=function(n){var t=i.getTableItemsByRange(n).table;return t&&t.ueTable&&t.ueTable.selectedTds.length?t.ueTable:null};i.getDefaultValue=function(t,i){var u={thin:"0px",medium:"1px",thick:"2px"},e,o,s,r,f;return i?(f=i.getElementsByTagName("td")[0],r=n.getComputedStyle(i,"border-left-width"),e=parseInt(u[r]||r,10),r=n.getComputedStyle(f,"padding-left"),o=parseInt(u[r]||r,10),r=n.getComputedStyle(f,"border-left-width"),s=parseInt(u[r]||r,10),{tableBorder:e,tdPadding:o,tdBorder:s}):(i=t.document.createElement("table"),i.insertRow(0).insertCell(0).innerHTML="xxx",t.body.appendChild(i),f=i.getElementsByTagName("td")[0],r=n.getComputedStyle(i,"border-left-width"),e=parseInt(u[r]||r,10),r=n.getComputedStyle(f,"padding-left"),o=parseInt(u[r]||r,10),r=n.getComputedStyle(f,"border-left-width"),s=parseInt(u[r]||r,10),n.remove(i),{tableBorder:e,tdPadding:o,tdBorder:s})};i.getUETable=function(t){var r=t.tagName.toLowerCase();return t=r=="td"||r=="th"||r=="caption"?n.findParentByTagName(t,"table",!0):t,t.ueTable||(t.ueTable=new i(t)),t.ueTable};i.cloneCell=function(i,r,u){var e,f;return!i||t.isString(i)?this.table.ownerDocument.createElement(i||"td"):(e=n.hasClass(i,"selectTdClass"),e&&n.removeClasses(i,"selectTdClass"),f=i.cloneNode(!0),r&&(f.rowSpan=f.colSpan=1),u||n.removeAttributes(f,"width height"),u||n.removeAttributes(f,"style"),f.style.borderLeftStyle="",f.style.borderTopStyle="",f.style.borderLeftColor=i.style.borderRightColor,f.style.borderLeftWidth=i.style.borderRightWidth,f.style.borderTopColor=i.style.borderBottomColor,f.style.borderTopWidth=i.style.borderBottomWidth,e&&n.addClass(i,"selectTdClass"),f)};i.prototype={getMaxRows:function(){for(var n,u,f,e=this.table.rows,t=1,i=0,r;r=e[i];i++){for(n=1,u=0;f=r.cells[u++];)n=Math.max(f.rowSpan||1,n);t=Math.max(n+i,t)}return t},getMaxCols:function(){for(var u,o,t,i,s=this.table.rows,f=0,r={},n=0,e;e=s[n];n++){for(u=0,o=0;t=e.cells[o++];)if(u+=t.colSpan||1,t.rowSpan&&t.rowSpan>1)for(i=1;i<t.rowSpan;i++)r["row_"+(n+i)]?r["row_"+(n+i)]++:r["row_"+(n+i)]=t.colSpan||1;u+=r["row_"+n]||0;f=Math.max(u,f)}return f},getCellColIndex:function(){},getHSideCell:function(n,t){try{var i=this.getCellInfo(n),e,o,r=this.selectedTds.length,f=this.cellsRange;return!t&&(r?!f.beginColIndex:!i.colIndex)||t&&(r?f.endColIndex==this.colsNum-1:i.colIndex==this.colsNum-1)?null:(e=r?f.beginRowIndex:i.rowIndex,o=t?r?f.endColIndex+1:i.colIndex+1:r?f.beginColIndex-1:i.colIndex<1?0:i.colIndex-1,this.getCell(this.indexTable[e][o].rowIndex,this.indexTable[e][o].cellIndex))}catch(s){u(s)}},getTabNextCell:function(n,t){var u=this.getCellInfo(n),i=t||u.rowIndex,r=u.colIndex+1+(u.colSpan-1),f;try{f=this.getCell(this.indexTable[i][r].rowIndex,this.indexTable[i][r].cellIndex)}catch(e){try{i=i*1+1;r=0;f=this.getCell(this.indexTable[i][r].rowIndex,this.indexTable[i][r].cellIndex)}catch(e){}}return f},getVSideCell:function(n,t,i){try{var r=this.getCellInfo(n),o,s,f=this.selectedTds.length&&!i,e=this.cellsRange;return!t&&r.rowIndex==0||t&&(f?e.endRowIndex==this.rowsNum-1:r.rowIndex+r.rowSpan>this.rowsNum-1)?null:(o=t?f?e.endRowIndex+1:r.rowIndex+r.rowSpan:f?e.beginRowIndex-1:r.rowIndex-1,s=f?e.beginColIndex:r.colIndex,this.getCell(this.indexTable[o][s].rowIndex,this.indexTable[o][s].cellIndex))}catch(h){u(h)}},getSameEndPosCells:function(t,i){var e,l,f,o;try{var r=i.toLowerCase()==="x",s=n.getXY(t)[r?"x":"y"]+t["offset"+(r?"Width":"Height")],a=this.table.rows,h=null,c=[];for(e=0;e<this.rowsNum;e++)for(h=a[e].cells,l=0;f=h[l++];){if(o=n.getXY(f)[r?"x":"y"]+f["offset"+(r?"Width":"Height")],o>s&&r)break;if((t==f||s==o)&&(f[r?"colSpan":"rowSpan"]==1&&c.push(f),r))break}return c}catch(v){u(v)}},setCellContent:function(t,i){t.innerHTML=i||(r.ie?n.fillChar:"<br />")},cloneCell:i.cloneCell,getSameStartPosXCells:function(t){var i,h,r,f;try{var e=n.getXY(t).x+t.offsetWidth,c=this.table.rows,o,s=[];for(i=0;i<this.rowsNum;i++)for(o=c[i].cells,h=0;r=o[h++];){if(f=n.getXY(r).x,f>e)break;if(f==e&&r.colSpan==1){s.push(r);break}}return s}catch(l){u(l)}},update:function(i){var w,s,h,a,r,b,u,f,g,o,e;this.table=i||this.table;this.selectedTds=[];this.cellsRange={};this.indexTable=[];for(var c=this.table.rows,l=this.getMaxRows(),tt=l-c.length,p=this.getMaxCols();tt--;)this.table.insertRow(c.length);for(this.rowsNum=l,this.colsNum=p,e=0,w=c.length;e<w;e++)this.indexTable[e]=new Array(p);for(s=0;h=c[s];s++)for(a=0,b=h.cells;r=b[a];a++){r.rowSpan>l&&(r.rowSpan=l);for(var v=a,k=r.rowSpan||1,d=r.colSpan||1;this.indexTable[s][v];)v++;for(u=0;u<k;u++)for(f=0;f<d;f++)this.indexTable[s+u][v+f]={rowIndex:s,cellIndex:a,colIndex:v,rowSpan:k,colSpan:d}}for(u=0;u<l;u++)for(f=0;f<p;f++)this.indexTable[u][f]===undefined&&(h=c[u],r=h.cells[h.cells.length-1],r=r?r.cloneNode(!0):this.table.ownerDocument.createElement("td"),this.setCellContent(r),r.colSpan!==1&&(r.colSpan=1),r.rowSpan!==1&&(r.rowSpan=1),h.appendChild(r),this.indexTable[u][f]={rowIndex:u,cellIndex:r.cellIndex,colIndex:f,rowSpan:1,colSpan:1});if(g=n.getElementsByTagName(this.table,"td"),o=[],t.each(g,function(t){n.hasClass(t,"selectTdClass")&&o.push(t)}),o.length){var it=o[0],rt=o[o.length-1],nt=this.getCellInfo(it),y=this.getCellInfo(rt);this.selectedTds=o;this.cellsRange={beginRowIndex:nt.rowIndex,beginColIndex:nt.colIndex,endRowIndex:y.rowIndex+y.rowSpan-1,endColIndex:y.colIndex+y.colSpan-1}}if(!n.hasClass(this.table.rows[0],"firstRow"))for(n.addClass(this.table.rows[0],"firstRow"),e=1;e<this.table.rows.length;e++)n.removeClasses(this.table.rows[e],"firstRow")},getCellInfo:function(n){var t,i;if(n){var r=n.cellIndex,u=n.parentNode.rowIndex,f=this.indexTable[u],e=this.colsNum;for(t=r;t<e;t++)if(i=f[t],i.rowIndex===u&&i.cellIndex===r)return i}},getCell:function(n,t){return n<this.rowsNum&&this.table.rows[n].cells[t]||null},deleteCell:function(n,t){t=typeof t=="number"?t:n.parentNode.rowIndex;var i=this.table.rows[t];i.deleteCell(n.cellIndex)},getCellsRange:function(n,t){function f(n,t,i,u){var h=n,c=t,l=i,a=u,s,o,e;if(n>0)for(o=t;o<u;o++)s=r.indexTable[n][o],e=s.rowIndex,e<n&&(h=Math.min(e,h));if(u<r.colsNum)for(e=n;e<i;e++)s=r.indexTable[e][u],o=s.colIndex+s.colSpan-1,o>u&&(a=Math.max(o,a));if(i<r.rowsNum)for(o=t;o<u;o++)s=r.indexTable[i][o],e=s.rowIndex+s.rowSpan-1,e>i&&(l=Math.max(e,l));if(t>0)for(e=n;e<i;e++)s=r.indexTable[e][t],o=s.colIndex,o<t&&(c=Math.min(s.colIndex,c));return h!=n||c!=t||l!=i||a!=u?f(h,c,l,a):{beginRowIndex:n,beginColIndex:t,endRowIndex:i,endColIndex:u}}var r,i;try{if(r=this,i=r.getCellInfo(n),n===t)return{beginRowIndex:i.rowIndex,beginColIndex:i.colIndex,endRowIndex:i.rowIndex+i.rowSpan-1,endColIndex:i.colIndex+i.colSpan-1};var u=r.getCellInfo(t),e=Math.min(i.rowIndex,u.rowIndex),o=Math.min(i.colIndex,u.colIndex),s=Math.max(i.rowIndex+i.rowSpan-1,u.rowIndex+u.rowSpan-1),h=Math.max(i.colIndex+i.colSpan-1,u.colIndex+u.colSpan-1);return f(e,o,s,h)}catch(c){}},getCells:function(n){var r,u,e;this.clearSelected();var l=n.beginRowIndex,a=n.beginColIndex,o=n.endRowIndex,s=n.endColIndex,t,i,f,h={},c=[];for(r=l;r<=o;r++)for(u=a;u<=s;u++)if(t=this.indexTable[r][u],i=t.rowIndex,f=t.colIndex,e=i+"|"+f,!h[e]){if(h[e]=1,i<r||f<u||i+t.rowSpan-1>o||f+t.colSpan-1>s)return null;c.push(this.getCell(i,t.cellIndex))}return c},clearSelected:function(){i.removeSelectedClass(this.selectedTds);this.selectedTds=[];this.cellsRange={}},setSelected:function(n){var t=this.getCells(n);i.addSelectedClass(t);this.selectedTds=t;this.cellsRange=n},isFullRow:function(){var n=this.cellsRange;return n.endColIndex-n.beginColIndex+1==this.colsNum},isFullCol:function(){var t=this.cellsRange,i=this.table,r=i.getElementsByTagName("th"),n=t.endRowIndex-t.beginRowIndex+1;return r.length?n==this.rowsNum||n==this.rowsNum-1:n==this.rowsNum},getNextCell:function(n,t,i){try{var r=this.getCellInfo(n),o,s,f=this.selectedTds.length&&!i,e=this.cellsRange;return!t&&r.rowIndex==0||t&&(f?e.endRowIndex==this.rowsNum-1:r.rowIndex+r.rowSpan>this.rowsNum-1)?null:(o=t?f?e.endRowIndex+1:r.rowIndex+r.rowSpan:f?e.beginRowIndex-1:r.rowIndex-1,s=f?e.beginColIndex:r.colIndex,this.getCell(this.indexTable[o][s].rowIndex,this.indexTable[o][s].cellIndex))}catch(h){u(h)}},getPreviewCell:function(n,t){try{var i=this.getCellInfo(n),e,o,r=this.selectedTds.length,f=this.cellsRange;return!t&&(r?!f.beginColIndex:!i.colIndex)||t&&(r?f.endColIndex==this.colsNum-1:i.rowIndex>this.colsNum-1)?null:(e=t?r?f.beginRowIndex:i.rowIndex<1?0:i.rowIndex-1:r?f.beginRowIndex:i.rowIndex,o=t?r?f.endColIndex+1:i.colIndex:r?f.beginColIndex-1:i.colIndex<1?0:i.colIndex-1,this.getCell(this.indexTable[e][o].rowIndex,this.indexTable[e][o].cellIndex))}catch(s){u(s)}},moveContent:function(n,t){if(!i.isEmptyBlock(t)){if(i.isEmptyBlock(n)){n.innerHTML=t.innerHTML;return}var r=n.lastChild;for(r.nodeType!=3&&f.$block[r.tagName]||n.appendChild(n.ownerDocument.createElement("br"));r=t.firstChild;)n.appendChild(r)}},mergeRight:function(n){var t=this.getCellInfo(n),u=t.colIndex+t.colSpan,i=this.indexTable[t.rowIndex][u],r=this.getCell(i.rowIndex,i.cellIndex);n.colSpan=t.colSpan+i.colSpan;n.removeAttribute("width");this.moveContent(n,r);this.deleteCell(r,i.rowIndex);this.update()},mergeDown:function(n){var t=this.getCellInfo(n),u=t.rowIndex+t.rowSpan,i=this.indexTable[u][t.colIndex],r=this.getCell(i.rowIndex,i.cellIndex);n.rowSpan=t.rowSpan+i.rowSpan;n.removeAttribute("height");this.moveContent(n,r);this.deleteCell(r,i.rowIndex);this.update()},mergeRange:function(){var t=this.cellsRange,n=this.getCell(t.beginRowIndex,this.indexTable[t.beginRowIndex][t.beginColIndex].cellIndex),r,u,h,f,e,i,o,s;for(n.tagName=="TH"&&t.endRowIndex!==t.beginRowIndex&&(r=this.indexTable,u=this.getCellInfo(n),n=this.getCell(1,r[1][u.colIndex].cellIndex),t=this.getCellsRange(n,this.getCell(r[this.rowsNum-1][u.colIndex].rowIndex,r[this.rowsNum-1][u.colIndex].cellIndex))),h=this.getCells(t),i=0;f=h[i++];)f!==n&&(this.moveContent(n,f),this.deleteCell(f));if(n.rowSpan=t.endRowIndex-t.beginRowIndex+1,n.rowSpan>1&&n.removeAttribute("height"),n.colSpan=t.endColIndex-t.beginColIndex+1,n.colSpan>1&&n.removeAttribute("width"),n.rowSpan==this.rowsNum&&n.colSpan!=1&&(n.colSpan=1),n.colSpan==this.colsNum&&n.rowSpan!=1){if(e=n.parentNode.rowIndex,this.table.deleteRow)for(var i=e+1,c=e+1,o=n.rowSpan;i<o;i++)this.table.deleteRow(c);else for(i=0,o=n.rowSpan-1;i<o;i++)s=this.table.rows[e+1],s.parentNode.removeChild(s);n.rowSpan=1}this.update()},insertRow:function(t,i){function h(t,i,r){var e,u,f;t==0?(e=r.nextSibling||r.previousSibling,u=e.cells[t],u.tagName=="TH"&&(u=i.ownerDocument.createElement("th"),u.appendChild(i.firstChild),r.insertBefore(u,i),n.remove(i))):i.tagName=="TH"&&(f=i.ownerDocument.createElement("td"),f.appendChild(i.firstChild),r.insertBefore(f,i),n.remove(i))}var o=this.colsNum,l=this.table,f=l.insertRow(t),r,s=typeof i=="string"&&i.toUpperCase()=="TH",u,c,a,e;if(t==0||t==this.rowsNum)for(u=0;u<o;u++)r=this.cloneCell(i,!0),this.setCellContent(r),r.getAttribute("vAlign")&&r.setAttribute("vAlign",r.getAttribute("vAlign")),f.appendChild(r),s||h(u,r,f);else for(c=this.indexTable[t],a=0,u=0;u<o;u++)e=c[u],e.rowIndex<t?(r=this.getCell(e.rowIndex,e.cellIndex),r.rowSpan=e.rowSpan+1):(r=this.cloneCell(i,!0),this.setCellContent(r),f.appendChild(r)),s||h(u,r,f);return this.update(),f},deleteRow:function(i){for(var e,u,f,h,c,l,a=this.table.rows[i],s=this.indexTable[i],v=this.colsNum,y=0,r=0;r<v;){if(e=s[r],u=this.getCell(e.rowIndex,e.cellIndex),u.rowSpan>1&&e.rowIndex==i){f=u.cloneNode(!0);f.rowSpan=u.rowSpan-1;f.innerHTML="";u.rowSpan=1;var p=i+1,o=this.table.rows[p],w,b=this.getPreviewMergedCellsNum(p,r)-y;b<r?(w=r-b-1,n.insertAfter(o.cells[w],f)):o.cells.length&&o.insertBefore(f,o.cells[0]);y+=1}r+=u.colSpan||1}for(h=[],c={},r=0;r<v;r++){var k=s[r].rowIndex,d=s[r].cellIndex,g=k+"_"+d;c[g]||(c[g]=1,u=this.getCell(k,d),h.push(u))}l=[];t.each(h,function(n){n.rowSpan==1?n.parentNode.removeChild(n):l.push(n)});t.each(l,function(n){n.rowSpan--});a.parentNode.removeChild(a);this.update()},insertCol:function(t,i,r){function l(t,i,r){var u,f;t==0?(u=i.nextSibling||i.previousSibling,u.tagName=="TH"&&(u=i.ownerDocument.createElement("th"),u.appendChild(i.firstChild),r.insertBefore(u,i),n.remove(i))):i.tagName=="TH"&&(f=i.ownerDocument.createElement("td"),f.appendChild(i.firstChild),r.insertBefore(f,i),n.remove(i))}var h=this.rowsNum,e=0,f,u,a=parseInt((this.table.offsetWidth-(this.colsNum+1)*20-(this.colsNum+1))/(this.colsNum+1),10),c=typeof i=="string"&&i.toUpperCase()=="TH",o,s;if(t==0||t==this.colsNum)for(;e<h;e++)f=this.table.rows[e],o=f.cells[t==0?t:f.cells.length],u=this.cloneCell(i,!0),this.setCellContent(u),u.setAttribute("vAlign",u.getAttribute("vAlign")),o&&u.setAttribute("width",o.getAttribute("width")),t?n.insertAfter(f.cells[f.cells.length-1],u):f.insertBefore(u,f.cells[0]),c||l(e,u,f);else for(;e<h;e++)s=this.indexTable[e][t],s.colIndex<t?(u=this.getCell(s.rowIndex,s.cellIndex),u.colSpan=s.colSpan+1):(f=this.table.rows[e],o=f.cells[s.cellIndex],u=this.cloneCell(i,!0),this.setCellContent(u),u.setAttribute("vAlign",u.getAttribute("vAlign")),o&&u.setAttribute("width",o.getAttribute("width")),o?f.insertBefore(u,o):f.appendChild(u)),c||l(e,u,f);this.update();this.updateWidth(a,r||{tdPadding:10,tdBorder:1})},updateWidth:function(r,u){var f=this.table,e=i.getWidth(f)-u.tdPadding*2-u.tdBorder+r,o;if(e<f.ownerDocument.body.offsetWidth){f.setAttribute("width",e);return}o=n.getElementsByTagName(this.table,"td th");t.each(o,function(n){n.setAttribute("width",r)})},deleteCol:function(n){for(var i,o=this.indexTable,s=this.table.rows,h=this.table.getAttribute("width"),u=0,c=this.rowsNum,f={},r=0;r<c;){var l=o[r],t=l[n],e=t.rowIndex+"_"+t.colIndex;f[e]||(f[e]=1,i=this.getCell(t.rowIndex,t.cellIndex),u||(u=i&&parseInt(i.offsetWidth/i.colSpan,10).toFixed(0)),i.colSpan>1?i.colSpan--:s[r].deleteCell(t.cellIndex),r+=t.rowSpan||1)}this.table.setAttribute("width",h-u);this.update()},splitToCells:function(n){var i=this,r=this.splitToRows(n);t.each(r,function(n){i.splitToCols(n)})},splitToRows:function(n){var r=this.getCellInfo(n),u=r.rowIndex,e=r.colIndex,f=[],i,o,s,t;for(n.rowSpan=1,f.push(n),i=u,o=u+r.rowSpan;i<o;i++)i!=u&&(s=this.table.rows[i],t=s.insertCell(e-this.getPreviewMergedCellsNum(i,e)),t.colSpan=r.colSpan,this.setCellContent(t),t.setAttribute("vAlign",n.getAttribute("vAlign")),t.setAttribute("align",n.getAttribute("align")),n.style.cssText&&(t.style.cssText=n.style.cssText),f.push(t));return this.update(),f},getPreviewMergedCellsNum:function(n,t){for(var r,e,u=this.indexTable[n],f=0,i=0;i<t;)r=u[i].colSpan,e=u[i].rowIndex,f+=r-(e==n?1:0),i+=r;return f},splitToCols:function(t){var h=(t.offsetWidth/t.colSpan-22).toFixed(0),f=this.getCellInfo(t),c=f.rowIndex,e=f.colIndex,o=[],r,l,s,i,u;for(t.colSpan=1,t.setAttribute("width",h),o.push(t),r=e,l=e+f.colSpan;r<l;r++)r!=e&&(s=this.table.rows[c],i=s.insertCell(this.indexTable[c][r].cellIndex+1),i.rowSpan=f.rowSpan,this.setCellContent(i),i.setAttribute("vAlign",t.getAttribute("vAlign")),i.setAttribute("align",t.getAttribute("align")),i.setAttribute("width",h),t.style.cssText&&(i.style.cssText=t.style.cssText),t.tagName=="TH"&&(u=t.ownerDocument.createElement("th"),u.appendChild(i.firstChild),u.setAttribute("vAlign",t.getAttribute("vAlign")),u.rowSpan=i.rowSpan,s.insertBefore(u,i),n.remove(i)),o.push(i));return this.update(),o},isLastCell:function(n,t,i){t=t||this.rowsNum;i=i||this.colsNum;var r=this.getCellInfo(n);return r.rowIndex+r.rowSpan==t&&r.colIndex+r.colSpan==i},getLastCell:function(n){n=n||this.table.getElementsByTagName("td");var s=this.getCellInfo(n[0]),e=this,i=n[0],o=i.parentNode,u=0,r=0,f;return t.each(n,function(n){n.parentNode==o&&(r+=n.colSpan||1);u+=n.rowSpan*n.colSpan||1}),f=u/r,t.each(n,function(n){if(e.isLastCell(n,f,r))return i=n,!1}),i},selectRow:function(n){var t=this.indexTable[n],i=this.getCell(t[0].rowIndex,t[0].cellIndex),r=this.getCell(t[this.colsNum-1].rowIndex,t[this.colsNum-1].cellIndex),u=this.getCellsRange(i,r);this.setSelected(u)},selectTable:function(){var n=this.table.getElementsByTagName("td"),t=this.getCellsRange(n[0],n[n.length-1]);this.setSelected(t)},setBackground:function(n,i){var f,u,e;if(typeof i=="string")t.each(n,function(n){n.style.backgroundColor=i});else if(typeof i=="object"){i=t.extend({repeat:!0,colorList:["#ddd","#fff"]},i);var o=this.getCellInfo(n[0]).rowIndex,r=0,s=i.colorList,h=function(n,t,i){return n[t]?n[t]:i?n[t%n.length]:""};for(f=0;u=n[f++];)e=this.getCellInfo(u),u.style.backgroundColor=h(s,o+r==e.rowIndex?r:++r,i.repeat)}},removeBackground:function(n){t.each(n,function(n){n.style.backgroundColor=""})}}}(),function(){function h(i,r){var u=n.getElementsByTagName(i,"td th"),f;t.each(u,function(n){n.removeAttribute("width")});i.setAttribute("width",c(r,!0,s(r,i)));f=[];setTimeout(function(){t.each(u,function(n){n.colSpan==1&&f.push(n.offsetWidth)});t.each(u,function(n,t){n.colSpan==1&&n.setAttribute("width",f[t]+"")})},0)}function c(t,i,r){var u=t.body;return u.offsetWidth-(i?parseInt(n.getComputedStyle(u,"margin-left"),10)*2:0)-r.tableBorder*2-(t.options.offsetWidth||0)}function f(n){var t=i(n).cell,r;return t?(r=u(t),r.selectedTds.length?r.selectedTds:[t]):[]}var o=UE.UETable,i=function(n){return o.getTableItemsByRange(n)},e=function(n){return o.getUETableBySelected(n)},s=function(n,t){return o.getDefaultValue(n,t)},u=function(n){return o.getUETable(n)};UE.commands.inserttable={queryCommandState:function(){return i(this).table?-1:0},execCommand:function(i,u){function o(t,i){for(var e,u=[],o=t.numRows,s=t.numCols,f=0;f<o;f++){for(u.push("<tr"+(f==0?' class="firstRow"':"")+">"),e=0;e<s;e++)u.push('<td width="'+i+'"  vAlign="'+t.tdvalign+'" >'+(r.ie&&r.version<11?n.fillChar:"<br/>")+"<\/td>");u.push("<\/tr>")}return"<table><tbody>"+u.join("")+"<\/tbody><\/table>"}u||(u=t.extend({},{numCols:this.options.defaultCols,numRows:this.options.defaultRows,tdvalign:this.options.tdvalign}));var f=this,h=this.selection.getRange(),c=h.startContainer,l=n.findParent(c,function(t){return n.isBlockElm(t)},!0)||f.body,e=s(f),a=l.offsetWidth,v=Math.floor(a/u.numCols-e.tdPadding*2-e.tdBorder);u.tdvalign||(u.tdvalign=f.options.tdvalign);f.execCommand("inserthtml",o(u,v))}};UE.commands.insertparagraphbeforetable={queryCommandState:function(){return i(this).cell?0:-1},execCommand:function(){var t=i(this).table,n;t&&(n=this.document.createElement("p"),n.innerHTML=r.ie?"&nbsp;":"<br />",t.parentNode.insertBefore(n,t),this.selection.getRange().setStart(n,0).setCursor())}};UE.commands.deletetable={queryCommandState:function(){var t=this.selection.getRange();return n.findParentByTagName(t.startContainer,"table",!0)?0:-1},execCommand:function(t,i){var f=this.selection.getRange(),u;i=i||n.findParentByTagName(f.startContainer,"table",!0);i&&(u=i.nextSibling,u||(u=n.createElement(this.document,"p",{innerHTML:r.ie?n.fillChar:"<br/>"}),i.parentNode.insertBefore(u,i)),n.remove(i),f=this.selection.getRange(),u.nodeType==3?f.setStartBefore(u):f.setStart(u,0),f.setCursor(!1,!0),this.fireEvent("tablehasdeleted"))}};UE.commands.cellalign={queryCommandState:function(){return f(this).length?0:-1},execCommand:function(n,t){var i=f(this),r,u;if(i.length)for(r=0;u=i[r++];)u.setAttribute("align",t)}};UE.commands.cellvalign={queryCommandState:function(){return f(this).length?0:-1},execCommand:function(n,t){var i=f(this),r,u;if(i.length)for(r=0;u=i[r++];)u.setAttribute("vAlign",t)}};UE.commands.insertcaption={queryCommandState:function(){var n=i(this).table;return n?n.getElementsByTagName("caption").length==0?1:-1:-1},execCommand:function(){var u=i(this).table,t,f;u&&(t=this.document.createElement("caption"),t.innerHTML=r.ie?n.fillChar:"<br/>",u.insertBefore(t,u.firstChild),f=this.selection.getRange(),f.setStart(t,0).setCursor())}};UE.commands.deletecaption={queryCommandState:function(){var i=this.selection.getRange(),t=n.findParentByTagName(i.startContainer,"table");return t?t.getElementsByTagName("caption").length==0?-1:1:-1},execCommand:function(){var r=this.selection.getRange(),t=n.findParentByTagName(r.startContainer,"table"),i;t&&(n.remove(t.getElementsByTagName("caption")[0]),i=this.selection.getRange(),i.setStart(t.rows[0].cells[0],0).setCursor())}};UE.commands.inserttitle={queryCommandState:function(){var t=i(this).table,n;return t?(n=t.rows[0],n.cells[n.cells.length-1].tagName.toLowerCase()!="th"?0:-1):-1},execCommand:function(){var n=i(this).table,t;n&&u(n).insertRow(0,"th");t=n.getElementsByTagName("th")[0];this.selection.getRange().setStart(t,0).setCursor(!1,!0)}};UE.commands.deletetitle={queryCommandState:function(){var t=i(this).table,n;return t?(n=t.rows[0],n.cells[n.cells.length-1].tagName.toLowerCase()=="th"?0:-1):-1},execCommand:function(){var t=i(this).table,r;t&&n.remove(t.rows[0]);r=t.getElementsByTagName("td")[0];this.selection.getRange().setStart(r,0).setCursor(!1,!0)}};UE.commands.inserttitlecol={queryCommandState:function(){var n=i(this).table,t;return n?(t=n.rows[n.rows.length-1],t.getElementsByTagName("th").length?-1:0):-1},execCommand:function(){var n=i(this).table,t;n&&u(n).insertCol(0,"th");h(n,this);t=n.getElementsByTagName("th")[0];this.selection.getRange().setStart(t,0).setCursor(!1,!0)}};UE.commands.deletetitlecol={queryCommandState:function(){var n=i(this).table,t;return n?(t=n.rows[n.rows.length-1],t.getElementsByTagName("th").length?0:-1):-1},execCommand:function(){var t=i(this).table,r,u;if(t)for(r=0;r<t.rows.length;r++)n.remove(t.rows[r].children[0]);h(t,this);u=t.getElementsByTagName("td")[0];this.selection.getRange().setStart(u,0).setCursor(!1,!0)}};UE.commands.mergeright={queryCommandState:function(){var h=i(this),f=h.table,e=h.cell,t,n,o,r,s;return!f||!e?-1:(t=u(f),t.selectedTds.length)?-1:(n=t.getCellInfo(e),o=n.colIndex+n.colSpan,o>=t.colsNum)?-1:(r=t.indexTable[n.rowIndex][o],s=f.rows[r.rowIndex].cells[r.cellIndex],!s||e.tagName!=s.tagName)?-1:r.rowIndex==n.rowIndex&&r.rowSpan==n.rowSpan?0:-1},execCommand:function(){var n=this.selection.getRange(),r=n.createBookmark(!0),t=i(this).cell,f=u(t);f.mergeRight(t);n.moveToBookmark(r).select()}};UE.commands.mergedown={queryCommandState:function(){var h=i(this),f=h.table,e=h.cell,t,n,o,r,s;return!f||!e?-1:(t=u(f),t.selectedTds.length)?-1:(n=t.getCellInfo(e),o=n.rowIndex+n.rowSpan,o>=t.rowsNum)?-1:(r=t.indexTable[o][n.colIndex],s=f.rows[r.rowIndex].cells[r.cellIndex],!s||e.tagName!=s.tagName)?-1:r.colIndex==n.colIndex&&r.colSpan==n.colSpan?0:-1},execCommand:function(){var n=this.selection.getRange(),r=n.createBookmark(!0),t=i(this).cell,f=u(t);f.mergeDown(t);n.moveToBookmark(r).select()}};UE.commands.mergecells={queryCommandState:function(){return e(this)?0:-1},execCommand:function(){var t=e(this),i,r;t&&t.selectedTds.length&&(i=t.selectedTds[0],t.mergeRange(),r=this.selection.getRange(),n.isEmptyBlock(i)?r.setStart(i,0).collapse(!0):r.selectNodeContents(i),r.select())}};UE.commands.insertrow={queryCommandState:function(){var n=i(this),t=n.cell;return t&&(t.tagName=="TD"||t.tagName=="TH"&&n.tr!==n.table.rows[0])&&u(n.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var o=this.selection.getRange(),c=o.createBookmark(!0),s=i(this),r=s.cell,f=s.table,n=u(f),l=n.getCellInfo(r),t,e,h;if(n.selectedTds.length)for(t=n.cellsRange,e=0,h=t.endRowIndex-t.beginRowIndex+1;e<h;e++)n.insertRow(t.beginRowIndex,r);else n.insertRow(l.rowIndex,r);o.moveToBookmark(c).select();f.getAttribute("interlaced")==="enabled"&&this.fireEvent("interlacetable",f)}};UE.commands.insertrownext={queryCommandState:function(){var n=i(this),t=n.cell;return t&&t.tagName=="TD"&&u(n.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var o=this.selection.getRange(),l=o.createBookmark(!0),s=i(this),r=s.cell,f=s.table,n=u(f),h=n.getCellInfo(r),t,e,c;if(n.selectedTds.length)for(t=n.cellsRange,e=0,c=t.endRowIndex-t.beginRowIndex+1;e<c;e++)n.insertRow(t.endRowIndex+1,r);else n.insertRow(h.rowIndex+h.rowSpan,r);o.moveToBookmark(l).select();f.getAttribute("interlaced")==="enabled"&&this.fireEvent("interlacetable",f)}};UE.commands.deleterow={queryCommandState:function(){var n=i(this);return n.cell?0:-1},execCommand:function(){var s=i(this).cell,r=u(s),f=r.cellsRange,e=r.getCellInfo(s),v=r.getVSideCell(s),y=r.getVSideCell(s,!0),h=this.selection.getRange(),c,o,l,a;if(t.isEmptyObject(f))r.deleteRow(e.rowIndex);else for(c=f.beginRowIndex;c<f.endRowIndex+1;c++)r.deleteRow(f.beginRowIndex);o=r.table;o.getElementsByTagName("td").length?e.rowSpan==1||e.rowSpan==f.endRowIndex-f.beginRowIndex+1?(y||v)&&h.selectNodeContents(y||v).setCursor(!1,!0):(a=r.getCell(e.rowIndex,r.indexTable[e.rowIndex][e.colIndex].cellIndex),a&&h.selectNodeContents(a).setCursor(!1,!0)):(l=o.nextSibling,n.remove(o),l&&h.setStart(l,0).setCursor(!1,!0));o.getAttribute("interlaced")==="enabled"&&this.fireEvent("interlacetable",o)}};UE.commands.insertcol={queryCommandState:function(){var t=i(this),n=t.cell;return n&&(n.tagName=="TD"||n.tagName=="TH"&&n!==t.tr.cells[0])&&u(t.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(n){var o=this.selection.getRange(),h=o.createBookmark(!0),f,e,s;if(this.queryCommandState(n)!=-1){var r=i(this).cell,t=u(r),c=t.getCellInfo(r);if(t.selectedTds.length)for(f=t.cellsRange,e=0,s=f.endColIndex-f.beginColIndex+1;e<s;e++)t.insertCol(f.beginColIndex,r);else t.insertCol(c.colIndex,r);o.moveToBookmark(h).select(!0)}}};UE.commands.insertcolnext={queryCommandState:function(){var n=i(this),t=n.cell;return t&&u(n.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(){var e=this.selection.getRange(),h=e.createBookmark(!0),t=i(this).cell,n=u(t),o=n.getCellInfo(t),r,f,s;if(n.selectedTds.length)for(r=n.cellsRange,f=0,s=r.endColIndex-r.beginColIndex+1;f<s;f++)n.insertCol(r.endColIndex+1,t);else n.insertCol(o.colIndex+o.colSpan,t);e.moveToBookmark(h).select()}};UE.commands.deletecol={queryCommandState:function(){var n=i(this);return n.cell?0:-1},execCommand:function(){var f=i(this).cell,r=u(f),o=r.cellsRange,v=r.getCellInfo(f),h=r.getHSideCell(f),c=r.getHSideCell(f,!0),l,s,e,a;if(t.isEmptyObject(o))r.deleteCol(v.colIndex);else for(l=o.beginColIndex;l<o.endColIndex+1;l++)r.deleteCol(o.beginColIndex);s=r.table;e=this.selection.getRange();s.getElementsByTagName("td").length?n.inDoc(f,this.document)?e.setStart(f,0).setCursor(!1,!0):c&&n.inDoc(c,this.document)?e.selectNodeContents(c).setCursor(!1,!0):h&&n.inDoc(h,this.document)&&e.selectNodeContents(h).setCursor(!0,!0):(a=s.nextSibling,n.remove(s),a&&e.setStart(a,0).setCursor(!1,!0))}};UE.commands.splittocells={queryCommandState:function(){var t=i(this),n=t.cell,r;return n?(r=u(t.table),r.selectedTds.length>0)?-1:n&&(n.colSpan>1||n.rowSpan>1)?0:-1:-1},execCommand:function(){var n=this.selection.getRange(),r=n.createBookmark(!0),t=i(this).cell,f=u(t);f.splitToCells(t);n.moveToBookmark(r).select()}};UE.commands.splittorows={queryCommandState:function(){var t=i(this),n=t.cell,r;return n?(r=u(t.table),r.selectedTds.length>0)?-1:n&&n.rowSpan>1?0:-1:-1},execCommand:function(){var n=this.selection.getRange(),r=n.createBookmark(!0),t=i(this).cell,f=u(t);f.splitToRows(t);n.moveToBookmark(r).select()}};UE.commands.splittocols={queryCommandState:function(){var t=i(this),n=t.cell,r;return n?(r=u(t.table),r.selectedTds.length>0)?-1:n&&n.colSpan>1?0:-1:-1},execCommand:function(){var n=this.selection.getRange(),r=n.createBookmark(!0),t=i(this).cell,f=u(t);f.splitToCols(t);n.moveToBookmark(r).select()}};UE.commands.adaptbytext=UE.commands.adaptbywindow={queryCommandState:function(){return i(this).table?0:-1},execCommand:function(r){var e=i(this),u=e.table,f;u&&(r=="adaptbywindow"?h(u,this):(f=n.getElementsByTagName(u,"td th"),t.each(f,function(n){n.removeAttribute("width")}),u.removeAttribute("width")))}};UE.commands.averagedistributecol={queryCommandState:function(){var n=e(this);return n?n.isFullRow()||n.isFullCol()?0:-1:-1},execCommand:function(){function u(){var e=i.table,t=0,u=0,o=s(r,e),h,c,f,n;if(i.isFullRow())t=e.offsetWidth,u=i.colsNum;else for(h=i.cellsRange.beginColIndex,c=i.cellsRange.endColIndex,n=h;n<=c;)f=i.selectedTds[n],t+=f.offsetWidth,n+=f.colSpan,u+=1;return Math.ceil(t/u)-o.tdBorder*2-o.tdPadding*2}function f(r){t.each(n.getElementsByTagName(i.table,"th"),function(n){n.setAttribute("width","")});var u=i.isFullRow()?n.getElementsByTagName(i.table,"td"):i.selectedTds;t.each(u,function(n){n.colSpan==1&&n.setAttribute("width",r)})}var r=this,i=e(r);i&&i.selectedTds.length&&f(u())}};UE.commands.averagedistributerow={queryCommandState:function(){var n=e(this);return n?n.selectedTds&&/th/ig.test(n.selectedTds[0].tagName)?-1:n.isFullRow()||n.isFullCol()?0:-1:-1},execCommand:function(){function f(){var f,e=0,t=i.table,y=s(u,t),p=parseInt(n.getComputedStyle(t.getElementsByTagName("td")[0],"padding-top")),c,o,l,a,h;if(i.isFullCol())c=n.getElementsByTagName(t,"caption"),o=n.getElementsByTagName(t,"th"),c.length>0&&(l=c[0].offsetHeight),o.length>0&&(a=o[0].offsetHeight),e=t.offsetHeight-(l||0)-(a||0),f=o.length==0?i.rowsNum:i.rowsNum-1;else{var w=i.cellsRange.beginRowIndex,b=i.cellsRange.endRowIndex,v=0,k=n.getElementsByTagName(t,"tr");for(h=w;h<=b;h++)e+=k[h].offsetHeight,v+=1;f=v}return r.ie&&r.version<9?Math.ceil(e/f):Math.ceil(e/f)-y.tdBorder*2-p*2}function o(r){var u=i.isFullCol()?n.getElementsByTagName(i.table,"td"):i.selectedTds;t.each(u,function(n){n.rowSpan==1&&n.setAttribute("height",r)})}var u=this,i=e(u);i&&i.selectedTds.length&&o(f())}};UE.commands.cellalignment={queryCommandState:function(){return i(this).table?0:-1},execCommand:function(i,r){var f=this,s=e(f),o,u;s?t.each(s.selectedTds,function(t){n.setAttributes(t,r)}):(o=f.selection.getStart(),u=o&&n.findParentByTagName(o,["td","th","caption"],!0),/caption/ig.test(u.tagName)?(u.style.textAlign=r.align,u.style.verticalAlign=r.vAlign):n.setAttributes(u,r),f.selection.getRange().setCursor(!0))},queryCommandValue:function(){var n=i(this).cell,t;return n||(n=f(this)[0]),n?(t=UE.UETable.getUETable(n).selectedTds,t.length||(t=n),UE.UETable.getTableCellAlignState(t)):null}};UE.commands.tablealignment={queryCommandState:function(){return r.ie&&r.version<8?-1:i(this).table?0:-1},execCommand:function(t,i){var f=this,r=f.selection.getStart(),u=r&&n.findParentByTagName(r,["table"],!0);u&&u.setAttribute("align",i)}};UE.commands.edittable={queryCommandState:function(){return i(this).table?0:-1},execCommand:function(i,r){var e=this.selection.getRange(),u=n.findParentByTagName(e.startContainer,"table"),f;u&&(f=n.getElementsByTagName(u,"td").concat(n.getElementsByTagName(u,"th"),n.getElementsByTagName(u,"caption")),t.each(f,function(n){n.style.borderColor=r}))}};UE.commands.edittd={queryCommandState:function(){return i(this).table?0:-1},execCommand:function(i,r){var o=this,s=e(o),u,f;s?t.each(s.selectedTds,function(n){n.style.backgroundColor=r}):(u=o.selection.getStart(),f=u&&n.findParentByTagName(u,["td","th","caption"],!0),f&&(f.style.backgroundColor=r))}};UE.commands.settablebackground={queryCommandState:function(){return f(this).length>1?0:-1},execCommand:function(n,t){var i,r;i=f(this);r=u(i[0]);r.setBackground(i,t)}};UE.commands.cleartablebackground={queryCommandState:function(){var n=f(this),t,i;if(!n.length)return-1;for(t=0;i=n[t++];)if(i.style.backgroundColor!=="")return 0;return-1},execCommand:function(){var n=f(this),t=u(n[0]);t.removeBackground(n)}};UE.commands.interlacetable=UE.commands.uninterlacetable={queryCommandState:function(n){var r=i(this).table,t;return r?(t=r.getAttribute("interlaced"),n=="interlacetable"?t==="enabled"?-1:0:!t||t==="disabled"?-1:0):-1},execCommand:function(n,t){var r=i(this).table;n=="interlacetable"?(r.setAttribute("interlaced","enabled"),this.fireEvent("interlacetable",r,t)):(r.setAttribute("interlaced","disabled"),this.fireEvent("uninterlacetable",r))}};UE.commands.setbordervisible={queryCommandState:function(){var n=i(this).table;return n?0:-1},execCommand:function(){var r=i(this).table;t.each(n.getElementsByTagName(r,"td"),function(n){n.style.borderWidth="1px";n.style.borderStyle="solid"})}}}();UE.plugins.table=function(){function yt(){}function ri(n){ui(n,"width",!0);ui(n,"height",!0)}function ui(n,t,i){n.style[t]&&(i&&n.setAttribute(t,parseInt(n.style[t],10)),n.style[t]="")}function bt(t){if(t.tagName=="TD"||t.tagName=="TH")return t;var i;return(i=n.findParentByTagName(t,"td",!0)||n.findParentByTagName(t,"th",!0))?i:null}function st(t){var u=new RegExp(n.fillChar,"g"),i;if(t[r.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(u,"").length>0)return 0;for(i in f.$isNotEmpty)if(t.getElementsByTagName(i).length)return 0;return 1}function w(n){return n.pageX||n.pageY?{x:n.pageX,y:n.pageY}:{x:n.clientX+i.document.body.scrollLeft-i.document.body.clientLeft,y:n.clientY+i.document.body.scrollTop-i.document.body.clientTop}}function yi(t){var u,o,f,e,s;if(!ht())try{if(u=bt(t.target||t.srcElement),nt&&(i.body.style.webkitUserSelect="none",(Math.abs(ft.x-t.clientX)>ni||Math.abs(ft.y-t.clientY)>ni)&&(kt(),nt=!1,c=0,ei(t))),p&&v){c=0;i.body.style.webkitUserSelect="none";i.selection.getNative()[r.ie9below?"empty":"removeAllRanges"]();o=w(t);b(i,!0,p,o,u);p=="h"?a.style.left=bi(v,t)+"px":p=="v"&&(a.style.top=ki(v,t)+"px");return}if(u){if(i.fireEvent("excludetable",u)===!0)return;if(o=w(t),f=it(u,o),e=n.findParentByTagName(u,"table",!0),tt(e,u,t,!0)){if(i.fireEvent("excludetable",e)===!0)return;i.body.style.cursor="url("+i.options.cursorpath+"h.png),pointer"}else if(tt(e,u,t)){if(i.fireEvent("excludetable",e)===!0)return;i.body.style.cursor="url("+i.options.cursorpath+"v.png),pointer"}else i.body.style.cursor="text",s=u,/\d/.test(f)&&(f=f.replace(/\d/,""),u=h(u).getPreviewCell(u,f=="v")),b(i,u?!!f:!1,u?f:"",o,u)}else fi(!1,e,i)}catch(l){yt(l)}}function fi(n,t,i){if(n)wi(t,i);else{if(ot)return;pi=setTimeout(function(){!ot&&o&&o.parentNode&&o.parentNode.removeChild(o)},2e3)}}function wi(t,i){function e(n,u){clearTimeout(r);r=setTimeout(function(){i.fireEvent("tableClicked",t,u)},300)}function s(){clearTimeout(r);var n=h(t),u=t.rows[0].cells[0],f=n.getLastCell(),e=n.getCellsRange(u,f);i.selection.getRange().setStart(u,0).setCursor(!1,!0);n.setSelected(e)}var u=n.getXY(t),f=t.ownerDocument,r;if(o&&o.parentNode)return o;o=f.createElement("div");o.contentEditable=!1;o.innerHTML="";o.style.cssText="width:15px;height:15px;background-image:url("+i.options.UEDITOR_HOME_URL+"dialogs/table/dragicon.png);position: absolute;cursor:move;top:"+(u.y-15)+"px;left:"+u.x+"px;";n.unSelectable(o);o.onmouseover=function(){ot=!0};o.onmouseout=function(){ot=!1};n.on(o,"click",function(n,t){e(t,this)});n.on(o,"dblclick",function(n,t){s(t)});n.on(o,"dragstart",function(t,i){n.preventDefault(i)});f.body.appendChild(o)}function tt(t,i,r,u){var f=w(r),o=it(i,f),e,s;return u?(e=t.getElementsByTagName("caption")[0],s=e?e.offsetHeight:0,o=="v1"&&f.y-n.getXY(t).y-s<8):o=="h1"&&f.x-n.getXY(t).x<8}function bi(t,r){var u=h(t);if(u){var c=u.getSameEndPosCells(t,"x")[0],f=u.getSameStartPosXCells(t)[0],e=w(r).x,o=(c?n.getXY(c).x:n.getXY(u.table).x)+20,s=f?n.getXY(f).x+f.offsetWidth-20:i.body.offsetWidth+5||parseInt(n.getComputedStyle(i.body,"width"),10);return o+=at,s-=at,e<o?o:e>s?s:e}}function ki(t,i){try{var r=n.getXY(t).y,u=w(i).y;return u<r?r:u}catch(f){yt(f)}}function b(n,t,i,u,f){try{n.body.style.cursor=i=="h"?"col-resize":i=="v"?"row-resize":"text";r.ie&&(!i||d||l(n)?g(n):(ci(n,n.document),li(i,f)));pt=t}catch(e){yt(e)}}function it(t,i){var r=n.getXY(t);return r?r.x+t.offsetWidth-i.x<k?"h":i.x-r.x<k?"h1":r.y+t.offsetHeight-i.y<k?"v":i.y-r.y<k?"v1":"":""}function nr(r,u){var f,o,e;ht()||(ft={x:u.clientX,y:u.clientY},u.button==2?(f=l(i),o=!1,f&&(e=ai(i,u),t.each(f.selectedTds,function(n){n===e&&(o=!0)}),o?(e=f.selectedTds[0],setTimeout(function(){i.selection.getRange().setStart(e,0).setCursor(!1,!0)},0)):(et(n.getElementsByTagName(i.body,"th td")),f.clearSelected()))):ir(u))}function tr(r){var u,e,a,o,l;if(c=0,r=r||i.window.event,u=bt(r.target||r.srcElement),u&&(e=it(u,w(r)))&&(g(i),e=="h1"&&(e="h",tt(n.findParentByTagName(u,"table"),u,r)?i.execCommand("adaptbywindow"):(u=h(u).getPreviewCell(u),u&&(a=i.selection.getRange(),a.selectNodeContents(u).setCursor(!0,!0)))),e=="h")){var s=h(u),v=s.table,f=hi(u,v,!0);f=ur(f,"left");s.width=s.offsetWidth;o=[];l=[];t.each(f,function(n){o.push(n.offsetWidth)});t.each(f,function(n){n.removeAttribute("width")});window.setTimeout(function(){var n=!0,i;t.each(f,function(t,i){var r=t.offsetWidth;if(r>o[i])return n=!1,!1;l.push(r)});i=n?l:o;t.each(f,function(n,t){n.width=i[t]-ct()})},0)}}function ir(r){if(et(n.getElementsByTagName(i.body,"td th")),t.each(i.document.getElementsByTagName("table"),function(n){n.ueTable=null}),u=ai(i,r),u){var f=n.findParentByTagName(u,"table",!0);ut=h(f);ut&&ut.clearSelected();pt?rr(r):(i.document.body.style.webkitUserSelect="",d=!0,i.addListener("mouseover",si))}}function rr(n){r.ie&&(n=fr(n));kt();nt=!0;rt=setTimeout(function(){ei(n)},ti)}function ur(n,t){for(var u=[],i=null,r=0,f=n.length;r<f;r++)i=n[r][t],i&&u.push(i);return u}function kt(){rt&&clearTimeout(rt);rt=null}function fr(n){var f=["pageX","pageY","clientX","clientY","srcElement","target"],u={},t,i,r;if(n)for(t=0;i=f[t];t++)r=n[i],r&&(u[i]=r);return u}function ei(n){if(nt=!1,u=n.target||n.srcElement,u){var t=it(u,w(n));/\d/.test(t)&&(t=t.replace(/\d/,""),u=h(u).getPreviewCell(u,t=="v"));g(i);ci(i,i.document);i.fireEvent("saveScene");li(t,u);d=!0;p=t;v=u}}function oi(t,i){var b,k,y,tt,w,s,l;if(!ht()){if(kt(),nt=!1,pt&&(c=++c%3,ft={x:i.clientX,y:i.clientY},vi=setTimeout(function(){c>0&&c--},ti),c===2)){c=0;tr(i);return}if(i.button!=2){var f=this,o=f.selection.getRange(),s=n.findParentByTagName(o.startContainer,"table",!0),l=n.findParentByTagName(o.endContainer,"table",!0);if((s||l)&&(s===l?(s=n.findParentByTagName(o.startContainer,["td","th","caption"],!0),l=n.findParentByTagName(o.endContainer,["td","th","caption"],!0),s!==l&&f.selection.clearRange()):f.selection.clearRange()),d=!1,f.document.body.style.webkitUserSelect="",p&&v&&(f.selection.getNative()[r.ie9below?"empty":"removeAllRanges"](),c=0,a=f.document.getElementById("ue_tableDragLine"),a)){b=n.getXY(v);k=n.getXY(a);switch(p){case"h":or(v,k.x-b.x);break;case"v":sr(v,k.y-b.y-v.offsetHeight)}p="";v=null;g(f);f.fireEvent("saveScene");return}if(u)tt=h(u),w=tt?tt.selectedTds[0]:null,w?(o=new e.Range(f.document),n.isEmptyBlock(w)?o.setStart(w,0).setCursor(!1,!0):o.selectNodeContents(w).shrinkBoundary().setCursor(!1,!0)):(o=f.selection.getRange().shrinkBoundary(),o.collapsed||(s=n.findParentByTagName(o.startContainer,["td","th"],!0),l=n.findParentByTagName(o.endContainer,["td","th"],!0),(s&&!l||!s&&l||s&&l&&s!==l)&&o.setCursor(!1,!0))),u=null,f.removeListener("mouseover",si);else if(y=n.findParentByTagName(i.target||i.srcElement,"td",!0),y||(y=n.findParentByTagName(i.target||i.srcElement,"th",!0)),y&&(y.tagName=="TD"||y.tagName=="TH")){if(f.fireEvent("excludetable",y)===!0)return;o=new e.Range(f.document);o.setStart(y,0).setCursor(!1,!0)}f._selectionChange(250,i)}}}function si(t,i){var f,o,e,s;ht()||(f=this,o=i.target||i.srcElement,y=n.findParentByTagName(o,"td",!0)||n.findParentByTagName(o,"th",!0),u&&y&&(u.tagName=="TD"&&y.tagName=="TD"||u.tagName=="TH"&&y.tagName=="TH")&&n.findParentByTagName(u,"table")==n.findParentByTagName(y,"table")&&(e=h(y),u!=y?(f.document.body.style.webkitUserSelect="none",f.selection.getNative()[r.ie9below?"empty":"removeAllRanges"](),s=e.getCellsRange(u,y),e.setSelected(s)):(f.document.body.style.webkitUserSelect="",e.clearSelected())),i.preventDefault?i.preventDefault():i.returnValue=!1)}function er(t,i,r){var u=parseInt(n.getComputedStyle(t,"line-height"),10),f=r+i;i=f<u?u:f;t.style.height&&(t.style.height="");t.rowSpan==1?t.setAttribute("height",i):t.removeAttribute&&t.removeAttribute("height")}function or(n,i){var f=h(n),r,u,e;f&&(r=f.table,u=hi(n,r),r.style.width="",r.removeAttribute("width"),i=hr(i,n,u),n.nextSibling?(e=0,t.each(u,function(n){n.left.width=+n.left.width+i;n.right&&(n.right.width=+n.right.width-i)})):t.each(u,function(n){n.left.width-=-i}))}function ht(){return i.body.contentEditable==="false"}function sr(n,t){var r,i,u,f,e;if(!(Math.abs(t)<10)&&(r=h(n),r))for(i=r.getSameEndPosCells(n,"y"),u=i[0]?i[0].offsetHeight:0,f=0;e=i[f++];)er(e,t,u)}function hi(i,r,u){var e;if(r||(r=n.findParentByTagName(i,"table")),!r)return null;for(var h=n.getNodeIndex(i),f=i,s=r.rows,o=0;f;)f.nodeType===1&&(o+=f.colSpan||1),f=f.previousSibling;return f=null,e=[],t.each(s,function(n){var r=n.cells,i=0;t.each(r,function(n){return(i+=n.colSpan||1,i===o)?(e.push({left:n,right:n.nextSibling||null}),!1):i>o?(u&&e.push({left:n}),!1):void 0})}),e}function hr(n,i,r){if(n-=ct(),n<0)return 0;n-=dt(i);var u=n<0?"left":"right";return n=Math.abs(n),t.each(r,function(t){var i=t[u];i&&(n=Math.min(n,dt(i)-at))}),n=n<0?0:n,u==="left"?-n:n}function dt(n){var t=0,t=n.offsetWidth-ct();n.nextSibling||(t-=cr(n));t=t<0?0:t;try{n.width=t}catch(i){}return t}function cr(t){if(tab=n.findParentByTagName(t,"table",!1),tab.offsetVal===undefined){var i=t.previousSibling;tab.offsetVal=i?t.offsetWidth-i.offsetWidth===s.borderWidth?s.borderWidth:0:0}return tab.offsetVal}function ct(){var e;if(s.tabcellSpace===undefined){var n=i.document.createElement("table"),u=i.document.createElement("tbody"),r=i.document.createElement("tr"),t=i.document.createElement("td"),f=null;t.style.cssText="border: 0;";t.width=1;r.appendChild(t);r.appendChild(f=t.cloneNode(!1));u.appendChild(r);n.appendChild(u);n.style.cssText="visibility: hidden;";i.body.appendChild(n);s.paddingSpace=t.offsetWidth-1;e=n.offsetWidth;t.style.cssText="";f.style.cssText="";s.borderWidth=(n.offsetWidth-e)/3;s.tabcellSpace=s.paddingSpace+s.borderWidth;i.body.removeChild(n)}return ct=function(){return s.tabcellSpace},s.tabcellSpace}function ci(t){d||(a=t.document.createElement("div"),n.setAttributes(a,{id:"ue_tableDragLine",unselectable:"on",contenteditable:!1,onresizestart:"return false",ondragstart:"return false",onselectstart:"return false",style:"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)"}),t.body.appendChild(a))}function g(t){if(!d)for(var i;i=t.document.getElementById("ue_tableDragLine");)n.remove(i)}function li(t,i){if(i){var r=n.findParentByTagName(i,"table"),u=r.getElementsByTagName("caption"),s=r.offsetWidth,h=r.offsetHeight-(u.length>0?u[0].offsetHeight:0),e=n.getXY(r),o=n.getXY(i),f;switch(t){case"h":f="height:"+h+"px;top:"+(e.y+(u.length>0?u[0].offsetHeight:0))+"px;left:"+(o.x+i.offsetWidth);a.style.cssText=f+"px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)";break;case"v":f="width:"+s+"px;left:"+e.x+"px;top:"+(o.y+i.offsetHeight);a.style.cssText=f+"px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)"}}}function gt(t,i){for(var u,e=n.getElementsByTagName(t.body,"table"),f,o=0,r;r=e[o++];)u=n.getElementsByTagName(r,"td"),u[0]&&(i?(f=u[0].style.borderColor.replace(/\s/g,""),/(#ffffff)|(rgb\(255,255,255\))/ig.test(f)&&n.addClass(r,"noBorderTable")):n.removeClasses(r,"noBorderTable"))}function lr(t,i,r){var u=t.body;return u.offsetWidth-(i?parseInt(n.getComputedStyle(u,"margin-left"),10)*2:0)-r.tableBorder*2-(t.options.offsetWidth||0)}function ai(t,i){var r=n.findParentByTagName(i.target||i.srcElement,["td","th"],!0),f=null,e,u,o;return r?(f=it(r,w(i)),!r)?null:(f==="h1"&&r.previousSibling?(u=n.getXY(r),e=r.offsetWidth,Math.abs(u.x+e-i.clientX)>e/3&&(r=r.previousSibling)):f==="v1"&&r.parentNode.previousSibling&&(u=n.getXY(r),o=r.offsetHeight,Math.abs(u.y+o-i.clientY)>o/3&&(r=r.parentNode.previousSibling.firstChild)),r&&!(t.fireEvent("excludetable",r)===!0)?r:null):null}var i=this,lt=null,rt=null,vi=null,at=5,nt=!1,k=5,ni=10,c=0,ft=null,ti=360,s=UE.UETable,h=function(n){return s.getUETable(n)},l=function(n){return s.getUETableBySelected(n)},vt=function(n,t){return s.getDefaultValue(n,t)},et=function(n){return s.removeSelectedClass(n)},ii,pi;i.ready(function(){var n=this,i=n.selection.getText;n.selection.getText=function(){var f=l(n),u;return f?(u="",t.each(f.selectedTds,function(n){u+=n[r.ie?"innerText":"textContent"]}),u):i.call(n.selection)}});var u=null,y=null,p="",pt=!1,o=null,ot=!1,a=null,v=null,d=!1,wt=!0;i.setOpt({maxColNum:20,maxRowNum:100,defaultCols:5,defaultRows:5,tdvalign:"top",cursorpath:i.options.UEDITOR_HOME_URL+"themes/default/images/cursor_",tableDragable:!1,classList:["ue-table-interlace-color-single","ue-table-interlace-color-double"]});i.getUETable=h;ii={deletetable:1,inserttable:1,cellvalign:1,insertcaption:1,deletecaption:1,inserttitle:1,deletetitle:1,mergeright:1,mergedown:1,mergecells:1,insertrow:1,insertrownext:1,deleterow:1,insertcol:1,insertcolnext:1,deletecol:1,splittocells:1,splittorows:1,splittocols:1,adaptbytext:1,adaptbywindow:1,adaptbycustomer:1,insertparagraph:1,insertparagraphbeforetable:1,averagedistributecol:1,averagedistributerow:1};i.ready(function(){var u,c,a,y,f,v;t.cssRule("table",".selectTdClass{background-color:#edf5fa !important}table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}table{margin-bottom:10px;border-collapse:collapse;display:table;}td,th{padding: 5px 10px;border: 1px solid #DDD;}caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}th{border-top:1px solid #BBB;background-color:#F7F7F7;}table tr.firstRow th{border-top-width:2px;}.ue-table-interlace-color-single{ background-color: #fcfcfc; } .ue-table-interlace-color-double{ background-color: #f7faff; }td p{margin:0;padding:0;}",i.document);i.addListener("keydown",function(t,i){var r=this,w=i.keyCode||i.which,b,s,e,o,y,f,p,h,v;if(w==8&&(f=l(r),f&&f.selectedTds.length&&(f.isFullCol()?r.execCommand("deletecol"):f.isFullRow()?r.execCommand("deleterow"):r.fireEvent("delcells"),n.preventDefault(i)),e=n.findParentByTagName(r.selection.getStart(),"caption",!0),b=r.selection.getRange(),b.collapsed&&e&&st(e)&&(r.fireEvent("saveScene"),o=e.parentNode,n.remove(e),o&&b.setStart(o.rows[0].cells[0],0).setCursor(!1,!0),r.fireEvent("saveScene"))),w==46&&(f=l(r),f)){for(r.fireEvent("saveScene"),h=0;v=f.selectedTds[h++];)n.fillNode(r.document,v);r.fireEvent("saveScene");n.preventDefault(i)}if(w==13){if(s=r.selection.getRange(),e=n.findParentByTagName(s.startContainer,"caption",!0),e){o=n.findParentByTagName(e,"table");s.collapsed?e&&s.setStart(o.rows[0].cells[0],0).setCursor(!1,!0):(s.deleteContents(),r.fireEvent("saveScene"));n.preventDefault(i);return}if(s.collapsed&&(o=n.findParentByTagName(s.startContainer,"table"),o)){var g=o.rows[0].cells[0],d=n.findParentByTagName(r.selection.getStart(),["td","th"],!0),k=o.previousSibling;g===d&&(!k||k.nodeType==1&&k.tagName=="TABLE")&&n.isStartInblock(s)&&(y=n.findParent(r.selection.getStart(),function(t){return n.isBlockElm(t)},!0),y&&(/t(h|d)/i.test(y.tagName)||y===d.firstChild)&&(r.execCommand("insertparagraphbeforetable"),n.preventDefault(i)))}}if((i.ctrlKey||i.metaKey)&&i.keyCode=="67"&&(u=null,f=l(r),f))for(p=f.selectedTds,c=f.isFullCol(),a=f.isFullRow(),u=[[f.cloneCell(p[0],null,!0)]],h=1;v=p[h];h++)v.parentNode!==p[h-1].parentNode?u.push([f.cloneCell(v,null,!0)]):u[u.length-1].push(f.cloneCell(v,null,!0))});i.addListener("tablehasdeleted",function(){b(this,!1,"",null);o&&n.remove(o)});i.addListener("beforepaste",function(i,f){var y=this,ut=y.selection.getRange(),tt,v,it,ht,w,ft,d,et,g,rt,b,p,nt,o,e,ct,lt,k,ot;if(n.findParentByTagName(ut.startContainer,"caption",!0)){k=y.document.createElement("div");k.innerHTML=f.html;f.html=k[r.ie9below?"innerText":"textContent"];return}if(tt=l(y),u){if(y.fireEvent("saveScene"),ut=y.selection.getRange(),v=n.findParentByTagName(ut.startContainer,["td","th"],!0),v){if(w=h(v),a)for(ft=w.getCellInfo(v).rowIndex,v.tagName=="TH"&&ft++,b=0;p=u[b++];){for(nt=w.insertRow(ft++,"td"),o=0;e=p[o];o++)d=nt.cells[o],d||(d=nt.insertCell(o)),d.innerHTML=e.innerHTML,e.getAttribute("width")&&d.setAttribute("width",e.getAttribute("width")),e.getAttribute("vAlign")&&d.setAttribute("vAlign",e.getAttribute("vAlign")),e.getAttribute("align")&&d.setAttribute("align",e.getAttribute("align")),e.style.cssText&&(d.style.cssText=e.style.cssText);for(o=0;e=nt.cells[o];o++){if(!p[o])break;e.innerHTML=p[o].innerHTML;p[o].getAttribute("width")&&e.setAttribute("width",p[o].getAttribute("width"));p[o].getAttribute("vAlign")&&e.setAttribute("vAlign",p[o].getAttribute("vAlign"));p[o].getAttribute("align")&&e.setAttribute("align",p[o].getAttribute("align"));p[o].style.cssText&&(e.style.cssText=p[o].style.cssText)}}else{if(c){for(rt=w.getCellInfo(v),et=0,o=0,p=u[0];e=p[o++];)et+=e.colSpan||1;for(y.__hasEnterExecCommand=!0,b=0;b<et;b++)y.execCommand("insertcol");y.__hasEnterExecCommand=!1;v=w.table.rows[0].cells[rt.cellIndex];v.tagName=="TH"&&(v=w.table.rows[1].cells[rt.cellIndex])}for(b=0;p=u[b++];){for(it=v,o=0;e=p[o++];)v?(v.innerHTML=e.innerHTML,e.getAttribute("width")&&v.setAttribute("width",e.getAttribute("width")),e.getAttribute("vAlign")&&v.setAttribute("vAlign",e.getAttribute("vAlign")),e.getAttribute("align")&&v.setAttribute("align",e.getAttribute("align")),e.style.cssText&&(v.style.cssText=e.style.cssText),ht=v,v=v.nextSibling):(g=e.cloneNode(!0),n.removeAttributes(g,["class","rowSpan","colSpan"]),ht.parentNode.appendChild(g));if(v=w.getNextCell(it,!0,!0),!u[b])break;v||(rt=w.getCellInfo(it),w.table.insertRow(w.table.rows.length),w.update(),v=w.getVSideCell(it,!0))}}w.update()}else{for(tt=y.document.createElement("table"),b=0;p=u[b++];){for(nt=tt.insertRow(tt.rows.length),o=0;e=p[o++];)g=s.cloneCell(e,null,!0),n.removeAttributes(g,["class"]),nt.appendChild(g);o==2&&g.rowSpan>1&&(g.rowSpan=1)}ct=vt(y);lt=y.body.offsetWidth-(wt?parseInt(n.getComputedStyle(y.body,"margin-left"),10)*2:0)-ct.tableBorder*2-(y.options.offsetWidth||0);y.execCommand("insertHTML","<table  "+(c&&a?'width="'+lt+'"':"")+">"+tt.innerHTML.replace(/>\s*</g,"><").replace(/\bth\b/gi,"td")+"<\/table>")}return y.fireEvent("contentchange"),y.fireEvent("saveScene"),f.html="",!0}k=y.document.createElement("div");k.innerHTML=f.html;ot=k.getElementsByTagName("table");n.findParentByTagName(y.selection.getStart(),"table")?(t.each(ot,function(t){n.remove(t)}),n.findParentByTagName(y.selection.getStart(),"caption",!0)&&(k.innerHTML=k[r.ie?"innerText":"textContent"])):t.each(ot,function(i){ri(i,!0);n.removeAttributes(i,["style","border"]);t.each(n.getElementsByTagName(i,"td"),function(t){st(t)&&n.fillNode(y.document,t);ri(t,!0)})});f.html=k.innerHTML});i.addListener("afterpaste",function(){t.each(n.getElementsByTagName(i.body,"table"),function(t){if(t.offsetWidth>i.body.offsetWidth){var r=vt(i,t);t.style.width=i.body.offsetWidth-(wt?parseInt(n.getComputedStyle(i.body,"margin-left"),10)*2:0)-r.tableBorder*2-(i.options.offsetWidth||0)+"px"}})});i.addListener("blur",function(){u=null});i.addListener("keydown",function(){clearTimeout(y);y=setTimeout(function(){var u=i.selection.getRange(),t=n.findParentByTagName(u.startContainer,["th","td"],!0),r;t&&(r=t.parentNode.parentNode.parentNode,r.offsetWidth>r.getAttribute("width")&&(t.style.wordBreak="break-all"))},100)});i.addListener("selectionchange",function(){b(i,!1,"",null)});i.addListener("contentchange",function(){var i=this,u,r;(g(i),l(i))||(u=i.selection.getRange(),r=u.startContainer,r=n.findParentByTagName(r,["td","th"],!0),t.each(n.getElementsByTagName(i.document,"table"),function(n){i.fireEvent("excludetable",n)!==!0&&(n.ueTable=new s(n),n.onmouseover=function(){i.fireEvent("tablemouseover",n)},n.onmousemove=function(){i.fireEvent("tablemousemove",n);i.options.tableDragable&&fi(!0,this,i);t.defer(function(){i.fireEvent("contentchange",50)},!0)},n.onmouseout=function(){i.fireEvent("tablemouseout",n);b(i,!1,"",null);g(i)},n.onclick=function(n){var r,e,o;if(n=i.window.event||n,r=bt(n.target||n.srcElement),r){var t=h(r),c=t.table,s=t.getCellInfo(r),u,f=i.selection.getRange();if(tt(c,r,n,!0)){e=t.getCell(t.indexTable[t.rowsNum-1][s.colIndex].rowIndex,t.indexTable[t.rowsNum-1][s.colIndex].cellIndex);n.shiftKey&&t.selectedTds.length?t.selectedTds[0]!==e?(u=t.getCellsRange(t.selectedTds[0],e),t.setSelected(u)):f&&f.selectNodeContents(e).select():r!==e?(u=t.getCellsRange(r,e),t.setSelected(u)):f&&f.selectNodeContents(e).select();return}tt(c,r,n)&&(o=t.getCell(t.indexTable[s.rowIndex][t.colsNum-1].rowIndex,t.indexTable[s.rowIndex][t.colsNum-1].cellIndex),n.shiftKey&&t.selectedTds.length?t.selectedTds[0]!==o?(u=t.getCellsRange(t.selectedTds[0],o),t.setSelected(u)):f&&f.selectNodeContents(o).select():r!==o?(u=t.getCellsRange(r,o),t.setSelected(u)):f&&f.selectNodeContents(o).select())}})}),gt(i,!0))});n.on(i.document,"mousemove",yi);n.on(i.document,"mouseout",function(n){var t=n.target||n.srcElement;t.tagName=="TABLE"&&b(i,!1,"",null)});i.addListener("interlacetable",function(n,t,i){var r;if(t){var f=this,u=t.rows,e=u.length,o=function(n,t,i){return n[t]?n[t]:i?n[t%n.length]:""};for(r=0;r<e;r++)u[r].className=o(i||f.options.classList,r,!0)}});i.addListener("uninterlacetable",function(t,i){var r;if(i){var f=this,u=i.rows,e=f.options.classList,o=u.length;for(r=0;r<o;r++)n.removeClasses(u[r],e)}});i.addListener("mousedown",nr);i.addListener("mouseup",oi);n.on(i.body,"dragstart",function(n){oi.call(i,"dragstart",n)});i.addOutputRule(function(n){t.each(n.getNodesByTagName("div"),function(n){n.getAttr("id")=="ue_tableDragLine"&&n.parentNode.removeChild(n)})});f=0;i.addListener("mousedown",function(){f=0});i.addListener("tabkeydown",function(){var r=this.selection.getRange(),o=r.getCommonAncestor(!0,!0),e=n.findParentByTagName(o,"table"),t,s,u;if(e)return n.findParentByTagName(o,"caption",!0)?(t=n.getElementsByTagName(e,"th td"),t&&t.length&&r.setStart(t[0],0).setCursor(!1,!0)):(t=n.findParentByTagName(o,["td","th"],!0),s=h(t),f=t.rowSpan>1?f:s.getCellInfo(t).rowIndex,u=s.getTabNextCell(t,f),u?st(u)?r.setStart(u,0).setCursor(!1,!0):r.selectNodeContents(u).select():(i.fireEvent("saveScene"),i.__hasEnterExecCommand=!0,this.execCommand("insertrownext"),i.__hasEnterExecCommand=!1,r=this.selection.getRange(),r.setStart(e.rows[e.rows.length-1].cells[0],0).setCursor(),i.fireEvent("saveScene"))),!0});r.ie&&i.addListener("selectionchange",function(){b(this,!1,"",null)});i.addListener("keydown",function(t,i){var f=this,e=i.keyCode||i.which,r,u;e!=8&&e!=46&&(r=!i.ctrlKey&&!i.metaKey&&!i.shiftKey&&!i.altKey,r&&et(n.getElementsByTagName(f.body,"td")),u=l(f),u)&&r&&u.clearSelected()});i.addListener("beforegetcontent",function(){gt(this,!1);r.ie&&t.each(this.document.getElementsByTagName("caption"),function(t){n.isEmptyNode(t)&&(t.innerHTML="&nbsp;")})});i.addListener("aftergetcontent",function(){gt(this,!0)});i.addListener("getAllHtml",function(){et(i.document.getElementsByTagName("td"))});i.addListener("fullscreenchanged",function(r,u){if(!u){var f=this.body.offsetWidth/document.body.offsetWidth,e=n.getElementsByTagName(this.body,"table");t.each(e,function(r){var e,o,u,s;if(r.offsetWidth<i.body.offsetWidth)return!1;for(e=n.getElementsByTagName(r,"td"),o=[],t.each(e,function(n){o.push(n.offsetWidth)}),u=0;s=e[u];u++)s.setAttribute("width",Math.floor(o[u]*f));r.setAttribute("width",Math.floor(lr(i,wt,vt(i))))})}});v=i.execCommand;i.execCommand=function(t){var i=this,b=arguments,s,h,w,c,a,r;t=t.toLowerCase();var y=l(i),u,f=new e.Range(i.document),p=i.commands[t]||UE.commands[t],o;if(p){if(!y||ii[t]||p.notNeedUndo||i.__hasEnterExecCommand)o=v.apply(i,arguments);else{for(i.__hasEnterExecCommand=!0,i.fireEvent("beforeexeccommand",t),u=y.selectedTds,s=-2,h=-2,a=0;r=u[a];a++)st(r)?f.setStart(r,0).setCursor(!1,!0):f.selectNode(r).select(!0),c=i.queryCommandState(t),w=i.queryCommandValue(t),c!=-1&&((s!==c||h!==w)&&(i._ignoreContentChange=!0,o=v.apply(i,arguments),i._ignoreContentChange=!1),s=i.queryCommandState(t),h=i.queryCommandValue(t),n.isEmptyBlock(r)&&n.fillNode(i.document,r));f.setStart(u[0],0).shrinkBoundary(!0).setCursor(!1,!0);i.fireEvent("contentchange");i.fireEvent("afterexeccommand",t);i.__hasEnterExecCommand=!1;i._selectionChange()}return o}}})};UE.UETable.prototype.sortTable=function(n,i){var c=this.table,s=c.rows,f=[],p=s[0].cells[0].tagName==="TH",v=0,e,u,h,l,a,o,y;if(this.selectedTds.length){for(e=this.cellsRange,o=e.endRowIndex+1,u=e.beginRowIndex;u<o;u++)f[u]=s[u];f.splice(0,e.beginRowIndex);v=e.endRowIndex+1===this.rowsNum?0:e.endRowIndex+1}else for(u=0,o=s.length;u<o;u++)f[u]=s[u];for(h={reversecurrent:function(){return 1},orderbyasc:function(n,t){var i=n.innerText||n.textContent,r=t.innerText||t.textContent;return i.localeCompare(r)},reversebyasc:function(n,t){var i=n.innerHTML,r=t.innerHTML;return r.localeCompare(i)},orderbynum:function(n,t){var i=n[r.ie?"innerText":"textContent"].match(/\d+/),u=t[r.ie?"innerText":"textContent"].match(/\d+/);return i&&(i=+i[0]),u&&(u=+u[0]),(i||0)-(u||0)},reversebynum:function(n,t){var i=n[r.ie?"innerText":"textContent"].match(/\d+/),u=t[r.ie?"innerText":"textContent"].match(/\d+/);return i&&(i=+i[0]),u&&(u=+u[0]),(u||0)-(i||0)}},c.setAttribute("data-sort-type",i&&typeof i=="string"&&h[i]?i:""),p&&f.splice(0,1),f=t.sort(f,function(t,r){return i&&typeof i=="function"?i.call(this,t.cells[n],r.cells[n]):i&&typeof i=="number"?1:i&&typeof i=="string"&&h[i]?h[i].call(this,t.cells[n],r.cells[n]):h.orderbyasc.call(this,t.cells[n],r.cells[n])}),l=c.ownerDocument.createDocumentFragment(),a=0,o=f.length;a<o;a++)l.appendChild(f[a]);y=c.getElementsByTagName("tbody")[0];v?y.insertBefore(l,s[v-e.endRowIndex+e.beginRowIndex-1]):y.appendChild(l)};UE.plugins.tablesort=function(){var i=this,u=UE.UETable,f=function(n){return u.getUETable(n)},r=function(n){return u.getTableItemsByRange(n)};i.ready(function(){t.cssRule("tablesort","table.sortEnabled tr.firstRow th,table.sortEnabled tr.firstRow td{padding-right:20px;background-repeat: no-repeat;background-position: center right;   background-image:url("+i.options.themePath+i.options.theme+"/images/sortable.png);}",i.document);i.addListener("afterexeccommand",function(n,t){(t=="mergeright"||t=="mergedown"||t=="mergecells")&&this.execCommand("disablesort")})});UE.commands.sorttable={queryCommandState:function(){var e=this,t=r(e),i,u,f,n;if(!t.cell)return-1;for(i=t.table,u=i.getElementsByTagName("td"),f=0;n=u[f++];)if(n.rowSpan!=1||n.colSpan!=1)return-1;return 0},execCommand:function(n,t){var u=this,i=u.selection.getRange(),s=i.createBookmark(!0),e=r(u),h=e.cell,o=f(e.table),c=o.getCellInfo(h);o.sortTable(c.cellIndex,t);i.moveToBookmark(s);try{i.select()}catch(l){}}};UE.commands.enablesort=UE.commands.disablesort={queryCommandState:function(t){var u=r(this).table,f,i;if(u&&t=="enablesort")for(f=n.getElementsByTagName(u,"th td"),i=0;i<f.length;i++)if(f[i].getAttribute("colspan")>1||f[i].getAttribute("rowspan")>1)return-1;return u?t=="enablesort"^u.getAttribute("data-sort")!="sortEnabled"?-1:0:-1},execCommand:function(t){var i=r(this).table;i.setAttribute("data-sort",t=="enablesort"?"sortEnabled":"sortDisabled");t=="enablesort"?n.addClass(i,"sortEnabled"):n.removeClasses(i,"sortEnabled")}}};UE.plugins.contextmenu=function(){var i=this,t,u,f,o;(i.setOpt("enableContextMenu",!0),i.getOpt("enableContextMenu")!==!1)&&(t=i.getLang("contextMenu"),f=i.options.contextMenu||[{label:t.selectall,cmdName:"selectall"},{label:t.cleardoc,cmdName:"cleardoc",exec:function(){confirm(t.confirmclear)&&this.execCommand("cleardoc")}},"-",{label:t.unlink,cmdName:"unlink"},"-",{group:t.paragraph,icon:"justifyjustify",subMenu:[{label:t.justifyleft,cmdName:"justify",value:"left"},{label:t.justifyright,cmdName:"justify",value:"right"},{label:t.justifycenter,cmdName:"justify",value:"center"},{label:t.justifyjustify,cmdName:"justify",value:"justify"}]},"-",{group:t.table,icon:"table",subMenu:[{label:t.inserttable,cmdName:"inserttable"},{label:t.deletetable,cmdName:"deletetable"},"-",{label:t.deleterow,cmdName:"deleterow"},{label:t.deletecol,cmdName:"deletecol"},{label:t.insertcol,cmdName:"insertcol"},{label:t.insertcolnext,cmdName:"insertcolnext"},{label:t.insertrow,cmdName:"insertrow"},{label:t.insertrownext,cmdName:"insertrownext"},"-",{label:t.insertcaption,cmdName:"insertcaption"},{label:t.deletecaption,cmdName:"deletecaption"},{label:t.inserttitle,cmdName:"inserttitle"},{label:t.deletetitle,cmdName:"deletetitle"},{label:t.inserttitlecol,cmdName:"inserttitlecol"},{label:t.deletetitlecol,cmdName:"deletetitlecol"},"-",{label:t.mergecells,cmdName:"mergecells"},{label:t.mergeright,cmdName:"mergeright"},{label:t.mergedown,cmdName:"mergedown"},"-",{label:t.splittorows,cmdName:"splittorows"},{label:t.splittocols,cmdName:"splittocols"},{label:t.splittocells,cmdName:"splittocells"},"-",{label:t.averageDiseRow,cmdName:"averagedistributerow"},{label:t.averageDisCol,cmdName:"averagedistributecol"},"-",{label:t.edittd,cmdName:"edittd",exec:function(){UE.ui.edittd&&new UE.ui.edittd(this);this.getDialog("edittd").open()}},{label:t.edittable,cmdName:"edittable",exec:function(){UE.ui.edittable&&new UE.ui.edittable(this);this.getDialog("edittable").open()}},{label:t.setbordervisible,cmdName:"setbordervisible"}]},{group:t.tablesort,icon:"tablesort",subMenu:[{label:t.enablesort,cmdName:"enablesort"},{label:t.disablesort,cmdName:"disablesort"},"-",{label:t.reversecurrent,cmdName:"sorttable",value:"reversecurrent"},{label:t.orderbyasc,cmdName:"sorttable",value:"orderbyasc"},{label:t.reversebyasc,cmdName:"sorttable",value:"reversebyasc"},{label:t.orderbynum,cmdName:"sorttable",value:"orderbynum"},{label:t.reversebynum,cmdName:"sorttable",value:"reversebynum"}]},{group:t.borderbk,icon:"borderBack",subMenu:[{label:t.setcolor,cmdName:"interlacetable",exec:function(){this.execCommand("interlacetable")}},{label:t.unsetcolor,cmdName:"uninterlacetable",exec:function(){this.execCommand("uninterlacetable")}},{label:t.setbackground,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["#bbb","#ccc"]})}},{label:t.unsetbackground,cmdName:"cleartablebackground",exec:function(){this.execCommand("cleartablebackground")}},{label:t.redandblue,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["red","blue"]})}},{label:t.threecolorgradient,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["#aaa","#bbb","#ccc"]})}}]},{group:t.aligntd,icon:"aligntd",subMenu:[{cmdName:"cellalignment",value:{align:"left",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"bottom"}}]},{group:t.aligntable,icon:"aligntable",subMenu:[{cmdName:"tablealignment",className:"left",label:t.tableleft,value:"left"},{cmdName:"tablealignment",className:"center",label:t.tablecenter,value:"center"},{cmdName:"tablealignment",className:"right",label:t.tableright,value:"right"}]},"-",{label:t.insertparagraphbefore,cmdName:"insertparagraph",value:!0},{label:t.insertparagraphafter,cmdName:"insertparagraph"},{label:t.copy,cmdName:"copy"},{label:t.paste,cmdName:"paste"}],f.length)&&(o=UE.ui.uiUtils,i.addListener("contextmenu",function(s,h){var w=o.getViewportOffsetByEvent(h),a,y,c,l,v,p;for(i.fireEvent("beforeselectionchange"),u&&u.destroy(),a=0,c=[];y=f[a];a++)(function(n){if(n=="-")(l=c[c.length-1])&&l!=="-"&&c.push("-");else if(n.hasOwnProperty("group")){for(var u=0,f,r=[];f=n.subMenu[u];u++)(function(n){n=="-"?(l=r[r.length-1])&&l!=="-"?r.push("-"):r.splice(r.length-1):(i.commands[n.cmdName]||UE.commands[n.cmdName]||n.query)&&(n.query?n.query():i.queryCommandState(n.cmdName))>-1&&r.push({label:n.label||i.getLang("contextMenu."+n.cmdName+(n.value||""))||"",className:"edui-for-"+n.cmdName+(n.className?" edui-for-"+n.cmdName+"-"+n.className:""),onclick:n.exec?function(){n.exec.call(i)}:function(){i.execCommand(n.cmdName,n.value)}})})(f);if(r.length){function e(){switch(n.icon){case"table":return i.getLang("contextMenu.table");case"justifyjustify":return i.getLang("contextMenu.paragraph");case"aligntd":return i.getLang("contextMenu.aligntd");case"aligntable":return i.getLang("contextMenu.aligntable");case"tablesort":return t.tablesort;case"borderBack":return t.borderbk;default:return""}}c.push({label:e(),className:"edui-for-"+n.icon,subMenu:{items:r,editor:i}})}}else(i.commands[n.cmdName]||UE.commands[n.cmdName]||n.query)&&(n.query?n.query.call(i):i.queryCommandState(n.cmdName))>-1&&c.push({label:n.label||i.getLang("contextMenu."+n.cmdName),className:"edui-for-"+(n.icon?n.icon:n.cmdName+(n.value||"")),onclick:n.exec?function(){n.exec.call(i)}:function(){i.execCommand(n.cmdName,n.value)}})})(y);if(c[c.length-1]=="-"&&c.pop(),u=new UE.ui.Menu({items:c,className:"edui-contextmenu",editor:i}),u.render(),u.showAt(w),i.fireEvent("aftershowcontextmenu",u),n.preventDefault(h),r.ie){try{v=i.selection.getNative().createRange()}catch(b){return}v.item&&(p=new e.Range(i.document),p.selectNode(v.item(0)).select(!0,!0))}}),i.addListener("aftershowcontextmenu",function(n,t){var r,u;if(i.zeroclipboard){r=t.items;for(u in r)r[u].className=="edui-for-copy"&&i.zeroclipboard.clip(r[u].getDom())}}))};UE.plugins.shortcutmenu=function(){var i=this,t,f=i.options.shortcutMenu||[];f.length&&(i.addListener("contextmenu mouseup",function(i,o){var s=this,l={type:i,target:o.target||o.srcElement,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY},h,c;if(setTimeout(function(){var n=s.selection.getRange();(n.collapsed===!1||i=="contextmenu")&&(t||(t=new u.editor.ui.ShortCutMenu({editor:s,items:f,theme:s.options.theme,className:"edui-shortcutmenu"}),t.render(),s.fireEvent("afterrendershortcutmenu",t)),t.show(l,!!UE.plugins.contextmenu))}),i=="contextmenu"&&(n.preventDefault(o),r.ie9below)){try{h=s.selection.getNative().createRange()}catch(o){return}h.item&&(c=new e.Range(s.document),c.selectNode(h.item(0)).select(!0,!0))}}),i.addListener("keydown",function(n){n=="keydown"&&t&&!t.isHidden&&t.hide()}))};UE.plugins.basestyle=function(){var u={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},f=function(t,i){return n.filterNodeList(t.selection.getStartElementPath(),i)},i=this,r;i.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"});i.addInputRule(function(n){t.each(n.getNodesByTagName("b i"),function(n){switch(n.tagName){case"b":n.tagName="strong";break;case"i":n.tagName="em"}})});for(r in u)(function(t,r){i.commands[t]={execCommand:function(t){var u=i.selection.getRange(),o=f(this,r),e,s;u.collapsed?(o?(e=i.document.createTextNode(""),u.insertNode(e).removeInlineStyle(r),u.setStartBefore(e),n.remove(e)):(s=u.document.createElement(r[0]),(t=="superscript"||t=="subscript")&&(e=i.document.createTextNode(""),u.insertNode(e).removeInlineStyle(["sub","sup"]).setStartBefore(e).collapse(!0)),u.insertNode(s).setStart(s,0)),u.collapse(!0)):((t=="superscript"||t=="subscript")&&(o&&o.tagName.toLowerCase()==t||u.removeInlineStyle(["sub","sup"])),o?u.removeInlineStyle(r):u.applyInlineStyle(r[0]));u.select()},queryCommandState:function(){return f(this,r)?1:0}}})(r,u[r])};UE.plugins.elementpath=function(){var t,i,n=this;(n.setOpt("elementPathEnabled",!0),n.options.elementPathEnabled)&&(n.commands.elementpath={execCommand:function(r,u){var f=i[u],e=n.selection.getRange();t=u*1;e.selectNode(f).select()},queryCommandValue:function(){var f=[].concat(this.selection.getStartElementPath()).reverse(),e=[],n,r,u;for(i=f,n=0;r=f[n];n++)if(r.nodeType!=3&&(u=r.tagName.toLowerCase(),u=="img"&&r.getAttribute("anchorname")&&(u="anchor"),e[n]=u,t==n)){t=-1;break}return e}})};UE.plugins.formatmatch=function(){function e(o,s){function p(n){return c&&n.selectNode(c),n.applyInlineStyle(i[i.length-1].tagName,null,i)}var a,h,l,v,c,y;r.webkit&&(a=s.target.tagName=="IMG"?s.target:null);t.undoManger&&t.undoManger.save();h=t.selection.getRange();l=a||h.getClosedNode();u&&l&&l.tagName=="IMG"?(l.style.cssText+=";float:"+(u.style.cssFloat||u.style.styleFloat||"none")+";display:"+(u.style.display||"inline"),u=null):u||(v=h.collapsed,v&&(c=t.document.createTextNode("match"),h.insertNode(c).select()),t.__hasEnterExecCommand=!0,y=t.options.removeFormatAttributes,t.options.removeFormatAttributes="",t.execCommand("removeformat"),t.options.removeFormatAttributes=y,t.__hasEnterExecCommand=!1,h=t.selection.getRange(),i.length&&p(h),c&&h.setStartBefore(c).collapse(!0),h.select(),c&&n.remove(c));t.undoManger&&t.undoManger.save();t.removeListener("mouseup",e);f=0}var t=this,i=[],u,f=0;t.addListener("reset",function(){i=[];f=0});t.commands.formatmatch={execCommand:function(){var r,s,o,h;if(f){f=0;i=[];t.removeListener("mouseup",e);return}if(r=t.selection.getRange(),u=r.getClosedNode(),!u||u.tagName!="IMG")for(r.collapse(!0).shrinkBoundary(),s=r.startContainer,i=n.findParents(s,!0,function(t){return!n.isBlockElm(t)&&t.nodeType==1}),o=0;h=i[o];o++)if(h.tagName=="A"){i.splice(o,1);break}t.addListener("mouseup",e);f=1},queryCommandState:function(){return f},notNeedUndo:1}};UE.plugin.register("searchreplace",function(){function h(n,t,i){var u=t.searchStr,f,r;for(t.dir==-1&&(n=n.split("").reverse().join(""),u=u.split("").reverse().join(""),i=n.length-i),f=new RegExp(u,"g"+(t.casesensitive?"":"i"));r=f.exec(n);)if(r.index>=i)return t.dir==-1?n.length-r.index-t.searchStr.length:r.index;return-1}function c(t,i,u){var e,f,o=u.all||u.dir==1?"getNextDomNode":"getPreDomNode",c;for(n.isBody(t)&&(t=t.firstChild),c=1;t;){if(e=t.nodeType==3?t.nodeValue:t[r.ie?"innerText":"textContent"],f=h(e,u,i),c=0,f!=-1)return{node:t,index:f};for(t=n[o](t);t&&s[t.nodeName.toLowerCase()];)t=n[o](t,!0);t&&(i=u.dir==-1?(t.nodeType==3?t.nodeValue:t[r.ie?"innerText":"textContent"]).length:0)}}function u(t,i,e){for(var s=0,o=t.firstChild,h=0,c;o;){if(o.nodeType==3){if(h=o.nodeValue.replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length,s+=h,s>=i)return{node:o,index:h-(s-i)}}else if(!f.$empty[o.tagName]&&(h=o[r.ie?"innerText":"textContent"].replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length,s+=h,s>=i&&(c=u(o,h-(s-i),e),c)))return c;o=n.getNextDomNode(o)}}function e(t,i){var f=t.selection.getRange(),h,l=i.searchStr,s=t.document.createElement("span"),y,p,e,a,v;if(s.innerHTML="$$ueditor_searchreplace_key$$",f.shrinkBoundary(!0),!f.collapsed&&(f.select(),y=t.selection.getText(),new RegExp("^"+i.searchStr+"$",i.casesensitive?"":"i").test(y))){if(i.replaceStr!=undefined)return o(f,i.replaceStr),f.select(),!0;f.collapse(i.dir==-1)}if(f.insertNode(s),f.enlargeToBlockElm(!0),h=f.startContainer,p=h[r.ie?"innerText":"textContent"].indexOf("$$ueditor_searchreplace_key$$"),f.setStartBefore(s),n.remove(s),e=c(h,p,i),e)return a=u(e.node,e.index,l),v=u(e.node,e.index+l.length,l),f.setStart(a.node,a.index).setEnd(v.node,v.index),i.replaceStr!==undefined&&o(f,i.replaceStr),f.select(),!0;f.setCursor()}function o(n,t){t=i.document.createTextNode(t);n.deleteContents().insertNode(t)}var i=this,s={table:1,tbody:1,tr:1,ol:1,ul:1};return{commands:{searchreplace:{execCommand:function(n,r){var u,o,f;if(t.extend(r,{all:!1,casesensitive:!1,dir:1},!0),u=0,r.all){for(o=i.selection.getRange(),f=i.body.firstChild,f&&f.nodeType==1?(o.setStart(f,0),o.shrinkBoundary(!0)):f.nodeType==3&&o.setStartBefore(f),o.collapse(!0).select(!0),r.replaceStr!==undefined&&i.fireEvent("saveScene");e(this,r);)u++;u&&i.fireEvent("saveScene")}else r.replaceStr!==undefined&&i.fireEvent("saveScene"),e(this,r)&&u++,u&&i.fireEvent("saveScene");return u},notNeedUndo:1}}}});UE.plugins.customstyle=function(){var t=this;t.setOpt({customstyle:[{tag:"h1",name:"tc",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;"},{tag:"h1",name:"tl",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;"},{tag:"span",name:"im",style:"font-size:16px;font-style:italic;font-weight:bold;line-height:18px;"},{tag:"span",name:"hi",style:"font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;"}]});t.commands.customstyle={execCommand:function(t,i){var e=this,h=i.tag,r=n.findParent(e.selection.getStart(),function(n){return n.getAttribute("label")},!0),u,o,l={},v,a,p,k,s,w,b,c,y;for(v in i)i[v]!==undefined&&(l[v]=i[v]);if(delete l.tag,r&&r.getAttribute("label")==i.label){if(u=this.selection.getRange(),o=u.createBookmark(),u.collapsed)f.$block[r.tagName]?(c=e.document.createElement("p"),n.moveChild(r,c),r.parentNode.insertBefore(c,r),n.remove(r)):n.remove(r,!0);else{for(a=n.getCommonAncestor(o.start,o.end),p=n.getElementsByTagName(a,h),new RegExp(h,"i").test(a.tagName)&&p.push(a),k=0;s=p[k++];)s.getAttribute("label")==i.label&&(w=n.getPosition(s,o.start),b=n.getPosition(s,o.end),(w&n.POSITION_FOLLOWING||w&n.POSITION_CONTAINS)&&(b&n.POSITION_PRECEDING||b&n.POSITION_CONTAINS)&&f.$block[h]&&(c=e.document.createElement("p"),n.moveChild(s,c),s.parentNode.insertBefore(c,s)),n.remove(s,!0));r=n.findParent(a,function(n){return n.getAttribute("label")==i.label},!0);r&&n.remove(r,!0)}u.moveToBookmark(o).select()}else if(f.$block[h])this.execCommand("paragraph",h,l,"customstyle"),u=e.selection.getRange(),u.collapsed||(u.collapse(),r=n.findParent(e.selection.getStart(),function(n){return n.getAttribute("label")==i.label},!0),y=e.document.createElement("p"),n.insertAfter(r,y),n.fillNode(e.document,y),u.setStart(y,0).setCursor());else{if(u=e.selection.getRange(),u.collapsed){r=e.document.createElement(h);n.setAttributes(r,l);u.insertNode(r).setStart(r,0).setCursor();return}o=u.createBookmark();u.applyInlineStyle(h,l).moveToBookmark(o).select()}},queryCommandValue:function(){var t=n.filterNodeList(this.selection.getStartElementPath(),function(n){return n.getAttribute("label")});return t?t.getAttribute("label"):""}};t.addListener("keyup",function(i,r){var s=r.keyCode||r.which,o,u,e;(s==32||s==13)&&(o=t.selection.getRange(),o.collapsed&&(u=n.findParent(t.selection.getStart(),function(n){return n.getAttribute("label")},!0),u&&f.$block[u.tagName]&&n.isEmptyNode(u)&&(e=t.document.createElement("p"),n.insertAfter(u,e),n.fillNode(t.document,e),n.remove(u),o.setStart(e,0).setCursor())))})};UE.plugins.catchremoteimage=function(){var i=this,r=UE.ajax;i.options.catchRemoteImageEnable!==!1&&(i.setOpt({catchRemoteImageEnable:!1}),i.addListener("afterpaste",function(){i.fireEvent("catchRemoteImage")}),i.addListener("catchRemoteImage",function(){function y(n,u){var s=t.serializeParam(i.queryCommandValue("serverparam"))||"",f=t.formatUrl(o+(o.indexOf("?")==-1?"?":"&")+s),h=t.isCrossDomainUrl(f),e={method:"POST",dataType:h?"jsonp":"",timeout:6e4,onsuccess:u.success,onerror:u.error};e[l]=n;r.request(f,e)}for(var f,h=i.getOpt("catcherLocalDomain"),o=i.getActionUrl(i.getOpt("catcherActionName")),c=i.getOpt("catcherUrlPrefix"),l=i.getOpt("catcherFieldName"),e=[],s=n.getElementsByTagName(i.document,"img"),a=function(n,t){if(n.indexOf(location.host)!=-1||/(^\.)|(^\/)/.test(n))return!0;if(t)for(var r=0,i;i=t[r++];)if(n.indexOf(i)!==-1)return!0;return!1},v=0,u;u=s[v++];)u.getAttribute("word_img")||(f=u.getAttribute("_src")||u.src||"",/^(https?|ftp):/i.test(f)&&!a(f,h)&&e.push(f));e.length&&y(e,{success:function(t){var e,o,h,r,u,l,f,a;try{e=t.state!==undefined?t:eval("("+t.responseText+")")}catch(v){return}for(a=e.list,o=0;r=s[o++];)for(l=r.getAttribute("_src")||r.src||"",h=0;u=a[h++];)if(l==u.source&&u.state=="SUCCESS"){f=c+u.url;n.setAttributes(r,{src:f,_src:f});break}i.fireEvent("catchremotesuccess")},error:function(){i.fireEvent("catchremoteerror")}})}))};UE.plugin.register("snapscreen",function(){function u(i){var f,u=document.createElement("a"),e=t.serializeParam(n.queryCommandValue("serverparam"))||"";return u.href=i,r.ie&&(u.href=u.href),f=u.search,e&&(f=f+(f.indexOf("?")==-1?"?":"&")+e,f=f.replace(/[&]+/ig,"&")),{port:u.port,hostname:u.hostname,path:u.pathname+f||+u.hash}}var n=this,i;return{commands:{snapscreen:{execCommand:function(){function h(t){try{if(t=eval("("+t+")"),t.state=="SUCCESS"){var i=n.options;n.execCommand("insertimage",{src:i.snapscreenUrlPrefix+t.url,_src:i.snapscreenUrlPrefix+t.url,alt:t.title||"",floatStyle:i.snapscreenImgAlign})}else alert(t.state)}catch(r){alert(s.callBackErrorMsg)}}var r,t,f,s=n.getLang("snapScreen_plugin"),e,o;if(!i){e=n.container;o=n.container.ownerDocument||n.container.document;i=o.createElement("object");try{i.type="application/x-pluginbaidusnap"}catch(c){return}i.style.cssText="position:absolute;left:-9999px;width:0;height:0;";i.setAttribute("width","0");i.setAttribute("height","0");e.appendChild(i)}r=n.getActionUrl(n.getOpt("snapscreenActionName"));t=u(r);setTimeout(function(){try{f=i.saveSnapshot(t.hostname,t.path,t.port)}catch(r){n.ui._dialogs.snapscreenDialog.open();return}h(f)},50)},queryCommandState:function(){return navigator.userAgent.indexOf("Windows",0)!=-1?0:-1}}}}});UE.commands.insertparagraph={execCommand:function(t,i){for(var e=this,o=e.selection.getRange(),u=o.startContainer,r,f;u;){if(n.isBody(u))break;r=u;u=u.parentNode}r&&(f=e.document.createElement("p"),i?r.parentNode.insertBefore(f,r):r.parentNode.insertBefore(f,r.nextSibling),n.fillNode(e.document,f),o.setStart(f,0).setCursor(!1,!0))}};UE.plugin.register("webapp",function(){function n(n,t){return t?'<iframe class="edui-faked-webapp" title="'+n.title+'" '+(n.align&&!n.cssfloat?'align="'+n.align+'"':"")+(n.cssfloat?'style="float:'+n.cssfloat+'"':"")+'width="'+n.width+'" height="'+n.height+'"  scrolling="no" frameborder="0" src="'+n.url+'" logo_url = "'+n.logo+'"><\/iframe>':'<img title="'+n.title+'" width="'+n.width+'" height="'+n.height+'" src="'+i.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" _logo_url="'+n.logo+'" style="background:url('+n.logo+') no-repeat center center; border:1px solid gray;" class="edui-faked-webapp" _url="'+n.url+'" '+(n.align&&!n.cssfloat?'align="'+n.align+'"':"")+(n.cssfloat?'style="float:'+n.cssfloat+'"':"")+"/>"}var i=this;return{outputRule:function(i){t.each(i.getNodesByTagName("img"),function(t){var i,r;t.getAttr("class")=="edui-faked-webapp"&&(i=n({title:t.getAttr("title"),width:t.getAttr("width"),height:t.getAttr("height"),align:t.getAttr("align"),cssfloat:t.getStyle("float"),url:t.getAttr("_url"),logo:t.getAttr("_logo_url")},!0),r=UE.uNode.createElement(i),t.parentNode.replaceChild(r,t))})},inputRule:function(i){t.each(i.getNodesByTagName("iframe"),function(t){if(t.getAttr("class")=="edui-faked-webapp"){var i=UE.uNode.createElement(n({title:t.getAttr("title"),width:t.getAttr("width"),height:t.getAttr("height"),align:t.getAttr("align"),cssfloat:t.getStyle("float"),url:t.getAttr("src"),logo:t.getAttr("logo_url")}));t.parentNode.replaceChild(i,t)}})},commands:{webapp:{execCommand:function(i,r){var u=this,f=n(t.extend(r,{align:"none"}),!1);u.execCommand("inserthtml",f)},queryCommandState:function(){var t=this,n=t.selection.getRange().getClosedNode(),i=n&&n.className=="edui-faked-webapp";return i?1:0}}}}});UE.plugins.template=function(){UE.commands.template={execCommand:function(n,t){t.html&&this.execCommand("inserthtml",t.html)}};this.addListener("click",function(t,i){var u=i.target||i.srcElement,f=this.selection.getRange(),r=n.findParent(u,function(t){if(t.className&&n.hasClass(t,"ue_t"))return t},!0);r&&f.selectNode(r).shrinkBoundary().select()});this.addListener("keydown",function(t,i){var u=this.selection.getRange(),r;u.collapsed||i.ctrlKey||i.metaKey||i.shiftKey||i.altKey||(r=n.findParent(u.startContainer,function(t){if(t.className&&n.hasClass(t,"ue_t"))return t},!0),r&&n.removeClasses(r,["ue_t"]))})};UE.plugin.register("music",function(){function n(n,t,r,u,f,e){return e?'<embed type="application/x-shockwave-flash" class="edui-faked-music" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+n+'" width="'+t+'" height="'+r+'" '+(u&&!f?'align="'+u+'"':"")+(f?'style="float:'+f+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >':"<img "+(u&&!f?'align="'+u+'"':"")+(f?'style="float:'+f+'"':"")+' width="'+t+'" height="'+r+'" _url="'+n+'" class="edui-faked-music" src="'+i.options.langPath+i.options.lang+'/images/music.png" />'}var i=this;return{outputRule:function(i){t.each(i.getNodesByTagName("img"),function(t){var i,r,u,f;t.getAttr("class")=="edui-faked-music"&&(r=t.getStyle("float"),u=t.getAttr("align"),i=n(t.getAttr("_url"),t.getAttr("width"),t.getAttr("height"),u,r,!0),f=UE.uNode.createElement(i),t.parentNode.replaceChild(f,t))})},inputRule:function(i){t.each(i.getNodesByTagName("embed"),function(t){var i,r,u;t.getAttr("class")=="edui-faked-music"&&(i=t.getStyle("float"),r=t.getAttr("align"),html=n(t.getAttr("src"),t.getAttr("width"),t.getAttr("height"),r,i,!1),u=UE.uNode.createElement(html),t.parentNode.replaceChild(u,t))})},commands:{music:{execCommand:function(t,i){var r=this,u=n(i.url,i.width||400,i.height||95,"none",!1);r.execCommand("inserthtml",u)},queryCommandState:function(){var t=this,n=t.selection.getRange().getClosedNode(),i=n&&n.className=="edui-faked-music";return i?1:0}}}}});UE.plugin.register("autoupload",function(){function i(i,r){var u=r,w,h,b,c,l,a,e,v,f=/image\/\w+/i.test(i.type)?"image":"file",o="loading_"+(+new Date).toString(36),y;if(w=u.getOpt(f+"FieldName"),h=u.getOpt(f+"UrlPrefix"),b=u.getOpt(f+"MaxSize"),c=u.getOpt(f+"AllowFiles"),l=u.getActionUrl(u.getOpt(f+"ActionName")),e=function(t){var i=u.document.getElementById(o);i&&n.remove(i);u.fireEvent("showmessage",{id:o,content:t,type:"error",timeout:4e3})},f=="image"?(a='<img class="loadingclass" id="'+o+'" src="'+u.options.themePath+u.options.theme+'/images/spacer.gif" title="'+(u.getLang("autoupload.loading")||"")+'" >',v=function(t){var r=h+t.url,i=u.document.getElementById(o);i&&(i.setAttribute("src",r),i.setAttribute("_src",r),i.setAttribute("title",t.title||""),i.setAttribute("alt",t.original||""),i.removeAttribute("id"),n.removeClasses(i,"loadingclass"))}):(a='<p><img class="loadingclass" id="'+o+'" src="'+u.options.themePath+u.options.theme+'/images/spacer.gif" title="'+(u.getLang("autoupload.loading")||"")+'" ><\/p>',v=function(n){var i=h+n.url,r=u.document.getElementById(o),t=u.selection.getRange(),f=t.createBookmark();t.selectNode(r).select();u.execCommand("insertfile",{url:i});t.moveToBookmark(f).select()}),u.execCommand("inserthtml",a),!u.getOpt(f+"ActionName")){e(u.getLang("autoupload.errorLoadConfig"));return}if(i.size>b){e(u.getLang("autoupload.exceedSizeError"));return}if(y=i.name?i.name.substr(i.name.lastIndexOf(".")):"",y&&f!="image"||c&&(c.join("")+".").indexOf(y.toLowerCase()+".")==-1){e(u.getLang("autoupload.exceedTypeError"));return}var s=new XMLHttpRequest,p=new FormData,k=t.serializeParam(u.queryCommandValue("serverparam"))||"",d=t.formatUrl(l+(l.indexOf("?")==-1?"?":"&")+k);p.append(w,i,i.name||"blob."+i.type.substr(6));p.append("type","ajax");s.open("post",d,!0);s.setRequestHeader("X-Requested-With","XMLHttpRequest");s.addEventListener("load",function(n){try{var i=new Function("return "+t.trim(n.target.response))();i.state=="SUCCESS"&&i.url?v(i):e(i.state)}catch(r){e(u.getLang("autoupload.loadError"))}});s.send(p)}function r(n){return n.clipboardData&&n.clipboardData.items&&n.clipboardData.items.length==1&&/^image\//.test(n.clipboardData.items[0].type)?n.clipboardData.items:null}function u(n){return n.dataTransfer&&n.dataTransfer.files?n.dataTransfer.files:null}return{outputRule:function(n){t.each(n.getNodesByTagName("img"),function(n){/\b(loaderrorclass)|(bloaderrorclass)\b/.test(n.getAttr("class"))&&n.parentNode.removeChild(n)});t.each(n.getNodesByTagName("p"),function(n){/\bloadpara\b/.test(n.getAttr("class"))&&n.parentNode.removeChild(n)})},bindEvents:{ready:function(){var f=this;if(window.FormData&&window.FileReader){n.on(f.body,"paste drop",function(n){var s=!1,e,o,t;if(e=n.type=="paste"?r(n):u(n),e){for(o=e.length;o--;)t=e[o],t.getAsFile&&(t=t.getAsFile()),t&&t.size>0&&(i(t,f),s=!0);s&&n.preventDefault()}});n.on(f.body,"dragover",function(n){n.dataTransfer.types[0]=="Files"&&n.preventDefault()});t.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-left:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}",this.document)}}}}});UE.plugin.register("autosave",function(){function u(n){var u;if(!(new Date-r<f)){if(!n.hasContents()){i&&t.removePreferences(i);return}(r=new Date,n._saveFlag=null,u=t.body.innerHTML,n.fireEvent("beforeautosave",{content:u})!==!1)&&(t.setPreferences(i,u),n.fireEvent("afterautosave",{content:u}))}}var t=this,r=new Date,f=20,i=null;return{defaultOptions:{saveInterval:500},bindEvents:{ready:function(){var n="-drafts-data",r=null;r=t.key?t.key+n:(t.container.parentNode.id||"ue-common")+n;i=(location.protocol+location.host+location.pathname).replace(/[.:\/]/g,"_")+r},contentchange:function(){i&&(t._saveFlag&&window.clearTimeout(t._saveFlag),t.options.saveInterval>0?t._saveFlag=window.setTimeout(function(){u(t)},t.options.saveInterval):u(t))}},commands:{clearlocaldata:{execCommand:function(){i&&t.getPreferences(i)&&t.removePreferences(i)},notNeedUndo:!0,ignoreContentChange:!0},getlocaldata:{execCommand:function(){return i?t.getPreferences(i)||"":""},notNeedUndo:!0,ignoreContentChange:!0},drafts:{execCommand:function(){i&&(t.body.innerHTML=t.getPreferences(i)||"<p>"+n.fillHtml+"<\/p>",t.focus(!0))},queryCommandState:function(){return i?t.getPreferences(i)===null?-1:0:-1},notNeedUndo:!0,ignoreContentChange:!0}}}});UE.plugin.register("charts",function(){function i(n){var e=null,s=0,i,u,o,r,f;if(n.rows.length<2||n.rows[0].cells.length<2)return!1;for(e=n.rows[0].cells,s=e.length,i=0;r=e[i];i++)if(r.tagName.toLowerCase()!=="th")return!1;for(i=1;u=n.rows[i];i++){if(u.cells.length!=s||u.cells[0].tagName.toLowerCase()!=="th")return!1;for(o=1;r=u.cells[o];o++)if(f=t.trim(r.innerText||r.textContent||""),f=f.replace(new RegExp(UE.dom.domUtils.fillChar,"g"),"").replace(/^\s+|\s+$/g,""),!/^\d*\.?\d+$/.test(f))return!1}return!0}var r=this;return{bindEvents:{chartserror:function(){}},commands:{charts:{execCommand:function(t,u){var e=n.findParentByTagName(this.selection.getRange().startContainer,"table",!0),s=[],f={},o;if(!e)return!1;if(!i(e))return r.fireEvent("chartserror"),!1;f.title=u.title||"";f.subTitle=u.subTitle||"";f.xTitle=u.xTitle||"";f.yTitle=u.yTitle||"";f.suffix=u.suffix||"";f.tip=u.tip||"";f.dataFormat=u.tableDataFormat||"";f.chartType=u.chartType||0;for(o in f)f.hasOwnProperty(o)&&s.push(o+":"+f[o]);e.setAttribute("data-chart",s.join(";"));n.addClass(e,"edui-charts-table")},queryCommandState:function(){var t=n.findParentByTagName(this.selection.getRange().startContainer,"table",!0);return t&&i(t)?0:-1}}},inputRule:function(n){t.each(n.getNodesByTagName("table"),function(n){n.getAttr("data-chart")!==undefined&&n.setAttr("style")})},outputRule:function(n){t.each(n.getNodesByTagName("table"),function(n){n.getAttr("data-chart")!==undefined&&n.setAttr("style","display: none;")})}}});UE.plugin.register("section",function(){function f(){this.tag="";this.level=-1;this.dom=null;this.nextSection=null;this.previousSection=null;this.parentSection=null;this.startAddress=[];this.endAddress=[];this.children=[]}function u(n){var i=new f;return t.extend(i,n)}function r(n,t){for(var i=t,r=0;r<n.length;r++){if(!i.childNodes)return null;i=i.childNodes[n[r]]}return i}var i=this;return{bindMultiEvents:{type:"aftersetcontent afterscencerestore",handler:function(){i.fireEvent("updateSections")}},bindEvents:{ready:function(){i.fireEvent("updateSections");n.on(i.body,"drop paste",function(){i.fireEvent("updateSections")})},afterexeccommand:function(n,t){t=="paragraph"&&i.fireEvent("updateSections")},keyup:function(n,t){var r=this,u=r.selection.getRange(),i;u.collapsed!=!0?r.fireEvent("updateSections"):(i=t.keyCode||t.which,(i==13||i==8||i==46)&&r.fireEvent("updateSections"))}},commands:{getsections:{execCommand:function(n,i){function c(n){for(var t=0;t<r.length;t++)if(r[t](n))return t;return-1}function h(n,i){for(var y,o,l,a=null,f,r,p=n.childNodes,v=0,w=p.length;v<w;v++)if(r=p[v],l=c(r),l>=0){for(y=s.selection.getRange().selectNode(r).createAddress(!0).startAddress,o=u({tag:r.tagName,title:r.innerText||r.textContent||"",level:l,dom:r,startAddress:t.clone(y,[]),endAddress:t.clone(y,[]),children:[]}),e.nextSection=o,o.previousSection=e,f=e;l<=f.level;)f=f.parentSection;o.parentSection=f;f.children.push(o);a=e=o}else r.nodeType===1&&h(r,i),a&&a.endAddress[a.endAddress.length-1]++}for(var r=i||["h1","h2","h3","h4","h5","h6"],f=0;f<r.length;f++)typeof r[f]=="string"?r[f]=function(n){return function(t){return t.tagName==n.toUpperCase()}}(r[f]):typeof r[f]!="function"&&(r[f]=function(){return null});var s=this,o=u({level:-1,title:"root"}),e=o;return h(s.body,o),o},notNeedUndo:!0},movesection:{execCommand:function(t,i,u,f){function v(n,t,i){for(var u=!1,f=!1,r=0;r<n.length;r++){if(r>=i.length)break;if(i[r]>n[r]){u=!0;break}else if(i[r]<n[r])break}for(r=0;r<t.length;r++){if(r>=i.length)break;if(i[r]<n[r]){f=!0;break}else if(i[r]>n[r])break}return u&&f}var s=this,h,o,c,l,e,a;if(i&&u&&u.level!=-1&&(h=f?u.endAddress:u.startAddress,o=r(h,s.body),h&&o&&!v(i.startAddress,i.endAddress,h))){if(c=r(i.startAddress,s.body),l=r(i.endAddress,s.body),f)for(e=l;e&&!(n.getPosition(c,e)&n.POSITION_FOLLOWING);){if(a=e.previousSibling,n.insertAfter(o,e),e==c)break;e=a}else for(e=c;e&&!(n.getPosition(e,l)&n.POSITION_FOLLOWING);){if(a=e.nextSibling,o.parentNode.insertBefore(e,o),e==l)break;e=a}s.fireEvent("updateSections")}}},deletesection:{execCommand:function(t,i,r){function e(n){for(var t=f.body,i=0;i<n.length;i++){if(!t.childNodes)return null;t=t.childNodes[n[i]]}return t}var f=this;if(i){var h=e(i.startAddress),o=e(i.endAddress),u=h,s;if(r)n.remove(u);else while(u&&n.inDoc(o,f.document)&&!(n.getPosition(u,o)&n.POSITION_FOLLOWING))s=u.nextSibling,n.remove(u),u=s;f.fireEvent("updateSections")}}},selectsection:{execCommand:function(n,i){if(!i&&!i.dom)return!1;var u=this,f=u.selection.getRange(),r={startAddress:t.clone(i.startAddress,[]),endAddress:t.clone(i.endAddress,[])};return r.endAddress[r.endAddress.length-1]++,f.moveToAddress(r).select().scrollToView(),!0},notNeedUndo:!0},scrolltosection:{execCommand:function(n,t){if(!t&&!t.dom)return!1;var r=this,u=r.selection.getRange(),i={startAddress:t.startAddress,endAddress:t.endAddress};return i.endAddress[i.endAddress.length-1]++,u.moveToAddress(i).scrollToView(),!0},notNeedUndo:!0}}}});UE.plugin.register("simpleupload",function(){function f(){var e=r.offsetWidth||20,s=r.offsetHeight||20,f=document.createElement("iframe"),o="display:block;width:"+e+"px;height:"+s+"px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;";n.on(f,"load",function(){var r=(+new Date).toString(36),l,c,h,p;c=f.contentDocument||f.contentWindow.document;h=c.body;l=c.createElement("div");l.innerHTML='<form id="edui_form_'+r+'" target="edui_iframe_'+r+'" method="POST" enctype="multipart/form-data" action="'+i.getOpt("serverUrl")+'" style="'+o+'"><input id="edui_input_'+r+'" type="file" accept="image/*" name="'+i.options.imageFieldName+'" style="'+o+'"><\/form><iframe id="edui_iframe_'+r+'" name="edui_iframe_'+r+'" style="display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;"><\/iframe>';l.className="edui-"+i.options.theme;l.id=i.ui.id+"_iframeupload";h.style.cssText=o;h.style.width=e+"px";h.style.height=s+"px";h.appendChild(l);h.parentNode&&(h.parentNode.style.width=e+"px",h.parentNode.style.height=e+"px");var y=c.getElementById("edui_form_"+r),a=c.getElementById("edui_input_"+r),v=c.getElementById("edui_iframe_"+r);n.on(a,"change",function(){function h(){try{var e,t,f,o=(v.contentDocument||v.contentWindow.document).body,s=o.innerText||o.textContent||"";t=new Function("return "+s)();e=i.options.imageUrlPrefix+t.url;t.state=="SUCCESS"&&t.url?(f=i.document.getElementById(r),f.setAttribute("src",e),f.setAttribute("_src",e),f.setAttribute("title",t.title||""),f.setAttribute("alt",t.original||""),f.removeAttribute("id"),n.removeClasses(f,"loadingclass")):u&&u(t.state)}catch(c){u&&u(i.getLang("simpleupload.loadError"))}y.reset();n.un(v,"load",h)}function u(t){if(r){var u=i.document.getElementById(r);u&&n.remove(u);i.fireEvent("showmessage",{id:r,content:t,type:"error",timeout:4e3})}}var f,e;if(a.value){var r="loading_"+(+new Date).toString(36),c=t.serializeParam(i.queryCommandValue("serverparam"))||"",o=i.getActionUrl(i.getOpt("imageActionName")),s=i.getOpt("imageAllowFiles");if(i.focus(),i.execCommand("inserthtml",'<img class="loadingclass" id="'+r+'" src="'+i.options.themePath+i.options.theme+'/images/spacer.gif" title="'+(i.getLang("simpleupload.loading")||"")+'" >'),!i.getOpt("imageActionName")){errorHandler(i.getLang("autoupload.errorLoadConfig"));return}if(f=a.value,e=f?f.substr(f.lastIndexOf(".")):"",!e||s&&(s.join("")+".").indexOf(e.toLowerCase()+".")==-1){u(i.getLang("simpleupload.exceedTypeError"));return}n.on(v,"load",h);y.action=t.formatUrl(o+(o.indexOf("?")==-1?"?":"&")+c);y.submit()}});i.addListener("selectionchange",function(){clearTimeout(p);p=setTimeout(function(){var n=i.queryCommandState("simpleupload");a.disabled=n==-1?"disabled":!1},400)});u=!0});f.style.cssText=o;r.appendChild(f)}var i=this,u=!1,r;return{bindEvents:{ready:function(){t.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}",this.document)},simpleuploadbtnready:function(n,t){r=t;i.afterConfigReady(f)}},outputRule:function(n){t.each(n.getNodesByTagName("img"),function(n){/\b(loaderrorclass)|(bloaderrorclass)\b/.test(n.getAttr("class"))&&n.parentNode.removeChild(n)})},commands:{simpleupload:{queryCommandState:function(){return u?0:-1}}}}});UE.plugin.register("serverparam",function(){var i=this,n={};return{commands:{serverparam:{execCommand:function(i,r,u){r===undefined||r===null?n={}:t.isString(r)?u===undefined||u===null?delete n[r]:n[r]=u:t.isObject(r)?t.extend(n,r,!0):t.isFunction(r)&&t.extend(n,r(),!0)},queryCommandValue:function(){return n||{}}}}}});UE.plugin.register("insertfile",function(){function i(n){var i=n.substr(n.lastIndexOf(".")+1).toLowerCase(),t={rar:"icon_rar.gif",zip:"icon_rar.gif",tar:"icon_rar.gif",gz:"icon_rar.gif",bz2:"icon_rar.gif",doc:"icon_doc.gif",docx:"icon_doc.gif",pdf:"icon_pdf.gif",mp3:"icon_mp3.gif",xls:"icon_xls.gif",chm:"icon_chm.gif",ppt:"icon_ppt.gif",pptx:"icon_ppt.gif",avi:"icon_mv.gif",rmvb:"icon_mv.gif",wmv:"icon_mv.gif",flv:"icon_mv.gif",swf:"icon_mv.gif",rm:"icon_mv.gif",exe:"icon_exe.gif",psd:"icon_psd.gif",txt:"icon_txt.gif",jpg:"icon_jpg.gif",png:"icon_jpg.gif",jpeg:"icon_jpg.gif",gif:"icon_jpg.gif",ico:"icon_jpg.gif",bmp:"icon_jpg.gif"};return t[i]?t[i]:t.txt}var n=this;return{commands:{insertfile:{execCommand:function(r,u){u=t.isArray(u)?u:[u];for(var f,o,s,c="",h=n.getOpt("UEDITOR_HOME_URL"),l=h+(h.substr(h.length-1)=="/"?"":"/")+"dialogs/attachment/fileTypeImages/",e=0;e<u.length;e++)f=u[e],o=l+i(f.url),s=f.title||f.url.substr(f.url.lastIndexOf("/")+1),c+='<p style="line-height: 16px;"><img style="vertical-align: middle; margin-right: 2px;" src="'+o+'" _src="'+o+'" /><a style="font-size:12px; color:#0066cc;" href="'+f.url+'" title="'+s+'">'+s+"<\/a><\/p>";n.execCommand("insertHtml",c)}}}}});UE.plugins.xssFilter=function(){function i(t){var i=t.tagName,r=t.attrs;if(!n.hasOwnProperty(i))return t.parentNode.removeChild(t),!1;UE.utils.each(r,function(r,u){n[i].indexOf(u)===-1&&t.setAttr(u)})}var t=UEDITOR_CONFIG,n=t.whitList,r;n&&t.xssFilterRules&&(this.options.filterRules=function(){var t={};return UE.utils.each(n,function(n,r){t[r]=function(n){return i(n)}}),t}());r=[];UE.utils.each(n,function(n,t){r.push(t)});n&&t.inputXssFilter&&this.addInputRule(function(n){n.traversal(function(n){if(n.type!=="element")return!1;i(n)})});n&&t.outputXssFilter&&this.addOutputRule(function(n){n.traversal(function(n){if(n.type!=="element")return!1;i(n)})})};u=u||{};u.editor=u.editor||{};UE.ui=u.editor.ui={},function(){function f(){var n=document.getElementById("edui_fixedlayer");t.setViewportOffset(n,{left:0,top:0})}function h(){i.on(window,"scroll",f);i.on(window,"resize",u.editor.utils.defer(f,0,!0))}var n=u.editor.browser,i=u.editor.dom.domUtils,r="$EDITORUI",e=window[r]={},o="ID"+r,s=0,t=u.editor.ui.uiUtils={uid:function(n){return n?n[o]||(n[o]=++s):++s},hook:function(n,t){var i;return n&&n._callbacks?i=n:(i=function(){var t,r,u,f;for(n&&(t=n.apply(this,arguments)),r=i._callbacks,u=r.length;u--;)f=r[u].apply(this,arguments),t===undefined&&(t=f);return t},i._callbacks=[]),i._callbacks.push(t),i},createElementByHtml:function(n){var t=document.createElement("div");return t.innerHTML=n,t=t.firstChild,t.parentNode.removeChild(t),t},getViewportElement:function(){return n.ie&&n.quirks?document.body:document.documentElement},getClientRect:function(n){var t,r,u;try{t=n.getBoundingClientRect()}catch(f){t={left:0,top:0,height:0,width:0}}for(r={left:Math.round(t.left),top:Math.round(t.top),height:Math.round(t.bottom-t.top),width:Math.round(t.right-t.left)};(u=n.ownerDocument)!==document&&(n=i.getWindow(u).frameElement);)t=n.getBoundingClientRect(),r.left+=t.left,r.top+=t.top;return r.bottom=r.top+r.height,r.right=r.left+r.width,r},getViewportRect:function(){var n=t.getViewportElement(),i=(window.innerWidth||n.clientWidth)|0,r=(window.innerHeight||n.clientHeight)|0;return{left:0,top:0,height:r,width:i,bottom:r,right:i}},setViewportOffset:function(n,r){var u=t.getFixedLayer();n.parentNode===u?(n.style.left=r.left+"px",n.style.top=r.top+"px"):i.setViewportOffset(n,r)},getEventOffset:function(n){var u=n.target||n.srcElement,i=t.getClientRect(u),r=t.getViewportOffsetByEvent(n);return{left:r.left-i.left,top:r.top-i.top}},getViewportOffsetByEvent:function(n){var f=n.target||n.srcElement,e=i.getWindow(f).frameElement,r={left:n.clientX,top:n.clientY},u;return e&&f.ownerDocument!==document&&(u=t.getClientRect(e),r.left+=u.left,r.top+=u.top),r},setGlobal:function(n,t){return e[n]=t,r+'["'+n+'"]'},unsetGlobal:function(n){delete e[n]},copyAttributes:function(t,r){for(var f=r.attributes,e=f.length,u;e--;)u=f[e],u.nodeName!="style"&&u.nodeName!="class"&&(!n.ie||u.specified)&&t.setAttribute(u.nodeName,u.nodeValue);r.className&&i.addClass(t,r.className);r.style.cssText&&(t.style.cssText+=";"+r.style.cssText)},removeStyle:function(n,t){if(n.style.removeProperty)n.style.removeProperty(t);else if(n.style.removeAttribute)n.style.removeAttribute(t);else throw"";},contains:function(n,t){return n&&t&&(n===t?!1:n.contains?n.contains(t):n.compareDocumentPosition(t)&16)},startDrag:function(n,t,i){function u(n){var i=n.clientX-o,r=n.clientY-s;t.ondragmove(i,r,n);n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}var i=i||document,o=n.clientX,s=n.clientY,r;if(i.addEventListener){function f(){i.removeEventListener("mousemove",u,!0);i.removeEventListener("mouseup",f,!0);window.removeEventListener("mouseup",f,!0);t.ondragstop()}i.addEventListener("mousemove",u,!0);i.addEventListener("mouseup",f,!0);window.addEventListener("mouseup",f,!0);n.preventDefault()}else{r=n.srcElement;r.setCapture();function e(){r.releaseCapture();r.detachEvent("onmousemove",u);r.detachEvent("onmouseup",e);r.detachEvent("onlosecaptrue",e);t.ondragstop()}r.attachEvent("onmousemove",u);r.attachEvent("onmouseup",e);r.attachEvent("onlosecaptrue",e);n.returnValue=!1}t.ondragstart()},getFixedLayer:function(){var t=document.getElementById("edui_fixedlayer");return t==null&&(t=document.createElement("div"),t.id="edui_fixedlayer",document.body.appendChild(t),n.ie&&n.version<=8?(t.style.position="absolute",h(),setTimeout(f)):t.style.position="fixed",t.style.left="0",t.style.top="0",t.style.width="0",t.style.height="0"),t},makeUnselectable:function(i){if(n.opera||n.ie&&n.version<9){if(i.unselectable="on",i.hasChildNodes())for(var r=0;r<i.childNodes.length;r++)i.childNodes[r].nodeType==1&&t.makeUnselectable(i.childNodes[r])}else i.style.MozUserSelect!==undefined?i.style.MozUserSelect="none":i.style.WebkitUserSelect!==undefined?i.style.WebkitUserSelect="none":i.style.KhtmlUserSelect!==undefined&&(i.style.KhtmlUserSelect="none")}}}(),function(){var i=u.editor.utils,t=u.editor.ui.uiUtils,f=u.editor.EventBase,r=u.editor.ui.UIBase=function(){};r.prototype={className:"",uiName:"",initOptions:function(n){var r=this;for(var i in n)r[i]=n[i];this.id=this.id||"edui"+t.uid()},initUIBase:function(){this._globalKey=i.unhtml(t.setGlobal(this.id,this))},render:function(i){for(var u,s=this.renderHtml(),r=t.createElementByHtml(s),h=n.getElementsByTagName(r,"*"),f="edui-"+(this.theme||this.editor.options.theme),e=document.getElementById("edui_fixedlayer"),c=0,o;o=h[c++];)n.addClass(o,f);n.addClass(r,f);e&&(e.className="",n.addClass(e,f));u=this.getDom();u!=null?(u.parentNode.replaceChild(r,u),t.copyAttributes(r,u)):(typeof i=="string"&&(i=document.getElementById(i)),i=i||t.getFixedLayer(),n.addClass(i,f),i.appendChild(r));this.postRender()},getDom:function(n){return n?document.getElementById(this.id+"_"+n):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(n){var t="edui-"+this.uiName;return n.replace(/##/g,this.id).replace(/%%-/g,this.uiName?t+"-":"").replace(/%%/g,(this.uiName?t:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var n=this.getDom();n&&u.editor.dom.domUtils.remove(n);t.unsetGlobal(this.id)}};i.inherits(r,f)}(),function(){var t=u.editor.utils,i=u.editor.ui.UIBase,n=u.editor.ui.Separator=function(n){this.initOptions(n);this.initSeparator()};n.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><\/div>'}};t.inherits(n,i)}(),function(){var t=u.editor.utils,i=u.editor.dom.domUtils,r=u.editor.ui.UIBase,f=u.editor.ui.uiUtils,n=u.editor.ui.Mask=function(n){this.initOptions(n);this.initUIBase()};n.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onclick="return $$._onClick(event, this);" onmousedown="return $$._onMouseDown(event, this);"><\/div>'},postRender:function(){var n=this;i.on(window,"resize",function(){setTimeout(function(){n.isHidden()||n._fill()})})},show:function(n){this._fill();this.getDom().style.display="";this.getDom().style.zIndex=n},hide:function(){this.getDom().style.display="none";this.getDom().style.zIndex=""},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return!1},_onClick:function(n,t){this.fireEvent("click",n,t)},_fill:function(){var n=this.getDom(),t=f.getViewportRect();n.style.width=t.width+"px";n.style.height=t.height+"px"}};t.inherits(n,r)}(),function(){function e(n,t){for(var r,u=0;u<i.length;u++)if(r=i[u],!r.isHidden()&&r.queryAutoHide(t)!==!1){if(n&&/scroll/ig.test(n.type)&&r.className=="edui-wordpastepop")return;r.hide()}i.length&&r.editor.fireEvent("afterhidepop")}var s=u.editor.utils,n=u.editor.ui.uiUtils,t=u.editor.dom.domUtils,r=u.editor.ui.UIBase,f=u.editor.ui.Popup=function(n){this.initOptions(n);this.initPopup()},i=[],o;f.postHide=e;o=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];f.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,initPopup:function(){this.initUIBase();i.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%" onmousedown="return false;"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"><\/iframe> <div class="edui-shadow"><\/div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  <\/div> <\/div><\/div>"},getContentHtmlTpl:function(){return this.content?typeof this.content=="string"?this.content:this.content.renderHtml():""},_UIBase_postRender:r.prototype.postRender,postRender:function(){if(this.content instanceof r&&this.content.postRender(),this.captureWheel&&!this.captured){this.captured=!0;var e=(document.documentElement.clientHeight||document.body.clientHeight)-80,u=this.getDom().offsetHeight,o=n.getClientRect(this.combox.getDom()).top,f=this.getDom("content"),i=this.getDom("body").getElementsByTagName("iframe"),s=this;for(i.length&&(i=i[0]);o+u>e;)u-=30;if(f.style.height=u+"px",i&&(i.style.height=u+"px"),window.XMLHttpRequest)t.on(f,"onmousewheel"in document.body?"mousewheel":"DOMMouseScroll",function(n){n.preventDefault?n.preventDefault():n.returnValue=!1;f.scrollTop-=n.wheelDelta?n.wheelDelta/2:n.detail*-20});else t.on(this.getDom(),"mousewheel",function(n){n.returnValue=!1;s.getDom("content").scrollTop-=n.wheelDelta/2})}this.fireEvent("postRenderAfter");this.hide(!0);this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var t=this.getDom("content");return n.getClientRect(t)},fitSize:function(){var t,n,i;return this.captureWheel&&this.sized?this.__size:(this.sized=!0,t=this.getDom("body"),t.style.width="",t.style.height="",n=this.mesureSize(),this.captureWheel?(t.style.width=-(-20-n.width)+"px",i=parseInt(this.getDom("content").style.height,10),window.isNaN(i)||(n.height=i)):t.style.width=n.width+"px",t.style.height=n.height+"px",this.__size=n,this.captureWheel&&(this.getDom("content").style.overflow="auto"),n)},showAnchor:function(t,i){this.showAnchorRect(n.getClientRect(t),i)},showAnchorRect:function(i,r){var s,f,h,c,l,a,e;this._doAutoRender();s=n.getViewportRect();this.getDom().style.visibility="hidden";this._show();f=this.fitSize();r?(h=this.canSideLeft&&i.right+f.width>s.right&&i.left>f.width,c=this.canSideUp&&i.top+f.height>s.bottom&&i.bottom>f.height,l=h?i.left-f.width:i.right,a=c?i.bottom-f.height:i.top):(h=this.canSideLeft&&i.right+f.width>s.right&&i.left>f.width,c=this.canSideUp&&i.top+f.height>s.bottom&&i.bottom>f.height,l=h?i.right-f.width:i.left,a=c?i.top-f.height:i.bottom);e=this.getDom();n.setViewportOffset(e,{left:l,top:a});t.removeClasses(e,o);e.className+=" "+o[(c?1:0)*2+(h?1:0)];this.editor&&(e.style.zIndex=this.editor.container.style.zIndex*1+10,u.editor.ui.uiUtils.getFixedLayer().style.zIndex=e.style.zIndex-1);this.getDom().style.visibility="visible"},showAt:function(n){var t=n.left,i=n.top,r={left:t,top:i,right:t,bottom:i,height:0,width:0};this.showAnchorRect(r,!1,!0)},_show:function(){if(this._hidden){var n=this.getDom();n.style.display="";this._hidden=!1;this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender();this._show()},hide:function(n){!this._hidden&&this.getDom()&&(this.getDom().style.display="none",this._hidden=!0,n||this.fireEvent("hide"))},queryAutoHide:function(t){return!t||!n.contains(this.getDom(),t)}};s.inherits(f,r);t.on(document,"mousedown",function(n){var t=n.target||n.srcElement;e(n,t)});t.on(window,"scroll",function(n,t){e(n,t)})}(),function(){function f(t,i){for(var u='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"><\/div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+t+'<\/div><\/div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+i.getLang("themeColor")+'<\/td> <\/tr><tr class="edui-colorpicker-tablefirstrow" >',r=0;r<n.length;r++)r&&r%10==0&&(u+="<\/tr>"+(r==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+i.getLang("standardColor")+"<\/td><\/tr>":"")+"<tr"+(r==60?' class="edui-colorpicker-tablefirstrow"':"")+">"),u+=r<70?'<td style="padding: 0 2px;"><a hidefocus title="'+n[r]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+n[r]+'" style="background-color:#'+n[r]+";border:solid #ccc;"+(r<10||r>=60?"border-width:1px;":r>=10&&r<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"><\/a><\/td>':"";return u+"<\/tr><\/table><\/div>"}var i=u.editor.utils,r=u.editor.ui.UIBase,t=u.editor.ui.ColorPicker=function(n){this.initOptions(n);this.noColorText=this.noColorText||this.editor.getLang("clearColor");this.initUIBase()},n;t.prototype={getHtmlTpl:function(){return f(this.noColorText,this.editor)},_onTableClick:function(n){var i=n.target||n.srcElement,t=i.getAttribute("data-color");t&&this.fireEvent("pickcolor",t)},_onTableOver:function(n){var i=n.target||n.srcElement,t=i.getAttribute("data-color");t&&(this.getDom("preview").style.backgroundColor=t)},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}};i.inherits(t,r);n="ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,".split(",")}(),function(){var r=u.editor.utils,n=u.editor.ui.uiUtils,t=u.editor.ui.UIBase,i=u.editor.ui.TablePicker=function(n){this.initOptions(n);this.initTablePicker()};i.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){var n=this;return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"><\/span><\/div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"><\/div><\/div><\/div><\/div>'},_UIBase_render:t.prototype.render,render:function(n){this._UIBase_render(n);this.getDom("label").innerHTML="0"+this.editor.getLang("t_row")+" x 0"+this.editor.getLang("t_col")},_track:function(n,t){var i=this.getDom("overlay").style,r=this.lengthOfCellSide,u;i.width=n*r+"px";i.height=t*r+"px";u=this.getDom("label");u.innerHTML=n+this.editor.getLang("t_col")+" x "+t+this.editor.getLang("t_row");this.numCols=n;this.numRows=t},_onMouseOver:function(t,i){var r=t.relatedTarget||t.fromElement;n.contains(i,r)||i===r||(this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row"),this.getDom("overlay").style.visibility="")},_onMouseOut:function(t,i){var r=t.relatedTarget||t.toElement;n.contains(i,r)||i===r||(this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row"),this.getDom("overlay").style.visibility="hidden")},_onMouseMove:function(t){var e=this.getDom("overlay").style,i=n.getEventOffset(t),r=this.lengthOfCellSide,u=Math.ceil(i.left/r),f=Math.ceil(i.top/r);this._track(u,f)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)}};r.inherits(i,t)}(),function(){var i=u.editor.browser,n=u.editor.dom.domUtils,t=u.editor.ui.uiUtils,r='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(i.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');u.editor.ui.Stateful={alwalysHoverable:!1,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var n=this._Stateful_dGetHtmlTpl();return n.replace(/stateful/g,function(){return r})},Stateful_onMouseEnter:function(n,t){this.target=t;(!this.isDisabled()||this.alwalysHoverable)&&(this.addState("hover"),this.fireEvent("over"))},Stateful_onMouseLeave:function(){(!this.isDisabled()||this.alwalysHoverable)&&(this.removeState("hover"),this.removeState("active"),this.fireEvent("out"))},Stateful_onMouseOver:function(n,i){var r=n.relatedTarget;t.contains(i,r)||i===r||this.Stateful_onMouseEnter(n,i)},Stateful_onMouseOut:function(n,i){var r=n.relatedTarget;t.contains(i,r)||i===r||this.Stateful_onMouseLeave(n,i)},Stateful_onMouseDown:function(){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(t){return n.hasClass(this.getStateDom(),"edui-state-"+t)},addState:function(n){this.hasState(n)||(this.getStateDom().className+=" edui-state-"+n)},removeState:function(t){this.hasState(t)&&n.removeClasses(this.getStateDom(),["edui-state-"+t])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(n){!this.isDisabled()&&n?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(n){n?(this.removeState("hover"),this.removeState("checked"),this.removeState("active"),this.addState("disabled")):this.removeState("disabled")}}}(),function(){var n=u.editor.utils,i=u.editor.ui.UIBase,r=u.editor.ui.Stateful,t=u.editor.ui.Button=function(n){if(n.name){var t=n.name,i=n.cssRules;n.className||(n.className="edui-for-"+t);n.cssRules=".edui-default  .edui-for-"+t+" .edui-icon {"+i+"}"}this.initOptions(n);this.initButton()};t.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,cssRules:"",initButton:function(){this.initUIBase();this.Stateful_init();this.cssRules&&n.cssRule("edui-customize-"+this.name+"-style",this.cssRules)},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return $$._onMouseDown(event, this);" onclick="return $$._onClick(event, this);">'+(this.showIcon?'<div class="edui-box edui-icon"><\/div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"<\/div>":"")+"<\/div><\/div><\/div><\/div>"},postRender:function(){this.Stateful_postRender();this.setDisabled(this.disabled)},_onMouseDown:function(n){var t=n.target||n.srcElement,i=t&&t.tagName&&t.tagName.toLowerCase();if(i=="input"||i=="object"||i=="object")return!1},_onClick:function(){this.isDisabled()||this.fireEvent("click")},setTitle:function(n){var t=this.getDom("label");t.innerHTML=n}};n.inherits(t,i);n.extend(t.prototype,r)}(),function(){var n=u.editor.utils,t=u.editor.ui.uiUtils,e=u.editor.dom.domUtils,r=u.editor.ui.UIBase,f=u.editor.ui.Stateful,i=u.editor.ui.SplitButton=function(n){this.initOptions(n);this.initSplitButton()};i.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){var t,n;this.initUIBase();this.Stateful_init();t=this;this.popup!=null&&(n=this.popup,this.popup=null,this.setPopup(n))},_UIBase_postRender:r.prototype.postRender,postRender:function(){this.Stateful_postRender();this._UIBase_postRender()},setPopup:function(i){this.popup!==i&&(this.popup!=null&&this.popup.dispose(),i.addListener("show",n.bind(this._onPopupShow,this)),i.addListener("hide",n.bind(this._onPopupHide,this)),i.addListener("postrender",n.bind(function(){i.getDom("body").appendChild(t.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(t.getClientRect(this.getDom()).width+20)+'px"><\/div>'));i.getDom().className+=" "+this.className},this)),this.popup=i)},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"><\/div><\/div><div class="edui-box edui-splitborder"><\/div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"><\/div><\/div><\/div><\/div>'},showPopup:function(){var n=t.getClientRect(this.getDom());n.top-=this.popup.SHADOW_RADIUS;n.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(n)},_onArrowClick:function(){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick")}};n.inherits(i,r);n.extend(i.prototype,f,!0)}(),function(){var i=u.editor.utils,r=u.editor.ui.uiUtils,f=u.editor.ui.ColorPicker,e=u.editor.ui.Popup,n=u.editor.ui.SplitButton,t=u.editor.ui.ColorButton=function(n){this.initOptions(n);this.initColorButton()};t.prototype={initColorButton:function(){var n=this;this.popup=new e({content:new f({noColorText:n.editor.getLang("clearColor"),editor:n.editor,onpickcolor:function(t,i){n._onPickColor(i)},onpicknocolor:function(t,i){n._onPickNoColor(i)}}),editor:n.editor});this.initSplitButton()},_SplitButton_postRender:n.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.getDom("button_body").appendChild(r.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"><\/div>'));this.getDom().className+=" edui-colorbutton"},setColor:function(n){this.getDom("colorlump").style.backgroundColor=n;this.color=n},_onPickColor:function(n){this.fireEvent("pickcolor",n)!==!1&&(this.setColor(n),this.popup.hide())},_onPickNoColor:function(){this.fireEvent("picknocolor")!==!1&&this.popup.hide()}};i.inherits(t,n)}(),function(){var t=u.editor.utils,i=u.editor.ui.Popup,r=u.editor.ui.TablePicker,f=u.editor.ui.SplitButton,n=u.editor.ui.TableButton=function(n){this.initOptions(n);this.initTableButton()};n.prototype={initTableButton:function(){var n=this;this.popup=new i({content:new r({editor:n.editor,onpicktable:function(t,i,r){n._onPickTable(i,r)}}),editor:n.editor});this.initSplitButton()},_onPickTable:function(n,t){this.fireEvent("picktable",n,t)!==!1&&this.popup.hide()}};t.inherits(n,f)}(),function(){var i=u.editor.utils,n=u.editor.ui.UIBase,t=u.editor.ui.AutoTypeSetPicker=function(n){this.initOptions(n);this.initAutoTypeSetPicker()};t.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){var i=this.editor,n=i.options.autotypeset,t=i.getLang("autoTypeSet"),u="textAlignValue"+i.uid,r="imageBlockLineValue"+i.uid,f="symbolConverValue"+i.uid;return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td nowrap><input type="checkbox" name="mergeEmptyline" '+(n.mergeEmptyline?"checked":"")+">"+t.mergeLine+'<\/td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(n.removeEmptyline?"checked":"")+">"+t.delLine+'<\/td><\/tr><tr><td nowrap><input type="checkbox" name="removeClass" '+(n.removeClass?"checked":"")+">"+t.removeFormat+'<\/td><td colspan="2"><input type="checkbox" name="indent" '+(n.indent?"checked":"")+">"+t.indent+'<\/td><\/tr><tr><td nowrap><input type="checkbox" name="textAlign" '+(n.textAlign?"checked":"")+">"+t.alignment+'<\/td><td colspan="2" id="'+u+'"><input type="radio" name="'+u+'" value="left" '+(n.textAlign&&n.textAlign=="left"?"checked":"")+">"+i.getLang("justifyleft")+'<input type="radio" name="'+u+'" value="center" '+(n.textAlign&&n.textAlign=="center"?"checked":"")+">"+i.getLang("justifycenter")+'<input type="radio" name="'+u+'" value="right" '+(n.textAlign&&n.textAlign=="right"?"checked":"")+">"+i.getLang("justifyright")+'<\/td><\/tr><tr><td nowrap><input type="checkbox" name="imageBlockLine" '+(n.imageBlockLine?"checked":"")+">"+t.imageFloat+'<\/td><td nowrap id="'+r+'"><input type="radio" name="'+r+'" value="none" '+(n.imageBlockLine&&n.imageBlockLine=="none"?"checked":"")+">"+i.getLang("default")+'<input type="radio" name="'+r+'" value="left" '+(n.imageBlockLine&&n.imageBlockLine=="left"?"checked":"")+">"+i.getLang("justifyleft")+'<input type="radio" name="'+r+'" value="center" '+(n.imageBlockLine&&n.imageBlockLine=="center"?"checked":"")+">"+i.getLang("justifycenter")+'<input type="radio" name="'+r+'" value="right" '+(n.imageBlockLine&&n.imageBlockLine=="right"?"checked":"")+">"+i.getLang("justifyright")+'<\/td><\/tr><tr><td nowrap><input type="checkbox" name="clearFontSize" '+(n.clearFontSize?"checked":"")+">"+t.removeFontsize+'<\/td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(n.clearFontFamily?"checked":"")+">"+t.removeFontFamily+'<\/td><\/tr><tr><td nowrap colspan="3"><input type="checkbox" name="removeEmptyNode" '+(n.removeEmptyNode?"checked":"")+">"+t.removeHtml+'<\/td><\/tr><tr><td nowrap colspan="3"><input type="checkbox" name="pasteFilter" '+(n.pasteFilter?"checked":"")+">"+t.pasteFilter+'<\/td><\/tr><tr><td nowrap><input type="checkbox" name="symbolConver" '+(n.bdc2sb||n.tobdc?"checked":"")+">"+t.symbol+'<\/td><td id="'+f+'"><input type="radio" name="bdc" value="bdc2sb" '+(n.bdc2sb?"checked":"")+">"+t.bdc2sb+'<input type="radio" name="bdc" value="tobdc" '+(n.tobdc?"checked":"")+">"+t.tobdc+'<\/td><td nowrap align="right"><button >'+t.run+"<\/button><\/td><\/tr><\/table><\/div><\/div>"},_UIBase_render:n.prototype.render};i.inherits(t,n)}(),function(){function t(t){for(var e,s,p,h,w,c,l,r={},a=t.getDom(),b=t.editor.uid,v=null,u=null,y=n.getElementsByTagName(a,"input"),o=y.length-1,f;f=y[o--];)if(v=f.getAttribute("type"),v=="checkbox")if(u=f.getAttribute("name"),r[u]&&delete r[u],f.checked)if(e=document.getElementById(u+"Value"+b),e){if(/input/ig.test(e.tagName))r[u]=e.value;else for(s=e.getElementsByTagName("input"),p=s.length-1;h=s[p--];)if(h.checked){r[u]=h.value;break}}else r[u]=!0;else r[u]=!1;else r[f.getAttribute("value")]=f.checked;for(w=n.getElementsByTagName(a,"select"),o=0;c=w[o++];)l=c.getAttribute("name"),r[l]=r[l]?c.value:"";i.extend(t.editor.options.autotypeset,r);t.editor.setPreferences("autotypeset",r)}var i=u.editor.utils,f=u.editor.ui.Popup,e=u.editor.ui.AutoTypeSetPicker,o=u.editor.ui.SplitButton,r=u.editor.ui.AutoTypeSetButton=function(n){this.initOptions(n);this.initAutoTypeSetButton()};r.prototype={initAutoTypeSetButton:function(){var i=this,r;this.popup=new f({content:new e({editor:i.editor}),editor:i.editor,hide:function(){!this._hidden&&this.getDom()&&(t(this),this.getDom().style.display="none",this._hidden=!0,this.fireEvent("hide"))}});r=0;this.popup.addListener("postRenderAfter",function(){var u=this,f,e;if(!r){f=this.getDom();e=f.getElementsByTagName("button")[0];e.onclick=function(){t(u);i.editor.execCommand("autotypeset");u.hide()};n.on(f,"click",function(n){var r=n.target||n.srcElement,o=i.editor.uid,f,s;if(r&&r.tagName=="INPUT"){if(r.name=="imageBlockLine"||r.name=="textAlign"||r.name=="symbolConver"){var h=r.checked,c=document.getElementById(r.name+"Value"+o),e=c.getElementsByTagName("input"),l={imageBlockLine:"none",textAlign:"left",symbolConver:"tobdc"};for(f=0;f<e.length;f++)h?e[f].value==l[r.name]&&(e[f].checked="checked"):e[f].checked=!1}(r.name=="imageBlockLineValue"+o||r.name=="textAlignValue"+o||r.name=="bdc")&&(s=r.parentNode.previousSibling.getElementsByTagName("input"),s&&(s[0].checked=!0));t(u)}});r=1}});this.initSplitButton()}};i.inherits(r,o)}(),function(){var t=u.editor.utils,r=u.editor.ui.Popup,f=u.editor.ui.Stateful,i=u.editor.ui.UIBase,n=u.editor.ui.CellAlignPicker=function(n){this.initOptions(n);this.initSelected();this.initCellAlignPicker()};n.prototype={initSelected:function(){var n={valign:{top:0,middle:1,bottom:2},align:{left:0,center:1,right:2},count:3};this.selected&&(this.selectedIndex=n.valign[this.selected.valign]*n.count+n.align[this.selected.align])},initCellAlignPicker:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){for(var u=["left","center","right"],r=null,t=-1,i=[],n=0;n<9;n++)r=this.selectedIndex===n?' class="edui-cellalign-selected" ':"",t=n%3,t===0&&i.push("<tr>"),i.push('<td index="'+n+'" '+r+' stateful><div class="edui-icon edui-'+u[t]+'"><\/div><\/td>'),t===2&&i.push("<\/tr>");return'<div id="##" class="edui-cellalignpicker %%"><div class="edui-cellalignpicker-body"><table onclick="$$._onClick(event);">'+i.join("")+"<\/table><\/div><\/div>"},getStateDom:function(){return this.target},_onClick:function(n){var t=n.target||n.srcElement;/icon/.test(t.className)&&(this.items[t.parentNode.getAttribute("index")].onclick(),r.postHide(n))},_UIBase_render:i.prototype.render};t.inherits(n,i);t.extend(n.prototype,f,!0)}(),function(){var i=u.editor.utils,e=u.editor.ui.Stateful,r=u.editor.ui.uiUtils,f=u.editor.ui.UIBase,t=u.editor.ui.PastePicker=function(n){this.initOptions(n);this.initPastePicker()};t.prototype={initPastePicker:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div class="edui-pasteicon" onclick="$$._onClick(this)"><\/div><div class="edui-pastecontainer"><div class="edui-title">'+this.editor.getLang("pasteOpt")+'<\/div><div class="edui-button"><div title="'+this.editor.getLang("pasteSourceFormat")+'" onclick="$$.format(false)" stateful><div class="edui-richtxticon"><\/div><\/div><div title="'+this.editor.getLang("tagFormat")+'" onclick="$$.format(2)" stateful><div class="edui-tagicon"><\/div><\/div><div title="'+this.editor.getLang("pasteTextFormat")+'" onclick="$$.format(true)" stateful><div class="edui-plaintxticon"><\/div><\/div><\/div><\/div><\/div>'},getStateDom:function(){return this.target},format:function(n){this.editor.ui._isTransfer=!0;this.editor.fireEvent("pasteTransfer",n)},_onClick:function(t){var i=n.getNextDomNode(t),f=r.getViewportRect().height,u=r.getClientRect(i);i.style.top=u.top+u.height>f?-u.height-t.offsetHeight+"px":"";/hidden/ig.test(n.getComputedStyle(i,"visibility"))?(i.style.visibility="visible",n.addClass(t,"edui-state-opened")):(i.style.visibility="hidden",n.removeClasses(t,"edui-state-opened"))},_UIBase_render:f.prototype.render};i.inherits(t,f);i.extend(t.prototype,e,!0)}(),function(){var t=u.editor.utils,i=u.editor.ui.uiUtils,r=u.editor.ui.UIBase,n=u.editor.ui.Toolbar=function(n){this.initOptions(n);this.initToolbar()};n.prototype={items:null,initToolbar:function(){this.items=this.items||[];this.initUIBase()},add:function(n,t){t===undefined?this.items.push(n):this.items.splice(t,0,n)},getHtmlTpl:function(){for(var t=[],n=0;n<this.items.length;n++)t[n]=this.items[n].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+t.join("")+"<\/div>"},postRender:function(){for(var t=this.getDom(),n=0;n<this.items.length;n++)this.items[n].postRender();i.makeUnselectable(t)},_onMouseDown:function(n){var t=n.target||n.srcElement,i=t&&t.tagName&&t.tagName.toLowerCase();if(i=="input"||i=="object"||i=="object")return!1}};t.inherits(n,r)}(),function(){var e=u.editor.utils,r=u.editor.dom.domUtils,t=u.editor.ui.uiUtils,o=u.editor.ui.UIBase,i=u.editor.ui.Popup,s=u.editor.ui.Stateful,h=u.editor.ui.CellAlignPicker,f=u.editor.ui.Menu=function(n){this.initOptions(n);this.initMenu()},c={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"><\/div><\/div>'},postRender:function(){},queryAutoHide:function(){return!0}},n;f.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[];this.initPopup();this.initItems()},initItems:function(){for(var i,t=0;t<this.items.length;t++)i=this.items[t],i=="-"?this.items[t]=this.getSeparator():i instanceof n||(i.editor=this.editor,i.theme=this.editor.options.theme,this.items[t]=this.createItem(i))},getSeparator:function(){return c},createItem:function(t){return t.menu=this,new n(t)},_Popup_getContentHtmlTpl:i.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){var t,n,i;if(this.items.length==0)return this._Popup_getContentHtmlTpl();for(t=[],n=0;n<this.items.length;n++)i=this.items[n],t[n]=i.renderHtml();return'<div class="%%-body">'+t.join("")+"<\/div>"},_Popup_postRender:i.prototype.postRender,postRender:function(){for(var i,u=this,n=0;n<this.items.length;n++)i=this.items[n],i.ownerMenu=this,i.postRender();r.on(this.getDom(),"mouseover",function(n){n=n||event;var i=n.relatedTarget||n.fromElement,r=u.getDom();t.contains(r,i)||r===i||u.fireEvent("over")});this._Popup_postRender()},queryAutoHide:function(n){var i,r;if(n){if(t.contains(this.getDom(),n))return!1;for(i=0;i<this.items.length;i++)if(r=this.items[i],r.queryAutoHide(n)===!1)return!1}},clearItems:function(){for(var n,t=0;t<this.items.length;t++)n=this.items[t],clearTimeout(n._showingTimer),clearTimeout(n._closingTimer),n.subMenu&&n.subMenu.destroy();this.items=[]},destroy:function(){this.getDom()&&r.remove(this.getDom());this.clearItems()},dispose:function(){this.destroy()}};e.inherits(f,i);n=u.editor.ui.MenuItem=function(n){if(this.initOptions(n),this.initUIBase(),this.Stateful_init(),this.subMenu&&!(this.subMenu instanceof f))if(n.className&&n.className.indexOf("aligntd")!=-1){var t=this;this.subMenu.selected=this.editor.queryCommandValue("cellalignment");this.subMenu=new i({content:new h(this.subMenu),parentMenu:t,editor:t.editor,destroy:function(){this.getDom()&&r.remove(this.getDom())}});this.subMenu.addListener("postRenderAfter",function(){r.on(this.getDom(),"mouseover",function(){t.addState("opened")})})}else this.subMenu=new f(this.subMenu)};n.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:!0,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"<\/div><\/div>"},postRender:function(){var n=this;this.addListener("over",function(){n.ownerMenu.fireEvent("submenuover",n);n.subMenu&&n.delayShowSubMenu()});this.subMenu&&(this.getDom().className+=" edui-hassubmenu",this.subMenu.render(),this.addListener("out",function(){n.delayHideSubMenu()}),this.subMenu.addListener("over",function(){clearTimeout(n._closingTimer);n._closingTimer=null;n.addState("opened")}),this.ownerMenu.addListener("hide",function(){n.hideSubMenu()}),this.ownerMenu.addListener("submenuover",function(t,i){i!==n&&n.delayHideSubMenu()}),this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide,this.subMenu.queryAutoHide=function(i){return i&&t.contains(n.getDom(),i)?!1:this._bakQueryAutoHide(i)});this.getDom().style.tabIndex="-1";t.makeUnselectable(this.getDom());this.Stateful_postRender()},delayShowSubMenu:function(){var n=this;n.isDisabled()||(n.addState("opened"),clearTimeout(n._showingTimer),clearTimeout(n._closingTimer),n._closingTimer=null,n._showingTimer=setTimeout(function(){n.showSubMenu()},250))},delayHideSubMenu:function(){var n=this;n.isDisabled()||(n.removeState("opened"),clearTimeout(n._showingTimer),n._closingTimer||(n._closingTimer=setTimeout(function(){n.hasState("opened")||n.hideSubMenu();n._closingTimer=null},400)))},renderLabelHtml:function(){return'<div class="edui-arrow"><\/div><div class="edui-box edui-icon"><\/div><div class="edui-box edui-label %%-label">'+(this.label||"")+"<\/div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(n){if(this.subMenu&&this.hasState("opened"))return this.subMenu.queryAutoHide(n)},_onClick:function(n,t){this.hasState("disabled")||this.fireEvent("click",n,t)!==!1&&(this.subMenu?this.showSubMenu():i.postHide(n))},showSubMenu:function(){var n=t.getClientRect(this.getDom());n.right-=5;n.left+=2;n.width-=7;n.top-=4;n.bottom+=4;n.height+=8;this.subMenu.showAnchorRect(n,!0,!0)},hideSubMenu:function(){this.subMenu.hide()}};e.inherits(n,o);e.extend(n.prototype,s,!0)}(),function(){var i=u.editor.utils,r=u.editor.ui.uiUtils,f=u.editor.ui.Menu,n=u.editor.ui.SplitButton,t=u.editor.ui.Combox=function(n){this.initOptions(n);this.initCombox()};t.prototype={uiName:"combox",onbuttonclick:function(){this.showPopup()},initCombox:function(){var i=this,n,t;for(this.items=this.items||[],n=0;n<this.items.length;n++)t=this.items[n],t.uiName="listitem",t.index=n,t.onclick=function(){i.selectByIndex(this.index)};this.popup=new f({items:this.items,uiName:"list",editor:this.editor,captureWheel:!0,combox:this});this.initSplitButton()},_SplitButton_postRender:n.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.setLabel(this.label||"");this.setValue(this.initValue||"")},showPopup:function(){var n=r.getClientRect(this.getDom());n.top+=1;n.bottom-=1;n.height-=2;this.popup.showAnchorRect(n)},getValue:function(){return this.value},setValue:function(n){var t=this.indexByValue(n);t!=-1?(this.selectedIndex=t,this.setLabel(this.items[t].label),this.value=this.items[t].value):(this.selectedIndex=-1,this.setLabel(this.getLabelForUnknowValue(n)),this.value=n)},setLabel:function(n){this.getDom("button_body").innerHTML=n;this.label=n},getLabelForUnknowValue:function(n){return n},indexByValue:function(n){for(var t=0;t<this.items.length;t++)if(n==this.items[t].value)return t;return-1},getItem:function(n){return this.items[n]},selectByIndex:function(n){n<this.items.length&&this.fireEvent("select",n)!==!1&&(this.selectedIndex=n,this.value=this.items[n].value,this.setLabel(this.items[n].label))}};i.inherits(t,n)}(),function(){var i=u.editor.utils,t=u.editor.dom.domUtils,n=u.editor.ui.uiUtils,e=u.editor.ui.Mask,c=u.editor.ui.UIBase,r=u.editor.ui.Button,o=u.editor.ui.Dialog=function(n){if(n.name){var t=n.name,r=n.cssRules;n.className||(n.className="edui-for-"+t);r&&(n.cssRules=".edui-default .edui-for-"+t+" .edui-dialog-content  {"+r+"}")}this.initOptions(i.extend({autoReset:!0,draggable:!0,onok:function(){},oncancel:function(){},onclose:function(n,t){return t?this.onok():this.oncancel()},holdScroll:!1},n));this.initDialog()},s,h,f;o.prototype={draggable:!1,uiName:"dialog",initDialog:function(){var u=this,t=this.editor.options.theme,n;if(this.cssRules&&i.cssRule("edui-customize-"+this.name+"-style",this.cssRules),this.initUIBase(),this.modalMask=s||(s=new e({className:"edui-dialog-modalmask",theme:t,onclick:function(){f&&f.close(!1)}})),this.dragMask=h||(h=new e({className:"edui-dialog-dragmask",theme:t})),this.closeButton=new r({className:"edui-dialog-closebutton",title:u.closeDialog,theme:t,onclick:function(){u.close(!1)}}),this.fullscreen&&this.initResizeEvent(),this.buttons)for(n=0;n<this.buttons.length;n++)this.buttons[n]instanceof r||(this.buttons[n]=new r(i.extend(this.buttons[n],{editor:this.editor},!0)))},initResizeEvent:function(){var i=this;t.on(window,"resize",function(){i._hidden||i._hidden===undefined||(i.__resizeTimer&&window.clearTimeout(i.__resizeTimer),i.__resizeTimer=window.setTimeout(function(){i.__resizeTimer=null;var r=i.getDom(),u=i.getDom("content"),f=UE.ui.uiUtils.getClientRect(r),e=UE.ui.uiUtils.getClientRect(u),t=n.getViewportRect();u.style.width=t.width-f.width+e.width+"px";u.style.height=t.height-f.height+e.height+"px";r.style.width=t.width+"px";r.style.height=t.height+"px";i.fireEvent("resize")},100))})},fitSize:function(){var t=this.getDom("body"),n=this.mesureSize();return t.style.width=n.width+"px",t.style.height=n.height+"px",n},safeSetOffset:function(t){var o=this,f=o.getDom(),i=n.getViewportRect(),r=n.getClientRect(f),e=t.left,u;e+r.width>i.right&&(e=i.right-r.width);u=t.top;u+r.height>i.bottom&&(u=i.bottom-r.height);f.style.left=Math.max(e,0)+"px";f.style.top=Math.max(u,0)+"px"},showAtCenter:function(){var r=n.getViewportRect(),i,u,f,e;if(this.fullscreen)i=this.getDom(),u=this.getDom("content"),i.style.display="block",f=UE.ui.uiUtils.getClientRect(i),e=UE.ui.uiUtils.getClientRect(u),i.style.left="-100000px",u.style.width=r.width-f.width+e.width+"px",u.style.height=r.height-f.height+e.height+"px",i.style.width=r.width+"px",i.style.height=r.height+"px",i.style.left=0,this._originalContext={html:{overflowX:document.documentElement.style.overflowX,overflowY:document.documentElement.style.overflowY},body:{overflowX:document.body.style.overflowX,overflowY:document.body.style.overflowY}},document.documentElement.style.overflowX="hidden",document.documentElement.style.overflowY="hidden",document.body.style.overflowX="hidden",document.body.style.overflowY="hidden";else{this.getDom().style.display="";var o=this.fitSize(),s=this.getDom("titlebar").offsetHeight|0,c=r.width/2-o.width/2,l=r.height/2-(o.height-s)/2-s,h=this.getDom();this.safeSetOffset({left:Math.max(c|0,0),top:Math.max(l|0,0)});t.hasClass(h,"edui-state-centered")||(h.className+=" edui-state-centered")}this._show()},getContentHtml:function(){var n="";return typeof this.content=="string"?n=this.content:this.iframeUrl&&(n='<span id="'+this.id+'_contmask" class="dialogcontmask"><\/span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"><\/iframe>'),n},getHtmlTpl:function(){var i="",t,n;if(this.buttons){for(t=[],n=0;n<this.buttons.length;n++)t[n]=this.buttons[n].renderHtml();i='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+t.join("")+"<\/div><\/div>"}return'<div id="##" class="%%"><div '+(this.fullscreen?'class="%%-wrap edui-dialog-fullscreen-flag"':'class="%%"')+'><div id="##_body" class="%%-body"><div class="%%-shadow"><\/div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"<\/span><\/div>"+this.closeButton.renderHtml()+'<\/div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"<\/div>"+i+"<\/div><\/div><\/div>"},postRender:function(){var i,r;if(this.modalMask.getDom()||(this.modalMask.render(),this.modalMask.hide()),this.dragMask.getDom()||(this.dragMask.render(),this.dragMask.hide()),i=this,this.addListener("show",function(){i.modalMask.show(this.getDom().style.zIndex-2)}),this.addListener("hide",function(){i.modalMask.hide()}),this.buttons)for(r=0;r<this.buttons.length;r++)this.buttons[r].postRender();t.on(window,"resize",function(){setTimeout(function(){i.isHidden()||i.safeSetOffset(n.getClientRect(i.getDom()))})});this._hide()},mesureSize:function(){var t=this.getDom("body"),i=n.getClientRect(this.getDom("content")).width,r=t.style;return r.width=i,n.getClientRect(t)},_onTitlebarMouseDown:function(i){if(this.draggable){var u,f=n.getViewportRect(),r=this;n.startDrag(i,{ondragstart:function(){u=n.getClientRect(r.getDom());r.getDom("contmask").style.visibility="visible";r.dragMask.show(r.getDom().style.zIndex-1)},ondragmove:function(n,t){var i=u.left+n,f=u.top+t;r.safeSetOffset({left:i,top:f})},ondragstop:function(){r.getDom("contmask").style.visibility="hidden";t.removeClasses(r.getDom(),["edui-state-centered"]);r.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml();this.fireEvent("dialogafterreset")},_show:function(){this._hidden&&(this.getDom().style.display="",this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10),this._hidden=!1,this.fireEvent("show"),u.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4)},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){var n=this.getDom();n.style.display="none";n.style.zIndex="";n.style.width="";n.style.height="";this._hidden=!0;this.fireEvent("hide")}},open:function(){if(this.autoReset)try{this.reset()}catch(n){this.render();this.open()}if(this.showAtCenter(),this.iframeUrl)try{this.getDom("iframe").focus()}catch(t){}f=this},_onCloseButtonClick:function(){this.close(!1)},close:function(n){var r,i,u;this.fireEvent("close",n)!==!1&&(this.fullscreen&&(document.documentElement.style.overflowX=this._originalContext.html.overflowX,document.documentElement.style.overflowY=this._originalContext.html.overflowY,document.body.style.overflowX=this._originalContext.body.overflowX,document.body.style.overflowY=this._originalContext.body.overflowY,delete this._originalContext),this._hide(),r=this.getDom("content"),i=this.getDom("iframe"),r&&i&&(u=i.contentDocument||i.contentWindow.document,u&&(u.body.innerHTML=""),t.remove(r)))}};i.inherits(o,c)}(),function(){var t=u.editor.utils,i=u.editor.ui.Menu,r=u.editor.ui.SplitButton,n=u.editor.ui.MenuButton=function(n){this.initOptions(n);this.initMenuButton()};n.prototype={initMenuButton:function(){var n=this;this.uiName="menubutton";this.popup=new i({items:n.items,className:n.className,editor:n.editor});this.popup.addListener("show",function(){for(var i=this,t=0;t<i.items.length;t++)i.items[t].removeState("checked"),i.items[t].value==n._value&&(i.items[t].addState("checked"),this.value=n._value)});this.initSplitButton()},setValue:function(n){this._value=n}};t.inherits(n,r)}(),function(){var t=u.editor.utils,i=u.editor.ui.Popup,r=u.editor.ui.SplitButton,n=u.editor.ui.MultiMenuPop=function(n){this.initOptions(n);this.initMultiMenu()};n.prototype={initMultiMenu:function(){var n=this;this.popup=new i({content:"",editor:n.editor,iframe_rendered:!1,onshow:function(){this.iframe_rendered||(this.iframe_rendered=!0,this.getDom("content").innerHTML='<iframe id="'+n.id+'_iframe" src="'+n.iframeUrl+'" frameborder="0"><\/iframe>',n.editor.container.style.zIndex&&(this.getDom().style.zIndex=n.editor.container.style.zIndex*1+1))}});this.onbuttonclick=function(){this.showPopup()};this.initSplitButton()}};t.inherits(n,r)}(),function(){function s(t){var u=t.target||t.srcElement,f=n.findParent(u,function(t){return n.hasClass(t,"edui-shortcutmenu")||n.hasClass(t,"edui-popup")},!0),i,r;if(!f)for(i=0;r=h[i++];)r.hide()}var t=u.editor.ui,l=t.UIBase,e=t.uiUtils,i=u.editor.utils,n=u.editor.dom.domUtils,h=[],c,f=!1,o=t.ShortCutMenu=function(n){this.initOptions(n);this.initShortCutMenu()};o.postHide=s;o.prototype={isHidden:!0,SPACE:5,initShortCutMenu:function(){this.items=this.items||[];this.initUIBase();this.initItems();this.initEvent();h.push(this)},initEvent:function(){var t=this,i=t.editor.document;n.on(i,"mousemove",function(n){if(t.isHidden===!1){if(t.getSubMenuMark()||t.eventType=="contextmenu")return;var o=!0,i=t.getDom(),s=i.offsetWidth,h=i.offsetHeight,f=s/2+t.SPACE,e=h/2,r=Math.abs(n.screenX-t.left),u=Math.abs(n.screenY-t.top);clearTimeout(c);c=setTimeout(function(){u>0&&u<e?t.setOpacity(i,"1"):u>e&&u<e+70?(t.setOpacity(i,"0.5"),o=!1):u>e+70&&u<e+140&&t.hide();o&&r>0&&r<f?t.setOpacity(i,"1"):r>f&&r<f+70?t.setOpacity(i,"0.5"):r>f+70&&r<f+140&&t.hide()})}});if(r.chrome)n.on(i,"mouseout",function(n){var i=n.relatedTarget||n.toElement;(i==null||i.tagName=="HTML")&&t.hide()});t.editor.addListener("afterhidepop",function(){t.isHidden||(f=!0)})},initItems:function(){var n,u,r;if(i.isArray(this.items))for(n=0,u=this.items.length;n<u;n++)r=this.items[n].toLowerCase(),t[r]&&(this.items[n]=new t[r](this.editor),this.items[n].className+=" edui-shortcutsubmenu ")},setOpacity:function(n,t){r.ie&&r.version<9?n.style.filter="alpha(opacity = "+parseFloat(t)*100+");":n.style.opacity=t},getSubMenuMark:function(){var t,i,r,u;for(f=!1,t=e.getFixedLayer(),i=n.getElementsByTagName(t,"div",function(t){return n.hasClass(t,"edui-shortcutsubmenu edui-popup")}),r=0;u=i[r++];)u.style.display!="none"&&(f=!0);return f},show:function(t,i){function h(n){n.left<0&&(n.left=0);n.top<0&&(n.top=0);u.style.cssText="position:absolute;left:"+n.left+"px;top:"+n.top+"px;"}function c(n){n.tagName||(n=n.getDom());f.left=parseInt(n.style.left);f.top=parseInt(n.style.top);f.top-=u.offsetHeight+15;h(f)}var r=this,f={},u=this.getDom(),s=e.getFixedLayer(),o;r.eventType=t.type;u.style.cssText="display:block;left:-9999px";t.type=="contextmenu"&&i?(o=n.getElementsByTagName(s,"div","edui-contextmenu")[0],o?c(o):r.editor.addListener("aftershowcontextmenu",function(n,t){c(t)})):(f=e.getViewportOffsetByEvent(t),f.top-=u.offsetHeight+r.SPACE,f.left+=r.SPACE+20,h(f),r.setOpacity(u,.2));r.isHidden=!1;r.left=t.screenX+u.offsetWidth/2-r.SPACE;r.top=t.screenY-u.offsetHeight/2-r.SPACE;r.editor&&(u.style.zIndex=r.editor.container.style.zIndex*1+10,s.style.zIndex=u.style.zIndex-1)},hide:function(){this.getDom()&&(this.getDom().style.display="none");this.isHidden=!0},postRender:function(){if(i.isArray(this.items))for(var t=0,n;n=this.items[t++];)n.postRender()},getHtmlTpl:function(){var n,t;if(i.isArray(this.items)){for(n=[],t=0;t<this.items.length;t++)n[t]=this.items[t].renderHtml();n=n.join("")}else n=this.items;return'<div id="##" class="%% edui-toolbar" data-src="shortcutmenu" onmousedown="return false;" onselectstart="return false;" >'+n+"<\/div>"}};i.inherits(o,l);n.on(document,"mousedown",function(n){s(n)});n.on(window,"scroll",function(n){s(n)})}(),function(){var t=u.editor.utils,i=u.editor.ui.UIBase,n=u.editor.ui.Breakline=function(n){this.initOptions(n);this.initSeparator()};n.prototype={uiName:"Breakline",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return"<br/>"}};t.inherits(n,i)}(),function(){var t=u.editor.utils,i=u.editor.dom.domUtils,r=u.editor.ui.UIBase,n=u.editor.ui.Message=function(n){this.initOptions(n);this.initMessage()};n.prototype={initMessage:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-message %%"> <div id="##_closer" class="edui-message-closer">×<\/div> <div id="##_body" class="edui-message-body edui-message-type-info"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"><\/iframe> <div class="edui-shadow"><\/div> <div id="##_content" class="edui-message-content">  <\/div> <\/div><\/div>'},reset:function(n){var t=this;n.keepshow||(clearTimeout(this.timer),t.timer=setTimeout(function(){t.hide()},n.timeout||4e3));n.content!==undefined&&t.setContent(n.content);n.type!==undefined&&t.setType(n.type);t.show()},postRender:function(){var t=this,n=this.getDom("closer");n&&i.on(n,"click",function(){t.hide()})},setContent:function(n){this.getDom("content").innerHTML=n},setType:function(n){n=n||"info";var t=this.getDom("body");t.className=t.className.replace(/edui-message-type-[\w-]+/,"edui-message-type-"+n)},getContent:function(){return this.getDom("content").innerHTML},getType:function(){var n=this.getDom("body").match(/edui-message-type-([\w-]+)/);return n?n[1]:""},show:function(){this.getDom().style.display="block"},hide:function(){var n=this.getDom();n&&(n.style.display="none",n.parentNode&&n.parentNode.removeChild(n))}};t.inherits(n,r)}(),function(){var f=u.editor.utils,n=u.editor.ui,b=n.Dialog,e,c,s,o,t,h,i,l,a,v,y,p,w;for(n.buttons={},n.Dialog=function(n){var t=new b(n);return t.addListener("hide",function(){var n,i,u;if(t.editor){n=t.editor;try{r.gecko?(i=n.window.scrollY,u=n.window.scrollX,n.body.focus(),n.window.scrollTo(u,i)):n.focus()}catch(f){}}}),t},e={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",preview:"~/dialogs/preview/preview.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html",charts:"~/dialogs/charts/charts.html"},c=["undo","redo","formatmatch","bold","italic","underline","fontborder","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","mergecells","deletetable","drafts"],o=0;t=c[o++];)t=t.toLowerCase(),n[t]=function(t){return function(i){var r=new n.Button({className:"edui-for-"+t,title:i.options.labelMap[t]||i.getLang("labelMap."+t)||"",onclick:function(){i.execCommand(t)},theme:i.options.theme,showText:!1});return n.buttons[t]=r,i.addListener("selectionchange",function(n,u,f){var e=i.queryCommandState(t);e==-1?(r.setDisabled(!0),r.setChecked(!1)):f||(r.setDisabled(!1),r.setChecked(e))}),r}}(t);n.cleardoc=function(t){var i=new n.Button({className:"edui-for-cleardoc",title:t.options.labelMap.cleardoc||t.getLang("labelMap.cleardoc")||"",theme:t.options.theme,onclick:function(){confirm(t.getLang("confirmClear"))&&t.execCommand("cleardoc")}});return n.buttons.cleardoc=i,t.addListener("selectionchange",function(){i.setDisabled(t.queryCommandState("cleardoc")==-1)}),i};s={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]};for(i in s)(function(t,i){for(var u=0,r;r=i[u++];)(function(i){n[t.replace("float","")+i]=function(r){var u=new n.Button({className:"edui-for-"+t.replace("float","")+i,title:r.options.labelMap[t.replace("float","")+i]||r.getLang("labelMap."+t.replace("float","")+i)||"",theme:r.options.theme,onclick:function(){r.execCommand(t,i)}});return n.buttons[t]=u,r.addListener("selectionchange",function(n,f,e){u.setDisabled(r.queryCommandState(t)==-1);u.setChecked(r.queryCommandValue(t)==i&&!e)}),u}})(r)})(i,s[i]);for(o=0;t=["backcolor","forecolor"][o++];)n[t]=function(t){return function(i){var r=new n.ColorButton({className:"edui-for-"+t,color:"default",title:i.options.labelMap[t]||i.getLang("labelMap."+t)||"",editor:i,onpickcolor:function(n,r){i.execCommand(t,r)},onpicknocolor:function(){i.execCommand(t,"default");this.setColor("transparent");this.color="default"},onbuttonclick:function(){i.execCommand(t,this.color)}});return n.buttons[t]=r,i.addListener("selectionchange",function(){r.setDisabled(i.queryCommandState(t)==-1)}),r}}(t);h={noOk:["searchreplace","help","spechars","webapp","preview"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","insertframe","edittip","edittable","edittd","scrawl","template","music","background","charts"]};for(i in h)(function(t,i){for(var o=0,u;u=i[o++];)r.opera&&u==="searchreplace"||function(i){n[i]=function(r,u,o){var s,h;return u=u||(r.options.iframeUrlMap||{})[i]||e[i],o=r.options.labelMap[i]||r.getLang("labelMap."+i)||"",u&&(s=new n.Dialog(f.extend({iframeUrl:r.ui.mapUrl(u),editor:r,className:"edui-for-"+i,title:o,holdScroll:i==="insertimage",fullscreen:/charts|preview/.test(i),closeDialog:r.getLang("closeDialog")},t=="ok"?{buttons:[{className:"edui-okbutton",label:r.getLang("ok"),editor:r,onclick:function(){s.close(!0)}},{className:"edui-cancelbutton",label:r.getLang("cancel"),editor:r,onclick:function(){s.close(!1)}}]}:{})),r.ui._dialogs[i+"Dialog"]=s),h=new n.Button({className:"edui-for-"+i,title:o,onclick:function(){if(s)switch(i){case"wordimage":var n=r.execCommand("wordimage");n&&n.length&&(s.render(),s.open());break;case"scrawl":r.queryCommandState("scrawl")!=-1&&(s.render(),s.open());break;default:s.render();s.open()}},theme:r.options.theme,disabled:i=="scrawl"&&r.queryCommandState("scrawl")==-1||i=="charts"}),n.buttons[i]=h,r.addListener("selectionchange",function(){var n;i in{edittable:1}||(n=r.queryCommandState(i),h.getDom()&&(h.setDisabled(n==-1),h.setChecked(n)))}),h}}(u.toLowerCase())})(i,h[i]);for(n.snapscreen=function(t,i,r){var f,u;return r=t.options.labelMap.snapscreen||t.getLang("labelMap.snapscreen")||"",f=new n.Button({className:"edui-for-snapscreen",title:r,onclick:function(){t.execCommand("snapscreen")},theme:t.options.theme}),n.buttons.snapscreen=f,i=i||(t.options.iframeUrlMap||{}).snapscreen||e.snapscreen,i&&(u=new n.Dialog({iframeUrl:t.ui.mapUrl(i),editor:t,className:"edui-for-snapscreen",title:r,buttons:[{className:"edui-okbutton",label:t.getLang("ok"),editor:t,onclick:function(){u.close(!0)}},{className:"edui-cancelbutton",label:t.getLang("cancel"),editor:t,onclick:function(){u.close(!1)}}]}),u.render(),t.ui._dialogs.snapscreenDialog=u),t.addListener("selectionchange",function(){f.setDisabled(t.queryCommandState("snapscreen")==-1)}),f},n.insertcode=function(t,i,r){var e,u;return i=t.options.insertcode||[],r=t.options.labelMap.insertcode||t.getLang("labelMap.insertcode")||"",e=[],f.each(i,function(n,i){e.push({label:n,value:i,theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" >'+(this.label||"")+"<\/div>"}})}),u=new n.Combox({editor:t,items:e,onselect:function(n,i){t.execCommand("insertcode",this.items[i].value)},onbuttonclick:function(){this.showPopup()},title:r,initValue:r,className:"edui-for-insertcode",indexByValue:function(n){if(n)for(var t=0,i;i=this.items[t];t++)if(i.value.indexOf(n)!=-1)return t;return-1}}),n.buttons.insertcode=u,t.addListener("selectionchange",function(n,i,f){var o,e;if(!f)if(o=t.queryCommandState("insertcode"),o==-1)u.setDisabled(!0);else{if(u.setDisabled(!1),e=t.queryCommandValue("insertcode"),!e){u.setValue(r);return}e&&(e=e.replace(/['"]/g,"").split(",")[0]);u.setValue(e)}}),u},n.fontfamily=function(t,i,r){var o,e,s,h,u;if(i=t.options.fontfamily||[],r=t.options.labelMap.fontfamily||t.getLang("labelMap.fontfamily")||"",i.length){for(o=0,s=[];e=i[o];o++)h=t.getLang("fontfamily")[e.name]||"",function(n,i){s.push({label:n,value:i,theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+f.unhtml(this.value)+'">'+(this.label||"")+"<\/div>"}})}(e.label||h,e.val);return u=new n.Combox({editor:t,items:s,onselect:function(n,i){t.execCommand("FontFamily",this.items[i].value)},onbuttonclick:function(){this.showPopup()},title:r,initValue:r,className:"edui-for-fontfamily",indexByValue:function(n){if(n)for(var t=0,i;i=this.items[t];t++)if(i.value.indexOf(n)!=-1)return t;return-1}}),n.buttons.fontfamily=u,t.addListener("selectionchange",function(n,i,r){var e,f;r||(e=t.queryCommandState("FontFamily"),e==-1?u.setDisabled(!0):(u.setDisabled(!1),f=t.queryCommandValue("FontFamily"),f&&(f=f.replace(/['"]/g,"").split(",")[0]),u.setValue(f)))}),u}},n.fontsize=function(t,i,r){var e,f,o,u;if(r=t.options.labelMap.fontsize||t.getLang("labelMap.fontsize")||"",i=i||t.options.fontsize||[],i.length){for(e=[],f=0;f<i.length;f++)o=i[f]+"px",e.push({label:o,value:o,theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"<\/div>"}});return u=new n.Combox({editor:t,items:e,title:r,initValue:r,onselect:function(n,i){t.execCommand("FontSize",this.items[i].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"}),n.buttons.fontsize=u,t.addListener("selectionchange",function(n,i,r){if(!r){var f=t.queryCommandState("FontSize");f==-1?u.setDisabled(!0):(u.setDisabled(!1),u.setValue(t.queryCommandValue("FontSize")))}}),u}},n.paragraph=function(t,i,r){var o,e,u;if(r=t.options.labelMap.paragraph||t.getLang("labelMap.paragraph")||"",i=t.options.paragraph||[],!f.isEmptyObject(i)){o=[];for(e in i)o.push({value:e,label:i[e]||t.getLang("paragraph")[e],theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"<\/span><\/div>"}});return u=new n.Combox({editor:t,items:o,title:r,initValue:r,className:"edui-for-paragraph",onselect:function(n,i){t.execCommand("Paragraph",this.items[i].value)},onbuttonclick:function(){this.showPopup()}}),n.buttons.paragraph=u,t.addListener("selectionchange",function(n,i,r){var e,f,o;r||(e=t.queryCommandState("Paragraph"),e==-1?u.setDisabled(!0):(u.setDisabled(!1),f=t.queryCommandValue("Paragraph"),o=u.indexByValue(f),o!=-1?u.setValue(f):u.setValue(u.initValue)))}),u}},n.customstyle=function(t){var u=t.options.customstyle||[],f=t.options.labelMap.customstyle||t.getLang("labelMap.customstyle")||"",e,o,r,s,i;if(u.length){for(e=t.getLang("customstyle"),o=0,r=[];s=u[o++];)(function(n){var i={};i.label=n.label?n.label:e[n.name];i.style=n.style;i.className=n.className;i.tag=n.tag;r.push({label:i.label,value:i,theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+i.tag+" "+(i.className?' class="'+i.className+'"':"")+(i.style?' style="'+i.style+'"':"")+">"+i.label+"<\/"+i.tag+"><\/div>"}})})(s);return i=new n.Combox({editor:t,items:r,title:f,initValue:f,className:"edui-for-customstyle",onselect:function(n,i){t.execCommand("customstyle",this.items[i].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(n){for(var t=0,i;i=this.items[t++];)if(i.label==n)return t-1;return-1}}),n.buttons.customstyle=i,t.addListener("selectionchange",function(n,r,u){var e,f,o;u||(e=t.queryCommandState("customstyle"),e==-1?i.setDisabled(!0):(i.setDisabled(!1),f=t.queryCommandValue("customstyle"),o=i.indexByValue(f),o!=-1?i.setValue(f):i.setValue(i.initValue)))}),i}},n.inserttable=function(t,i,r){r=t.options.labelMap.inserttable||t.getLang("labelMap.inserttable")||"";var u=new n.TableButton({editor:t,title:r,className:"edui-for-inserttable",onpicktable:function(n,i,r){t.execCommand("InsertTable",{numRows:r,numCols:i,border:1})},onbuttonclick:function(){this.showPopup()}});return n.buttons.inserttable=u,t.addListener("selectionchange",function(){u.setDisabled(t.queryCommandState("inserttable")==-1)}),u},n.lineheight=function(t){var f=t.options.lineheight||[],e,r,u,i;if(f.length){for(e=0,u=[];r=f[e++];)u.push({label:r,value:r,theme:t.options.theme,onclick:function(){t.execCommand("lineheight",this.value)}});return i=new n.MenuButton({editor:t,className:"edui-for-lineheight",title:t.options.labelMap.lineheight||t.getLang("labelMap.lineheight")||"",items:u,onbuttonclick:function(){var n=t.queryCommandValue("LineHeight")||this.value;t.execCommand("LineHeight",n)}}),n.buttons.lineheight=i,t.addListener("selectionchange",function(){var r=t.queryCommandState("LineHeight"),n;r==-1?i.setDisabled(!0):(i.setDisabled(!1),n=t.queryCommandValue("LineHeight"),n&&i.setValue((n+"").replace(/cm/,"")),i.setChecked(r))}),i}},l=["top","bottom"],a=0;v=l[a++];)(function(t){n["rowspacing"+t]=function(i){var e=i.options["rowspacing"+t]||[],o,u,f,r;if(!e.length)return null;for(o=0,f=[];u=e[o++];)f.push({label:u,value:u,theme:i.options.theme,onclick:function(){i.execCommand("rowspacing",this.value,t)}});return r=new n.MenuButton({editor:i,className:"edui-for-rowspacing"+t,title:i.options.labelMap["rowspacing"+t]||i.getLang("labelMap.rowspacing"+t)||"",items:f,onbuttonclick:function(){var n=i.queryCommandValue("rowspacing",t)||this.value;i.execCommand("rowspacing",n,t)}}),n.buttons[t]=r,i.addListener("selectionchange",function(){var u=i.queryCommandState("rowspacing",t),n;u==-1?r.setDisabled(!0):(r.setDisabled(!1),n=i.queryCommandValue("rowspacing",t),n&&r.setValue((n+"").replace(/%/,"")),r.setChecked(u))}),r}})(v);for(y=["insertorderedlist","insertunorderedlist"],p=0;w=y[p++];)(function(t){n[t]=function(i){var f=i.options[t],o=function(){i.execCommand(t,this.value)},e=[],u,r;for(u in f)e.push({label:f[u]||i.getLang()[t][u]||"",value:u,theme:i.options.theme,onclick:o});return r=new n.MenuButton({editor:i,className:"edui-for-"+t,title:i.getLang("labelMap."+t)||"",items:e,onbuttonclick:function(){var n=i.queryCommandValue(t)||this.value;i.execCommand(t,n)}}),n.buttons[t]=r,i.addListener("selectionchange",function(){var n=i.queryCommandState(t),u;n==-1?r.setDisabled(!0):(r.setDisabled(!1),u=i.queryCommandValue(t),r.setValue(u),r.setChecked(n))}),r}})(w);n.fullscreen=function(t,i){i=t.options.labelMap.fullscreen||t.getLang("labelMap.fullscreen")||"";var r=new n.Button({className:"edui-for-fullscreen",title:i,theme:t.options.theme,onclick:function(){t.ui&&t.ui.setFullScreen(!t.ui.isFullScreen());this.setChecked(t.ui.isFullScreen())}});return n.buttons.fullscreen=r,t.addListener("selectionchange",function(){var n=t.queryCommandState("fullscreen");r.setDisabled(n==-1);r.setChecked(t.ui.isFullScreen())}),r};n.emotion=function(t,i){var r="emotion",u=new n.MultiMenuPop({title:t.options.labelMap[r]||t.getLang("labelMap."+r+"")||"",editor:t,className:"edui-for-"+r,iframeUrl:t.ui.mapUrl(i||(t.options.iframeUrlMap||{})[r]||e[r])});return n.buttons[r]=u,t.addListener("selectionchange",function(){u.setDisabled(t.queryCommandState(r)==-1)}),u};n.autotypeset=function(t){var i=new n.AutoTypeSetButton({editor:t,title:t.options.labelMap.autotypeset||t.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){t.execCommand("autotypeset")}});return n.buttons.autotypeset=i,t.addListener("selectionchange",function(){i.setDisabled(t.queryCommandState("autotypeset")==-1)}),i};n.simpleupload=function(t){var r="simpleupload",i=new n.Button({className:"edui-for-"+r,title:t.options.labelMap[r]||t.getLang("labelMap."+r)||"",onclick:function(){},theme:t.options.theme,showText:!1});return n.buttons[r]=i,t.addListener("ready",function(){var n=i.getDom("body"),r=n.children[0];t.fireEvent("simpleuploadbtnready",r)}),t.addListener("selectionchange",function(n,u,f){var e=t.queryCommandState(r);e==-1?(i.setDisabled(!0),i.setChecked(!1)):f||(i.setDisabled(!1),i.setChecked(e))}),i}}(),function(){function f(n){this.initOptions(n);this.initEditorUI()}var i=u.editor.utils,e=u.editor.ui.uiUtils,s=u.editor.ui.UIBase,n=u.editor.dom.domUtils,o=[],t;f.prototype={uiName:"editor",initEditorUI:function(){function s(n,t){var r;n.setOpt({wordCount:!0,maximumWords:1e4,wordCountMsg:n.options.wordCountMsg||n.getLang("wordCountMsg"),wordOverFlowMsg:n.options.wordOverFlowMsg||n.getLang("wordOverFlowMsg")});var i=n.options,u=i.maximumWords,e=i.wordCountMsg,o=i.wordOverFlowMsg,f=t.getDom("wordcount");i.wordCount&&(r=n.getContentLength(!0),r>u?(f.innerHTML=o,n.fireEvent("wordcountoverflow")):f.innerHTML=e.replace("{#leave}",u-r).replace("{#count}",r))}var t,f,r,e,o,i;this.editor.ui=this;this._dialogs={};this.initUIBase();this._initToolbars();t=this.editor;f=this;t.addListener("ready",function(){t.getDialog=function(n){return t.ui._dialogs[n+"Dialog"]};n.on(t.window,"scroll",function(n){u.editor.ui.Popup.postHide(n)});if(t.ui._actualFrameWidth=t.options.initialFrameWidth,UE.browser.ie&&UE.browser.version===6&&t.container.ownerDocument.execCommand("BackgroundImageCache",!1,!0),t.options.elementPathEnabled&&(t.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+t.getLang("elementPathTip")+":<\/div>"),t.options.wordCount){function i(){s(t,f);n.un(t.document,"click",arguments.callee)}n.on(t.document,"click",i);t.ui.getDom("wordcount").innerHTML=t.getLang("wordCountTip")}(t.ui._scale(),t.options.scaleEnabled?(t.autoHeightEnabled&&t.disableAutoHeight(),f.enableScale()):f.disableScale(),t.options.elementPathEnabled||t.options.wordCount||t.options.scaleEnabled||(t.ui.getDom("elementpath").style.display="none",t.ui.getDom("wordcount").style.display="none",t.ui.getDom("scale").style.display="none"),t.selection.isFocus())&&t.fireEvent("selectionchange",!1,!0)});t.addListener("mousedown",function(n,t){var i=t.target||t.srcElement;u.editor.ui.Popup.postHide(t,i);u.editor.ui.ShortCutMenu.postHide(t)});t.addListener("delcells",function(){UE.ui.edittip&&new UE.ui.edittip(t);t.getDialog("edittip").open()});e=!1;t.addListener("afterpaste",function(){t.queryCommandState("pasteplain")||(u.editor.ui.PastePicker&&(r=new u.editor.ui.Popup({content:new u.editor.ui.PastePicker({editor:t}),editor:t,className:"edui-wordpastepop"}),r.render()),e=!0)});t.addListener("afterinserthtml",function(){clearTimeout(o);o=setTimeout(function(){var u,f,i;r&&(e||t.ui._isTransfer)&&(r.isHidden()?(u=n.createElement(t.document,"span",{style:"line-height:0px;",innerHTML:"﻿"}),f=t.selection.getRange(),f.insertNode(u),i=l(u,"firstChild","previousSibling"),i&&r.showAnchor(i.nodeType==3?i.parentNode:i),n.remove(u)):r.show(),delete t.ui._isTransfer,e=!1)},200)});t.addListener("contextmenu",function(n,t){u.editor.ui.Popup.postHide(t)});t.addListener("keydown",function(n,t){r&&r.dispose(t);var i=t.keyCode||t.which;t.altKey&&i==90&&UE.ui.buttons.fullscreen.onclick()});t.addListener("wordcount",function(){s(this,f)});t.addListener("selectionchange",function(){t.options.elementPathEnabled&&f[(t.queryCommandState("elementpath")==-1?"dis":"en")+"ableElementPath"]();t.options.scaleEnabled&&f[(t.queryCommandState("scale")==-1?"dis":"en")+"ableScale"]()});i=new u.editor.ui.Popup({editor:t,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide();t.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(n){this.hide();t.ui._dialogs[n]&&t.ui._dialogs[n].open()},_onImgSetFloat:function(n){this.hide();t.execCommand("imagefloat",n)},_setIframeAlign:function(t){var u=i.anchorEl,r=u.cloneNode(!0);switch(t){case-2:r.setAttribute("align","");break;case-1:r.setAttribute("align","left");break;case 1:r.setAttribute("align","right")}u.parentNode.insertBefore(r,u);n.remove(u);i.anchorEl=r;i.showAnchor(i.anchorEl)},_updateIframe:function(){var r=t._iframe=i.anchorEl;n.hasClass(r,"ueditor_baidumap")?(t.selection.getRange().selectNode(r).select(),t.ui._dialogs.mapDialog.open(),i.hide()):(t.ui._dialogs.insertframeDialog.open(),i.hide())},_onRemoveButtonClick:function(n){t.execCommand(n);this.hide()},queryAutoHide:function(r){return r&&r.ownerDocument==t.document&&(r.tagName.toLowerCase()=="img"||n.findParentByTagName(r,"a",!0))?r!==i.anchorEl:u.editor.ui.Popup.prototype.queryAutoHide.call(this,r)}});i.render();t.options.imagePopup&&(t.addListener("mouseover",function(n,r){var u,f;r=r||window.event;u=r.target||r.srcElement;t.ui._dialogs.insertframeDialog&&/iframe/ig.test(u.tagName)&&(f=i.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+t.getLang("default")+'<\/span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+t.getLang("justifyleft")+'<\/span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+t.getLang("justifyright")+'<\/span>&nbsp;&nbsp; <span onclick="$$._updateIframe( this);" class="edui-clickable">'+t.getLang("modify")+"<\/span><\/nobr>"),f?(i.getDom("content").innerHTML=f,i.anchorEl=u,i.showAnchor(i.anchorEl)):i.hide())}),t.addListener("selectionchange",function(r,u){var e,s,h,c;if(u){var o="",l="",f=t.selection.getRange().getClosedNode(),a=t.ui._dialogs;if(f&&f.tagName=="IMG"){if(e="insertimageDialog",(f.className.indexOf("edui-faked-video")!=-1||f.className.indexOf("edui-upload-video")!=-1)&&(e="insertvideoDialog"),f.className.indexOf("edui-faked-webapp")!=-1&&(e="webappDialog"),f.src.indexOf("http://api.map.baidu.com")!=-1&&(e="mapDialog"),f.className.indexOf("edui-faked-music")!=-1&&(e="musicDialog"),f.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1&&(e="gmapDialog"),f.getAttribute("anchorname")&&(e="anchorDialog",o=i.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+t.getLang("modify")+"<\/span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+t.getLang("delete")+"<\/span><\/nobr>")),f.getAttribute("word_img")&&(t.word_img=[f.getAttribute("word_img")],e="wordimageDialog"),(n.hasClass(f,"loadingclass")||n.hasClass(f,"loaderrorclass"))&&(e=""),!a[e])return;l="<nobr>"+t.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+t.getLang("default")+'<\/span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+t.getLang("justifyleft")+'<\/span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+t.getLang("justifyright")+'<\/span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+t.getLang("justifycenter")+"<\/span>&nbsp;&nbsp;<span onclick=\"$$._onImgEditButtonClick('"+e+'\');" class="edui-clickable">'+t.getLang("modify")+"<\/span><\/nobr>";o||(o=i.formatHtml(l))}t.ui._dialogs.linkDialog&&(s=t.queryCommandValue("link"),s&&(h=s.getAttribute("_href")||s.getAttribute("href",2))&&(c=h,h.length>30&&(c=h.substring(0,20)+"..."),o&&(o+='<div style="height:5px;"><\/div>'),o+=i.formatHtml("<nobr>"+t.getLang("anthorMsg")+': <a target="_blank" href="'+h+'" title="'+h+'" >'+c+'<\/a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+t.getLang("modify")+'<\/span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+t.getLang("clear")+"<\/span><\/nobr>"),i.showAnchor(s)));o?(i.getDom("content").innerHTML=o,i.anchorEl=f||s,i.showAnchor(i.anchorEl)):i.hide()}}))},_initToolbars:function(){for(var h,r,s,n,t,f=this.editor,c=this.toolbars||[],e=[],o=0;o<c.length;o++){for(h=c[o],r=new u.editor.ui.Toolbar({theme:f.options.theme}),s=0;s<h.length;s++){if(n=h[s],t=null,typeof n=="string"){if(n=n.toLowerCase(),n=="|"&&(n="Separator"),n=="||"&&(n="Breakline"),u.editor.ui[n]&&(t=new u.editor.ui[n](f)),n=="fullscreen"){e&&e[0]?e[0].items.splice(0,0,t):t&&r.items.splice(0,0,t);continue}}else t=n;t&&t.id&&r.add(t)}e[o]=r}i.each(UE._customizeUI,function(n,t){var u,i;if(n.id&&n.id!=f.key)return!1;u=n.execFn.call(f,f,t);u&&(i=n.index,i===undefined&&(i=r.items.length),r.add(u,i))});this.toolbars=e},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"<\/div><\/div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'<\/div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x<\/div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"><\/div><div style="height:0;overflow:hidden;clear:both;"><\/div><\/div><div id="##_message_holder" class="%%-messageholder"><\/div><\/div><div id="##_iframeholder" class="%%-iframeholder"><\/div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"><\/td><td id="##_wordcount" class="%%-wordcount"><\/td><td id="##_scale" class="%%-scale"><div class="%%-icon"><\/div><\/td><\/tr><\/table><\/div><div id="##_scalelayer"><\/div><\/div>'},showWordImageDialog:function(){this._dialogs.wordimageDialog.open()},renderToolbarBoxHtml:function(){for(var t=[],n=0;n<this.toolbars.length;n++)t.push(this.toolbars[n].renderHtml());return t.join("")},setFullScreen:function(n){var t=this.editor,i=t.container.parentNode.parentNode,e,s,f;if(this._fullscreen!=n){if(this._fullscreen=n,this.editor.fireEvent("beforefullscreenchange",n),u.editor.browser.gecko&&(e=t.selection.getRange().createBookmark()),n){while(i.tagName!="BODY")s=u.editor.dom.domUtils.getComputedStyle(i,"position"),o.push(s),i.style.position="static",i=i.parentNode;this._bakHtmlOverflow=document.documentElement.style.overflow;this._bakBodyOverflow=document.body.style.overflow;this._bakAutoHeight=this.editor.autoHeightEnabled;this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);this._bakEditorContaninerWidth=t.iframe.parentNode.offsetWidth;this._bakAutoHeight&&(t.autoHeightEnabled=!1,this.editor.disableAutoHeight());document.documentElement.style.overflow="hidden";window.scrollTo(0,window.scrollY);this._bakCssText=this.getDom().style.cssText;this._bakCssText1=this.getDom("iframeholder").style.cssText;t.iframe.parentNode.style.width="";this._updateFullScreen()}else{while(i.tagName!="BODY")i.style.position=o.shift(),i=i.parentNode;this.getDom().style.cssText=this._bakCssText;this.getDom("iframeholder").style.cssText=this._bakCssText1;this._bakAutoHeight&&(t.autoHeightEnabled=!0,this.editor.enableAutoHeight());document.documentElement.style.overflow=this._bakHtmlOverflow;document.body.style.overflow=this._bakBodyOverflow;t.iframe.parentNode.style.width=this._bakEditorContaninerWidth+"px";window.scrollTo(0,this._bakScrollTop)}r.gecko&&t.body.contentEditable==="true"&&(f=document.createElement("input"),document.body.appendChild(f),t.body.contentEditable=!1,setTimeout(function(){f.focus();setTimeout(function(){t.body.contentEditable=!0;t.fireEvent("fullscreenchanged",n);t.selection.getRange().moveToBookmark(e).select(!0);u.editor.dom.domUtils.remove(f);n&&window.scroll(0,0)},0)},0));t.body.contentEditable==="true"&&(this.editor.fireEvent("fullscreenchanged",n),this.triggerLayout())}},_updateFullScreen:function(){if(this._fullscreen){var n=e.getViewportRect();if(this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+n.width+"px;height:"+n.height+"px;z-index:"+(this.getDom().style.zIndex*1+100),e.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0}),this.editor.setHeight(n.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0),!0),r.gecko)try{window.onresize()}catch(t){}}},_updateElementPath:function(){var i=this.getDom("elementpath"),r,t,n,u;if(this.elementPathEnabled&&(r=this.editor.queryCommandValue("elementpath"))){for(t=[],n=0;u=r[n];n++)t[n]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+n+'&quot;);">'+u+"<\/span>");i.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+t.join(" &gt; ")+"<\/div>"}else i.style.display="none"},disableElementPath:function(){var n=this.getDom("elementpath");n.innerHTML="";n.style.display="none";this.elementPathEnabled=!1},enableElementPath:function(){var n=this.getDom("elementpath");n.style.display="";this.elementPathEnabled=!0;this._updateElementPath()},_scale:function(){function d(){c=n.getXY(e);l||(l=t.options.minFrameHeight+p.offsetHeight+w.offsetHeight);u.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+e.offsetWidth+"px;height:"+e.offsetHeight+"px;z-index:"+(t.options.zIndex+1);n.on(i,"mousemove",g);n.on(y,"mouseup",h);n.on(i,"mouseup",h)}function g(n){nt();var t=n||window.event;b=t.pageX||i.documentElement.scrollLeft+t.clientX;k=t.pageY||i.documentElement.scrollTop+t.clientY;a=b-c.x;v=k-c.y;a>=tt&&(s=!0,u.style.width=a+"px");v>=l&&(s=!0,u.style.height=v+"px")}function h(){s&&(s=!1,t.ui._actualFrameWidth=u.offsetWidth-2,e.style.width=t.ui._actualFrameWidth+"px",t.setHeight(u.offsetHeight-w.offsetHeight-p.offsetHeight-2,!0));u&&(u.style.display="none");nt();n.un(i,"mousemove",g);n.un(y,"mouseup",h);n.un(i,"mouseup",h)}function nt(){r.ie?i.selection.clear():window.getSelection().removeAllRanges()}var i=document,t=this.editor,e=t.container,y=t.document,p=this.getDom("toolbarbox"),w=this.getDom("bottombar"),o=this.getDom("scale"),u=this.getDom("scalelayer"),s=!1,c=null,l=0,tt=t.options.minFrameWidth,b=0,k=0,a=0,v=0,f=this;this.editor.addListener("fullscreenchanged",function(t,i){if(i)f.disableScale();else if(f.editor.options.scaleEnabled){f.enableScale();var r=f.editor.document.createElement("span");f.editor.body.appendChild(r);f.editor.body.style.height=Math.max(n.getXY(r).y,f.editor.iframe.offsetHeight-20)+"px";n.remove(r)}});this.enableScale=function(){if(t.queryCommandState("source")!=1){o.style.display="";this.scaleEnabled=!0;n.on(o,"mousedown",d)}};this.disableScale=function(){o.style.display="none";this.scaleEnabled=!1;n.un(o,"mousedown",d)}},isFullScreen:function(){return this._fullscreen},postRender:function(){var n;for(s.prototype.postRender.call(this),n=0;n<this.toolbars.length;n++)this.toolbars[n].postRender();var i=this,t,r=u.editor.dom.domUtils,f=function(){clearTimeout(t);t=setTimeout(function(){i._updateFullScreen()})};r.on(window,"resize",f);i.addListener("destroy",function(){r.un(window,"resize",f);clearTimeout(t)})},showToolbarMsg:function(n,t){if(this.getDom("toolbarmsg_label").innerHTML=n,this.getDom("toolbarmsg").style.display="",!t){var i=this.getDom("upload_dialog");i.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(n){return n?n.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var n=this.getDom();n.style.zoom=n.style.zoom=="1"?"100%":"1"}};i.inherits(f,u.editor.ui.UIBase);t={};UE.ui.Editor=function(r){var u=new UE.Editor(r),e;return u.options.editor=u,i.loadFile(document,{href:u.options.themePath+u.options.theme+"/css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"}),e=u.render,u.render=function(r){r.constructor===String&&(u.key=r,t[r]=u);i.domReady(function(){function t(){var o,h,t,c,l,a,i,s;for(u.setOpt({labelMap:u.options.labelMap||u.getLang("labelMap")}),new f(u.options),r&&(r.constructor===String&&(r=document.getElementById(r)),r&&r.getAttribute("name")&&(u.options.textarea=r.getAttribute("name")),r&&/script|textarea/ig.test(r.tagName)&&(o=document.createElement("div"),r.parentNode.insertBefore(o,r),h=r.value||r.innerHTML,u.options.initialContent=/^[\t\r\n ]*$/.test(h)?u.options.initialContent:h.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><"),r.className&&(o.className=r.className),r.style.cssText&&(o.style.cssText=r.style.cssText),/textarea/i.test(r.tagName)?(u.textarea=r,u.textarea.style.display="none"):r.parentNode.removeChild(r),r.id&&(o.id=r.id,n.removeAttributes(r,"id")),r=o,r.innerHTML="")),n.addClass(r,"edui-"+u.options.theme),u.ui.render(r),t=u.options,u.container=u.ui.getDom(),c=n.findParents(r,!0),l=[],i=0;s=c[i];i++)l[i]=s.style.display,s.style.display="block";for(t.initialFrameWidth?t.minFrameWidth=t.initialFrameWidth:(t.minFrameWidth=t.initialFrameWidth=r.offsetWidth,a=r.style.width,/%$/.test(a)&&(t.initialFrameWidth=a)),t.initialFrameHeight?t.minFrameHeight=t.initialFrameHeight:t.initialFrameHeight=t.minFrameHeight=r.offsetHeight,i=0;s=c[i];i++)s.style.display=l[i];r.style.height&&(r.style.height="");u.container.style.width=t.initialFrameWidth+(/%$/.test(t.initialFrameWidth)?"":"px");u.container.style.zIndex=t.zIndex;e.call(u,u.ui.getDom("iframeholder"));u.fireEvent("afteruiready")}u.langIsReady?t():u.addListener("langReady",t)})},u};UE.getEditor=function(n,i){var r=t[n];return r||(r=t[n]=new UE.ui.Editor(i),r.render(n)),r};UE.delEditor=function(n){var i;(i=t[n])&&(i.key&&i.destroy(),delete t[n])};UE.registerUI=function(n,t,r,u){i.each(n.split(/\s+/),function(n){UE._customizeUI[n]={id:u,execFn:t,index:r}})}}();UE.registerUI("message",function(n){function e(){var n=i.ui.getDom("toolbarbox");n&&(r.style.top=n.offsetHeight+3+"px");r.style.zIndex=Math.max(i.options.zIndex,i.iframe.style.zIndex)+1}var o=u.editor.ui,s=o.Message,r,f=[],i=n;i.addListener("ready",function(){r=document.getElementById(i.ui.id+"_message_holder");e();setTimeout(function(){e()},500)});i.addListener("showmessage",function(n,u){u=t.isString(u)?{content:u}:u;var o=new s({timeout:u.timeout,type:u.type,content:u.content,keepshow:u.keepshow,editor:i}),h=u.id||"msg_"+(+new Date).toString(36);return o.render(r),f[h]=o,o.reset(u),e(),h});i.addListener("updatemessage",function(n,i,u){u=t.isString(u)?{content:u}:u;var e=f[i];e.render(r);e&&e.reset(u)});i.addListener("hidemessage",function(n,t){var i=f[t];i&&i.hide()})});UE.registerUI("autosave",function(n){var i=null,t=null;n.on("afterautosave",function(){clearTimeout(i);i=setTimeout(function(){t&&n.trigger("hidemessage",t);t=n.trigger("showmessage",{content:n.getLang("autosave.success"),timeout:2e3})},2e3)})})})();